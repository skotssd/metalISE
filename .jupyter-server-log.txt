[I 19:29:10.710 NotebookApp] Writing notebook server cookie secret to /home/jovyan/.local/share/jupyter/runtime/notebook_cookie_secret
[I 19:29:10.711 NotebookApp] Authentication of /metrics is OFF, since other authentication is disabled.
[W 19:29:11.146 NotebookApp] All authentication is disabled.  Anyone who can connect to this server will be able to run code.
[W 2023-08-02 19:29:12.150 LabApp] 'ip' has moved from NotebookApp to ServerApp. This config will be passed to ServerApp. Be sure to update your config before our next release.
[W 2023-08-02 19:29:12.151 LabApp] 'token' has moved from NotebookApp to ServerApp. This config will be passed to ServerApp. Be sure to update your config before our next release.
[W 2023-08-02 19:29:12.151 LabApp] 'password' has moved from NotebookApp to ServerApp. This config will be passed to ServerApp. Be sure to update your config before our next release.
[W 2023-08-02 19:29:12.151 LabApp] 'password' has moved from NotebookApp to ServerApp. This config will be passed to ServerApp. Be sure to update your config before our next release.
[I 2023-08-02 19:29:12.164 LabApp] JupyterLab extension loaded from /srv/conda/envs/notebook/lib/python3.7/site-packages/jupyterlab
[I 2023-08-02 19:29:12.165 LabApp] JupyterLab application directory is /srv/conda/envs/notebook/share/jupyter/lab
[I 19:29:12.176 NotebookApp] nteract extension loaded from /srv/conda/envs/notebook/lib/python3.7/site-packages/nteract_on_jupyter
[I 19:29:12.180 NotebookApp] Serving notebooks from local directory: /home/jovyan
[I 19:29:12.180 NotebookApp] Jupyter Notebook 6.4.12 is running at:
[I 19:29:12.180 NotebookApp] http://ec43c0bfdd1c:8888/
[I 19:29:12.180 NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).
[W 19:29:12.195 NotebookApp] No web browser found: could not locate runnable browser.
[I 19:30:21.999 NotebookApp] 301 GET /static/favicons/favicon.ico (172.24.0.1) 0.670000ms
[I 2023-08-02 19:30:25.686 LabApp] Build is up to date
[W 19:30:52.983 NotebookApp] Collisions detected in /home/jovyan/.jupyter/jupyter_notebook_config.py and /home/jovyan/.jupyter/jupyter_notebook_config.json config files. /home/jovyan/.jupyter/jupyter_notebook_config.json has higher priority: {
      "NotebookApp": {
        "password": "'' ignored, using 'argon2:$argon2id$v=19$m=10240,t=10,p=8$ZmkKwBPY7SHyhu/M4lUPdg$tdk6jy8Z9Fj2eCjHXTJCGDWY8OT4vNNruv21gO7uNc8'"
      }
    }
[W 2023-08-02 19:30:54.136 LabApp] 'ip' has moved from NotebookApp to ServerApp. This config will be passed to ServerApp. Be sure to update your config before our next release.
[W 2023-08-02 19:30:54.137 LabApp] 'token' has moved from NotebookApp to ServerApp. This config will be passed to ServerApp. Be sure to update your config before our next release.
[W 2023-08-02 19:30:54.137 LabApp] 'password' has moved from NotebookApp to ServerApp. This config will be passed to ServerApp. Be sure to update your config before our next release.
[W 2023-08-02 19:30:54.137 LabApp] 'password' has moved from NotebookApp to ServerApp. This config will be passed to ServerApp. Be sure to update your config before our next release.
[I 2023-08-02 19:30:54.151 LabApp] JupyterLab extension loaded from /srv/conda/envs/notebook/lib/python3.7/site-packages/jupyterlab
[I 2023-08-02 19:30:54.151 LabApp] JupyterLab application directory is /srv/conda/envs/notebook/share/jupyter/lab
[I 19:30:54.161 NotebookApp] nteract extension loaded from /srv/conda/envs/notebook/lib/python3.7/site-packages/nteract_on_jupyter
[I 19:30:54.165 NotebookApp] Serving notebooks from local directory: /home/jovyan
[I 19:30:54.165 NotebookApp] Jupyter Notebook 6.4.12 is running at:
[I 19:30:54.165 NotebookApp] http://ec43c0bfdd1c:8888/
[I 19:30:54.165 NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).
[W 19:30:54.180 NotebookApp] No web browser found: could not locate runnable browser.
[W 19:30:55.116 NotebookApp] wrote error: 'Forbidden'
[W 19:30:55.117 NotebookApp] 403 GET /api/metrics/v1?1691004655115 (172.24.0.1) 1.980000ms referer=https://jupyter6.clearnasdss.synology.me/lab
[I 19:30:56.841 NotebookApp] 302 GET /lab (172.24.0.1) 1.170000ms
[W 19:30:56.963 NotebookApp] Forbidden
[W 19:30:56.963 NotebookApp] 403 GET /api/contents?content=1&1691004656961 (172.24.0.1) 1.520000ms referer=https://jupyter6.clearnasdss.synology.me/lab
[I 19:31:02.258 NotebookApp] 302 POST /login?next=%2Flab (172.24.0.1) 156.290000ms
[I 2023-08-02 19:31:05.757 LabApp] Build is up to date
[I 19:31:08.805 NotebookApp] Writing notebook-signing key to /home/jovyan/.local/share/jupyter/notebook_secret
[W 19:31:08.808 NotebookApp] Notebook KNO3_pH9pt5_1uMCuT.ipynb is not trusted
[I 19:31:09.057 NotebookApp] Kernel started: 796ba640-abe1-49e7-a4ab-c2536ef9ec41, name: xoctave
Serving notebooks from local directory: /home/jovyan
1 active kernel
Jupyter Notebook 6.4.12 is running at:
http://ec43c0bfdd1c:8888/
OpenGL vendor: VMware, Inc.
OpenGL renderer: llvmpipe (LLVM 10.0.0, 128 bits)
OpenGL version: 3.1 Mesa 20.0.8
Run with XEUS 3.0.5
[I 19:31:09.862 NotebookApp] 301 GET /static/favicons/favicon-busy-1.ico (172.24.0.1) 3.750000ms
[W 19:31:09.868 NotebookApp] Got events for closed stream <zmq.eventloop.zmqstream.ZMQStream object at 0x7f38a9903690>
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	"cumulative vol added"	pH	mvA	delta
% 1	30	90	0	2.029	73.3	9.97
% 1	35	95	0	2.023	73.4	0.02
% 1	40	100	0	2.022	76.8	0.68
% 1	45	105	0	2.002	77.8	0.2
% 1	55	115	0	2.004	74.9	-0.29
% 2	5	125	0	2.002	74.5	-0.04
%2	10	130	0	2.002	74.6	0.02
2	15	135	0	2.002	74.8	0.04
2	17	137	0	2.002	79.3	2.25
% 2	22	142	50	2.002	90	2.14
% 2	27	147	50	2.001	93.5	0.7
% 2	32	152	50	2.002	96.3	0.56
% 2	37	157	50	2.001	95.8	-0.1
%2	42	162	50	2.002	91.4	-0.88
%2	47	167	50	2	91	-0.08
%2	52	172	50	2.001	90.6	-0.08
% 2	57	177	150	2.000	90.6	0
% 2	58	178	150	2.001	94.4	3.8
% 3	3	183	150	2.002	100	1.12
% 3	8	188	150	2	101.3	0.26
% 3	13	193	150	2.001	107.5	1.24
% 3	18	198	150	2	108.7	0.24
% 3	23	203	150	2.002	108.6	-0.02
%3	28	208	150	2.001	109	0.08
%3	33	213	150	2	108.8	-0.04
3	38	218	150	2.001	108.4	-0.08
% 3	43	223	400	1.999	108.4	0
% 3	44	224	400	2.001	114.1	5.7
% 3	49	229	400	2.003	118.4	0.86
% 3	54	234	400	2.001	118.2	-0.04
%3	59	239	400	2.002	118	-0.04
4	4	244	400	2.002	118.4	0.08
% 4	5	245	900	2.005	122.1	3.7
% 4	10	250	900	2.005	126.6	0.9
% 4	15	255	900	2.005	128	0.28
%4	20	260	900	2.005	128.5	0.1
%4	25	265	900	2.006	128.2	-0.06
4	30	270	900	2.004	127.8	-0.08
% 4	31	271	1900	2.011	133	5.2
% 4	36	276	1900	2.012	136.5	0.7
% 4	41	281	1900	2.011	137.2	0.14
% 4	46	286	1900	2.011	137.4	0.04
%4	51	291	1900	2.01	136.8	-0.12
4	56	296	1900	2.011	137.2	0.08
% 5	1	301	3400	2.011	136.8	-0.08
% 5	3	303	3400	2.02	142.5	2.85
% 5	8	308	3400	2.022	143.2	0.14
% 5	13	313	3400	2.021	143.4	0.04
% 5	18	318	3400	2.022	143.1	-0.06
% 5	23	323	3400	2.021	142	-0.22
% 5	28	328	3400	2.021	142.4	0.08
% 5	33	333	3400	2.021	142	-0.08
%5	38	338	3400	2.019	141.1	-0.18
5	43	343	3400	2.019	142.2	0.22
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative vol added	pH	mvA	delta	mVB	deltaB	comments
% 0	0	0	0	9.625	60.9	
% 0	5	5	0	9.657	47.3	-2.72
% 0	15	15	0	9.574	-34.7	-8.2
% 0	20	20	0	9.643	-33	0.34
% 0	25	25	0	9.256	-19	2.8
% 0	30	30	0	9.54	-29.6	-2.12
% 0	35	35	0	9.537	-28.8	0.16
% 0	40	40	0	9.54	-28.4	0.08
% 0	45	45	0	9.532	-27	0.28
% 0	50	50	0	9.527	-27.6	-0.12
% 0	55	55	0	9.517	-27.7	-0.02
% 1	0	60	0	9.512	-27.7	0
% 1	5	65	0	9.502	-26.2	0.3
%1	10	70	0	9.501	-26.3	-0.02
%1	15	75	0	9.486	-26.5	-0.04
1	20	80	0	9.482	-26.4	0.02
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-6;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus),Emeas,1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

%plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -11.0185 50 0.253456 35.7873

list
string: Total Cu
 -5.91521 40 0.230415 26.2927

[I 19:33:08.965 NotebookApp] Saving file at /KNO3_pH9pt5_1uMCuT.ipynb
[W 19:44:59.699 NotebookApp] 404 GET /api/contents/KNO3_pH8_0pt1uMCuT.ipynb?1691005499700 (172.24.0.1): file or directory does not exist: 'KNO3_pH8_0pt1uMCuT.ipynb'
[W 19:44:59.699 NotebookApp] file or directory does not exist: 'KNO3_pH8_0pt1uMCuT.ipynb'
[W 19:44:59.700 NotebookApp] 404 GET /api/contents/KNO3_pH8_0pt1uMCuT.ipynb?1691005499700 (172.24.0.1) 1.880000ms referer=https://jupyter6.clearnasdss.synology.me/lab/tree/KNO3_pH9pt5_1uMCuT.ipynb
[W 19:44:59.719 NotebookApp] 404 GET /api/contents/KNO3_pH8_0pt1uMCuT.ipynb?content=0&1691005499721 (172.24.0.1): file or directory does not exist: 'KNO3_pH8_0pt1uMCuT.ipynb'
[W 19:44:59.719 NotebookApp] file or directory does not exist: 'KNO3_pH8_0pt1uMCuT.ipynb'
[W 19:44:59.720 NotebookApp] 404 GET /api/contents/KNO3_pH8_0pt1uMCuT.ipynb?content=0&1691005499721 (172.24.0.1) 1.590000ms referer=https://jupyter6.clearnasdss.synology.me/lab/tree/KNO3_pH9pt5_1uMCuT.ipynb
[I 19:44:59.832 NotebookApp] Uploading file to /KNO3_pH8_0pt1uMCuT.ipynb
[I 19:46:59.885 NotebookApp] Saving file at /KNO3_pH8_0pt1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
4	35	275	0	2.001	115.1	0.2
4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
4	35	275	0	2.001	115.1	0.2
4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus),Emeas,1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

%plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

list
string: -25
list
string: -20
list
string: -15
list
string: -10
list
string: -5
list
string: 0
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -12.2085 50 0.633641 35.7873

list
string: Total Cu
 -7.08802 40 0.576037 26.2927

[I 19:48:59.929 NotebookApp] Saving file at /KNO3_pH8_0pt1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
%4	35	275	0	2.001	115.1	0.2
%4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus),Emeas,1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

%plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -12.0438 50 0.304147 35.7873

list
string: Total Cu
 -6.93825 40 0.276498 26.2927

[I 19:50:59.977 NotebookApp] Saving file at /KNO3_pH8_0pt1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
%4	35	275	0	2.001	115.1	0.2
%4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus),Emeas,1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

%plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -12.0438 50 0.304147 35.7873

list
string: Total Cu
 -6.93825 40 0.276498 26.2927

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

%plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-13 -3 0 150])

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 20
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -12.0185 50 0.253456 21.4724

list
string: Total Cu
 -6.91521 40 0.230415 15.7756

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

%plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-13 -3 40 150])

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -12.0185 50 0.253456 15.7464

list
string: Total Cu
 -6.91521 40 0.230415 11.5688

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

%plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,20,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-13 -3 40 150])

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -12.0185 50 0.253456 15.7464

list
string: Total Cu
 -6.91521 20 0.230415 11.5688

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

%plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-13 -3 40 150])

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -12.0185 50 0.253456 15.7464

list
string: Total Cu
 -6.91521 60 0.230415 11.5688

[I 19:52:49.879 NotebookApp] Kernel started: 501c1611-0792-428b-aec5-598ef5cf05cd, name: xoctave
OpenGL vendor: VMware, Inc.
OpenGL renderer: llvmpipe (LLVM 10.0.0, 128 bits)
OpenGL version: 3.1 Mesa 20.0.8
Run with XEUS 3.0.5
[I 19:53:00.028 NotebookApp] Saving file at /KNO3_pH8_0pt1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	"cumulative vol added"	pH	mvA	delta
% 1	30	90	0	2.029	73.3	9.97
% 1	35	95	0	2.023	73.4	0.02
% 1	40	100	0	2.022	76.8	0.68
% 1	45	105	0	2.002	77.8	0.2
% 1	55	115	0	2.004	74.9	-0.29
% 2	5	125	0	2.002	74.5	-0.04
%2	10	130	0	2.002	74.6	0.02
%2	15	135	0	2.002	74.8	0.04
%2	17	137	0	2.002	79.3	2.25
% 2	22	142	50	2.002	90	2.14
% 2	27	147	50	2.001	93.5	0.7
% 2	32	152	50	2.002	96.3	0.56
% 2	37	157	50	2.001	95.8	-0.1
%2	42	162	50	2.002	91.4	-0.88
%2	47	167	50	2	91	-0.08
%2	52	172	50	2.001	90.6	-0.08
% 2	57	177	150	2.000	90.6	0
% 2	58	178	150	2.001	94.4	3.8
% 3	3	183	150	2.002	100	1.12
% 3	8	188	150	2	101.3	0.26
% 3	13	193	150	2.001	107.5	1.24
% 3	18	198	150	2	108.7	0.24
% 3	23	203	150	2.002	108.6	-0.02
%3	28	208	150	2.001	109	0.08
%3	33	213	150	2	108.8	-0.04
3	38	218	150	2.001	108.4	-0.08
% 3	43	223	400	1.999	108.4	0
% 3	44	224	400	2.001	114.1	5.7
% 3	49	229	400	2.003	118.4	0.86
% 3	54	234	400	2.001	118.2	-0.04
%3	59	239	400	2.002	118	-0.04
4	4	244	400	2.002	118.4	0.08
% 4	5	245	900	2.005	122.1	3.7
% 4	10	250	900	2.005	126.6	0.9
% 4	15	255	900	2.005	128	0.28
%4	20	260	900	2.005	128.5	0.1
%4	25	265	900	2.006	128.2	-0.06
4	30	270	900	2.004	127.8	-0.08
% 4	31	271	1900	2.011	133	5.2
% 4	36	276	1900	2.012	136.5	0.7
% 4	41	281	1900	2.011	137.2	0.14
% 4	46	286	1900	2.011	137.4	0.04
%4	51	291	1900	2.01	136.8	-0.12
4	56	296	1900	2.011	137.2	0.08
% 5	1	301	3400	2.011	136.8	-0.08
% 5	3	303	3400	2.02	142.5	2.85
% 5	8	308	3400	2.022	143.2	0.14
% 5	13	313	3400	2.021	143.4	0.04
% 5	18	318	3400	2.022	143.1	-0.06
% 5	23	323	3400	2.021	142	-0.22
% 5	28	328	3400	2.021	142.4	0.08
% 5	33	333	3400	2.021	142	-0.08
%5	38	338	3400	2.019	141.1	-0.18
5	43	343	3400	2.019	142.2	0.22
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative vol added	pH	mvA	delta	mVB	deltaB	comments
% 0	0	0	0	9.625	60.9	
% 0	5	5	0	9.657	47.3	-2.72
% 0	15	15	0	9.574	-34.7	-8.2
% 0	20	20	0	9.643	-33	0.34
% 0	25	25	0	9.256	-19	2.8
% 0	30	30	0	9.54	-29.6	-2.12
% 0	35	35	0	9.537	-28.8	0.16
% 0	40	40	0	9.54	-28.4	0.08
% 0	45	45	0	9.532	-27	0.28
% 0	50	50	0	9.527	-27.6	-0.12
% 0	55	55	0	9.517	-27.7	-0.02
% 1	0	60	0	9.512	-27.7	0
% 1	5	65	0	9.502	-26.2	0.3
%1	10	70	0	9.501	-26.3	-0.02
%1	15	75	0	9.486	-26.5	-0.04
1	20	80	0	9.482	-26.4	0.02
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-6;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus),Emeas,1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

%plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -11.0185 50 0.253456 35.7873

list
string: Total Cu
 -5.91521 40 0.230415 26.2927

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	"cumulative vol added"	pH	mvA	delta
% 1	30	90	0	2.029	73.3	9.97
% 1	35	95	0	2.023	73.4	0.02
% 1	40	100	0	2.022	76.8	0.68
% 1	45	105	0	2.002	77.8	0.2
% 1	55	115	0	2.004	74.9	-0.29
% 2	5	125	0	2.002	74.5	-0.04
%2	10	130	0	2.002	74.6	0.02
%2	15	135	0	2.002	74.8	0.04
%2	17	137	0	2.002	79.3	2.25
% 2	22	142	50	2.002	90	2.14
% 2	27	147	50	2.001	93.5	0.7
% 2	32	152	50	2.002	96.3	0.56
% 2	37	157	50	2.001	95.8	-0.1
%2	42	162	50	2.002	91.4	-0.88
2	47	167	50	2	91	-0.08
2	52	172	50	2.001	90.6	-0.08
% 2	57	177	150	2.000	90.6	0
% 2	58	178	150	2.001	94.4	3.8
% 3	3	183	150	2.002	100	1.12
% 3	8	188	150	2	101.3	0.26
% 3	13	193	150	2.001	107.5	1.24
% 3	18	198	150	2	108.7	0.24
% 3	23	203	150	2.002	108.6	-0.02
%3	28	208	150	2.001	109	0.08
%3	33	213	150	2	108.8	-0.04
3	38	218	150	2.001	108.4	-0.08
% 3	43	223	400	1.999	108.4	0
% 3	44	224	400	2.001	114.1	5.7
% 3	49	229	400	2.003	118.4	0.86
% 3	54	234	400	2.001	118.2	-0.04
%3	59	239	400	2.002	118	-0.04
4	4	244	400	2.002	118.4	0.08
% 4	5	245	900	2.005	122.1	3.7
% 4	10	250	900	2.005	126.6	0.9
% 4	15	255	900	2.005	128	0.28
%4	20	260	900	2.005	128.5	0.1
%4	25	265	900	2.006	128.2	-0.06
4	30	270	900	2.004	127.8	-0.08
% 4	31	271	1900	2.011	133	5.2
% 4	36	276	1900	2.012	136.5	0.7
% 4	41	281	1900	2.011	137.2	0.14
% 4	46	286	1900	2.011	137.4	0.04
%4	51	291	1900	2.01	136.8	-0.12
4	56	296	1900	2.011	137.2	0.08
% 5	1	301	3400	2.011	136.8	-0.08
% 5	3	303	3400	2.02	142.5	2.85
% 5	8	308	3400	2.022	143.2	0.14
% 5	13	313	3400	2.021	143.4	0.04
% 5	18	318	3400	2.022	143.1	-0.06
% 5	23	323	3400	2.021	142	-0.22
% 5	28	328	3400	2.021	142.4	0.08
% 5	33	333	3400	2.021	142	-0.08
%5	38	338	3400	2.019	141.1	-0.18
5	43	343	3400	2.019	142.2	0.22
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative vol added	pH	mvA	delta	mVB	deltaB	comments
% 0	0	0	0	9.625	60.9	
% 0	5	5	0	9.657	47.3	-2.72
% 0	15	15	0	9.574	-34.7	-8.2
% 0	20	20	0	9.643	-33	0.34
% 0	25	25	0	9.256	-19	2.8
% 0	30	30	0	9.54	-29.6	-2.12
% 0	35	35	0	9.537	-28.8	0.16
% 0	40	40	0	9.54	-28.4	0.08
% 0	45	45	0	9.532	-27	0.28
% 0	50	50	0	9.527	-27.6	-0.12
% 0	55	55	0	9.517	-27.7	-0.02
% 1	0	60	0	9.512	-27.7	0
% 1	5	65	0	9.502	-26.2	0.3
%1	10	70	0	9.501	-26.3	-0.02
%1	15	75	0	9.486	-26.5	-0.04
1	20	80	0	9.482	-26.4	0.02
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-6;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus),Emeas,1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

%plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -150
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -11.0185 50 0.253456 42.9448

list
string: Total Cu
 -5.91521 40 0.230415 31.5513

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	"cumulative vol added"	pH	mvA	delta
% 1	30	90	0	2.029	73.3	9.97
% 1	35	95	0	2.023	73.4	0.02
% 1	40	100	0	2.022	76.8	0.68
% 1	45	105	0	2.002	77.8	0.2
% 1	55	115	0	2.004	74.9	-0.29
% 2	5	125	0	2.002	74.5	-0.04
%2	10	130	0	2.002	74.6	0.02
2	15	135	0	2.002	74.8	0.04
2	17	137	0	2.002	79.3	2.25
% 2	22	142	50	2.002	90	2.14
% 2	27	147	50	2.001	93.5	0.7
% 2	32	152	50	2.002	96.3	0.56
% 2	37	157	50	2.001	95.8	-0.1
%2	42	162	50	2.002	91.4	-0.88
%2	47	167	50	2	91	-0.08
%2	52	172	50	2.001	90.6	-0.08
% 2	57	177	150	2.000	90.6	0
% 2	58	178	150	2.001	94.4	3.8
% 3	3	183	150	2.002	100	1.12
% 3	8	188	150	2	101.3	0.26
% 3	13	193	150	2.001	107.5	1.24
% 3	18	198	150	2	108.7	0.24
% 3	23	203	150	2.002	108.6	-0.02
%3	28	208	150	2.001	109	0.08
%3	33	213	150	2	108.8	-0.04
3	38	218	150	2.001	108.4	-0.08
% 3	43	223	400	1.999	108.4	0
% 3	44	224	400	2.001	114.1	5.7
% 3	49	229	400	2.003	118.4	0.86
% 3	54	234	400	2.001	118.2	-0.04
%3	59	239	400	2.002	118	-0.04
4	4	244	400	2.002	118.4	0.08
% 4	5	245	900	2.005	122.1	3.7
% 4	10	250	900	2.005	126.6	0.9
% 4	15	255	900	2.005	128	0.28
%4	20	260	900	2.005	128.5	0.1
%4	25	265	900	2.006	128.2	-0.06
4	30	270	900	2.004	127.8	-0.08
% 4	31	271	1900	2.011	133	5.2
% 4	36	276	1900	2.012	136.5	0.7
% 4	41	281	1900	2.011	137.2	0.14
% 4	46	286	1900	2.011	137.4	0.04
%4	51	291	1900	2.01	136.8	-0.12
4	56	296	1900	2.011	137.2	0.08
% 5	1	301	3400	2.011	136.8	-0.08
% 5	3	303	3400	2.02	142.5	2.85
% 5	8	308	3400	2.022	143.2	0.14
% 5	13	313	3400	2.021	143.4	0.04
% 5	18	318	3400	2.022	143.1	-0.06
% 5	23	323	3400	2.021	142	-0.22
% 5	28	328	3400	2.021	142.4	0.08
% 5	33	333	3400	2.021	142	-0.08
%5	38	338	3400	2.019	141.1	-0.18
5	43	343	3400	2.019	142.2	0.22
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative vol added	pH	mvA	delta	mVB	deltaB	comments
% 0	0	0	0	9.625	60.9	
% 0	5	5	0	9.657	47.3	-2.72
% 0	15	15	0	9.574	-34.7	-8.2
% 0	20	20	0	9.643	-33	0.34
% 0	25	25	0	9.256	-19	2.8
% 0	30	30	0	9.54	-29.6	-2.12
% 0	35	35	0	9.537	-28.8	0.16
% 0	40	40	0	9.54	-28.4	0.08
% 0	45	45	0	9.532	-27	0.28
% 0	50	50	0	9.527	-27.6	-0.12
% 0	55	55	0	9.517	-27.7	-0.02
% 1	0	60	0	9.512	-27.7	0
% 1	5	65	0	9.502	-26.2	0.3
%1	10	70	0	9.501	-26.3	-0.02
%1	15	75	0	9.486	-26.5	-0.04
1	20	80	0	9.482	-26.4	0.02
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-6;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus),Emeas,1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

%plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -11.0185 50 0.253456 35.7873

list
string: Total Cu
 -5.91521 40 0.230415 26.2927

[I 19:54:49.772 NotebookApp] Saving file at /KNO3_pH9pt5_1uMCuT.ipynb
[I 19:56:49.816 NotebookApp] Saving file at /KNO3_pH9pt5_1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	"cumulative vol added"	pH	mvA	delta
% 1	30	90	0	2.029	73.3	9.97
% 1	35	95	0	2.023	73.4	0.02
% 1	40	100	0	2.022	76.8	0.68
% 1	45	105	0	2.002	77.8	0.2
% 1	55	115	0	2.004	74.9	-0.29
% 2	5	125	0	2.002	74.5	-0.04
%2	10	130	0	2.002	74.6	0.02
2	15	135	0	2.002	74.8	0.04
2	17	137	0	2.002	79.3	2.25
% 2	22	142	50	2.002	90	2.14
% 2	27	147	50	2.001	93.5	0.7
% 2	32	152	50	2.002	96.3	0.56
% 2	37	157	50	2.001	95.8	-0.1
%2	42	162	50	2.002	91.4	-0.88
%2	47	167	50	2	91	-0.08
%2	52	172	50	2.001	90.6	-0.08
% 2	57	177	150	2.000	90.6	0
% 2	58	178	150	2.001	94.4	3.8
% 3	3	183	150	2.002	100	1.12
% 3	8	188	150	2	101.3	0.26
% 3	13	193	150	2.001	107.5	1.24
% 3	18	198	150	2	108.7	0.24
% 3	23	203	150	2.002	108.6	-0.02
%3	28	208	150	2.001	109	0.08
%3	33	213	150	2	108.8	-0.04
3	38	218	150	2.001	108.4	-0.08
% 3	43	223	400	1.999	108.4	0
% 3	44	224	400	2.001	114.1	5.7
% 3	49	229	400	2.003	118.4	0.86
% 3	54	234	400	2.001	118.2	-0.04
%3	59	239	400	2.002	118	-0.04
4	4	244	400	2.002	118.4	0.08
% 4	5	245	900	2.005	122.1	3.7
% 4	10	250	900	2.005	126.6	0.9
% 4	15	255	900	2.005	128	0.28
%4	20	260	900	2.005	128.5	0.1
%4	25	265	900	2.006	128.2	-0.06
4	30	270	900	2.004	127.8	-0.08
% 4	31	271	1900	2.011	133	5.2
% 4	36	276	1900	2.012	136.5	0.7
% 4	41	281	1900	2.011	137.2	0.14
% 4	46	286	1900	2.011	137.4	0.04
%4	51	291	1900	2.01	136.8	-0.12
4	56	296	1900	2.011	137.2	0.08
% 5	1	301	3400	2.011	136.8	-0.08
% 5	3	303	3400	2.02	142.5	2.85
% 5	8	308	3400	2.022	143.2	0.14
% 5	13	313	3400	2.021	143.4	0.04
% 5	18	318	3400	2.022	143.1	-0.06
% 5	23	323	3400	2.021	142	-0.22
% 5	28	328	3400	2.021	142.4	0.08
% 5	33	333	3400	2.021	142	-0.08
%5	38	338	3400	2.019	141.1	-0.18
5	43	343	3400	2.019	142.2	0.22
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative vol added	pH	mvA	delta	mVB	deltaB	comments
% 0	0	0	0	9.625	60.9	
% 0	5	5	0	9.657	47.3	-2.72
% 0	15	15	0	9.574	-34.7	-8.2
% 0	20	20	0	9.643	-33	0.34
% 0	25	25	0	9.256	-19	2.8
% 0	30	30	0	9.54	-29.6	-2.12
% 0	35	35	0	9.537	-28.8	0.16
% 0	40	40	0	9.54	-28.4	0.08
% 0	45	45	0	9.532	-27	0.28
% 0	50	50	0	9.527	-27.6	-0.12
% 0	55	55	0	9.517	-27.7	-0.02
% 1	0	60	0	9.512	-27.7	0
% 1	5	65	0	9.502	-26.2	0.3
%1	10	70	0	9.501	-26.3	-0.02
%1	15	75	0	9.486	-26.5	-0.04
1	20	80	0	9.482	-26.4	0.02
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-6;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus),Emeas,1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -11.0185 50 0.253456 35.7873

list
string: Total Cu
 -5.91521 40 0.230415 26.2927

[I 19:57:13.352 NotebookApp] Saving file at /KNO3_pH9pt5_1uMCuT.ipynb
[W 19:57:26.789 NotebookApp] 404 GET /api/contents/KNO3_pH10_0pt1uMCuT.ipynb?1691006246792 (172.24.0.1): file or directory does not exist: 'KNO3_pH10_0pt1uMCuT.ipynb'
[W 19:57:26.790 NotebookApp] file or directory does not exist: 'KNO3_pH10_0pt1uMCuT.ipynb'
[W 19:57:26.791 NotebookApp] 404 GET /api/contents/KNO3_pH10_0pt1uMCuT.ipynb?1691006246792 (172.24.0.1) 2.950000ms referer=https://jupyter6.clearnasdss.synology.me/lab/tree/KNO3_pH8_0pt1uMCuT.ipynb
[W 19:57:26.811 NotebookApp] 404 GET /api/contents/KNO3_pH10_0pt1uMCuT.ipynb?content=0&1691006246814 (172.24.0.1): file or directory does not exist: 'KNO3_pH10_0pt1uMCuT.ipynb'
[W 19:57:26.812 NotebookApp] file or directory does not exist: 'KNO3_pH10_0pt1uMCuT.ipynb'
[W 19:57:26.813 NotebookApp] 404 GET /api/contents/KNO3_pH10_0pt1uMCuT.ipynb?content=0&1691006246814 (172.24.0.1) 2.940000ms referer=https://jupyter6.clearnasdss.synology.me/lab/tree/KNO3_pH8_0pt1uMCuT.ipynb
[I 19:57:26.821 NotebookApp] Uploading file to /KNO3_pH10_0pt1uMCuT.ipynb
[I 19:58:08.451 NotebookApp] Kernel started: 7c3981ad-5a7c-4d29-a312-81b6a13e5d7a, name: xoctave
OpenGL vendor: VMware, Inc.
OpenGL renderer: llvmpipe (LLVM 10.0.0, 128 bits)
OpenGL version: 3.1 Mesa 20.0.8
Run with XEUS 3.0.5
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
%4	35	275	0	2.001	115.1	0.2
%4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus),Emeas,1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

%plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-13 -3 40 150])

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.12544 50 0.253456 15.7464

list
string: Total Cu
 -6.91521 60 0.230415 11.5688

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
4	35	275	0	2.001	115.1	0.2
4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus),Emeas,1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

%plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-13 -3 40 150])

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.12544 50 0.253456 15.7464

list
string: Total Cu
 -6.91521 60 0.230415 11.5688

[I 19:59:26.874 NotebookApp] Saving file at /KNO3_pH10_0pt1uMCuT.ipynb
[I 20:00:08.339 NotebookApp] Saving file at /KNO3_pH8_0pt1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
%4	35	275	0	2.001	115.1	0.2
%4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
%5	45	345	50	1.995	119.6	0.1
%5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus),Emeas,1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

%plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-13 -3 40 150])

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.12544 50 0.253456 15.7464

list
string: Total Cu
 -6.91521 60 0.230415 11.5688

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
4	35	275	0	2.001	115.1	0.2
4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
%5	45	345	50	1.995	119.6	0.1
%5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus),Emeas,1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

%plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-13 -3 40 150])

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.12544 50 0.253456 15.7464

list
string: Total Cu
 -6.91521 60 0.230415 11.5688

[I 20:20:08.458 NotebookApp] Saving file at /KNO3_pH8_0pt1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
%4	35	275	0	2.001	115.1	0.2
%4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus),Emeas,1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

%plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-13 -3 40 150])

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.12544 50 0.253456 15.7464

list
string: Total Cu
 -6.91521 60 0.230415 11.5688

Executing: % try one point, assume Nernst slope

Eo=115-(59.2/2)*log10(CuTmeas)
[I 20:22:08.498 NotebookApp] Saving file at /KNO3_pH8_0pt1uMCuT.ipynb
[I 20:24:08.546 NotebookApp] Saving file at /KNO3_pH8_0pt1uMCuT.ipynb
Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=115; Eorig=52;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(E-Eo)/m
Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=115; Eorig=52;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
[I 20:26:08.586 NotebookApp] Saving file at /KNO3_pH8_0pt1uMCuT.ipynb
Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=115; Eorig=52; m=21.5;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=115; Eorig=52; %m=21.5;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

%plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-13 -3 40 150])

plot(logCuonept,Eorig,'ko','markerfillcolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.12544 50 0.253456 15.7464

list
string: Total Cu
 -6.91521 60 0.230415 11.5688

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
%4	35	275	0	2.001	115.1	0.2
%4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus),Emeas,1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=115; Eorig=52; %m=21.5;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

%plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-13 -3 40 150])

plot(logCuonept,Eorig,'ko','markerfillcolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.12544 50 0.253456 15.7464

list
string: Total Cu
 -6.91521 60 0.230415 11.5688

[I 20:28:08.632 NotebookApp] Saving file at /KNO3_pH8_0pt1uMCuT.ipynb
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

%plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-13 -3 40 150])

plot(logCuonept,Eorig,'ko','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.12544 50 0.253456 15.7464

list
string: Total Cu
 -6.91521 60 0.230415 11.5688

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

%plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-13 -3 40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.12544 50 0.253456 15.7464

list
string: Total Cu
 -6.91521 60 0.230415 11.5688

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
4	35	275	0	2.001	115.1	0.2
4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus),Emeas,1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=115; Eorig=52; %m=21.5;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

%plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-13 -3 40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.12544 50 0.253456 15.7464

list
string: Total Cu
 -6.91521 60 0.230415 11.5688

[I 20:30:08.674 NotebookApp] Saving file at /KNO3_pH8_0pt1uMCuT.ipynb
[I 20:39:27.080 NotebookApp] Saving file at /KNO3_pH10_0pt1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%1	17	77	0	2.009	78.1	13.6285714285714
%1	23	83	0	2.000	73.8	-0.716666666666666
%1	28	88	0	1.999	76	0.440000000000001
%1	33	93	0	1.999	77.8	0.359999999999999
%1	38	98	0	1.995	79.4	0.320000000000002
%1	43	103	0	1.996	81.8	0.479999999999998
%1	48	108	0	1.995	84	0.440000000000001
%1	53	113	0	2.005	86	0.4
%1	58	118	0	2.006	87.7	0.340000000000001
%2	3	123	0	2.008	89.8	0.419999999999999
%2	8	128	0	2.009	90.4	0.120000000000002
%2	13	133	0	2.006	91	0.119999999999999
%2	18	138	0	2.006	91.7	0.140000000000001
%2	23	143	0	2.005	92.3	0.119999999999999
%2	28	148	0	2.004	92.4	0.0200000000000017
%2	33	153	0	2.007	93.4	0.2
%2	38	158	0	2.003	93.9	0.1
%2	43	163	0	2.002	95	0.219999999999999
%2	48	168	0	2.001	95.4	0.0800000000000011
2	53	173	0	2.002	95.6	0.0399999999999977
2	58	178	0	2.001	95.6	0
%3	0	180	50	2.001	97.9	1.15000000000001
%3	5	185	50	2	102.8	0.979999999999998
%3	10	190	50	2	103.8	0.2
%3	22	202	50	1.998	105.2	0.116666666666667
%3	32	212	50	1.997	106.2	0.1
%3	37	217	50	1.996	107	0.159999999999999
%3	42	222	50	1.995	106.6	-0.0800000000000011
%3	47	227	50	1.995	107.2	0.120000000000002
%3	52	232	50	1.995	107.6	0.0799999999999983
%3	57	237	50	1.996	107.3	-0.0599999999999994
%4	2	242	50	2.021	108.5	0.240000000000001
%4	7	247	50	2.021	108.7	0.0400000000000006
4	12	252	50	2.021	108.3	-0.0800000000000011
4	17	257	50	2.021	108.8	0.1
%4	19	259	150	2.02	110	0.600000000000001
%4	24	264	150	2.021	115.7	1.14
%4	29	269	150	2.02	117	0.259999999999999
%4	34	274	150	2.02	115.5	-0.3
%4	39	279	150	2.02	116.3	0.159999999999999
%4	44	284	150	2.019	117.3	0.2
%4	49	289	150	2.019	116.8	-0.1
%4	54	294	150	2.019	118.5	0.340000000000001
%4	59	299	150	2.019	118	-0.1
5	4	304	150	2.019	118.1	0.0199999999999989
5	14	314	150	2.018	118.4	0.0300000000000011
%5	15	315	400	2.02	121.6	3.19999999999999
%5	20	320	400	2.019	125.8	0.840000000000001
%5	25	325	400	2.019	127.5	0.340000000000001
%5	30	330	400	2.019	126.4	-0.219999999999999
%5	35	335	400	2.019	127.8	0.279999999999998
5	40	340	400	2.019	127.6	-0.0400000000000006
5	45	345	400	2.019	127.4	-0.0399999999999977
%5	46	346	900	2.022	129.9	2.5
%5	51	351	900	2.022	135.3	1.08
%5	56	356	900	2.022	135.9	0.119999999999999
%6	1	361	900	2.022	136.8	0.180000000000001
%6	6	366	900	2.023	137.1	0.0599999999999966
6	11	371	900	2.022	137.4	0.0600000000000023
6	16	376	900	2.023	137.3	-0.0199999999999989
%6	17	377	1900	2.029	142	4.69999999999999
%6	22	382	1900	2.029	144.5	0.5
%6	27	387	1900	2.029	144.8	0.0600000000000023
%6	32	392	1900	2.028	145.2	0.0799999999999955
%6	37	397	1900	2.028	146.3	0.220000000000005
%6	42	402	1900	2.028	146.7	0.0799999999999955
%6	47	407	1900	2.028	147.4	0.140000000000003
6	52	412	1900	2.028	147.2	-0.0400000000000034
6	58	418	1900	2.028	145.9	-0.216666666666664
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	10	-29.6	
%0	5	5	0	9.928	-26.9	0.540000000000001
%0	15	15	0	9.866	-23.2	0.37
%0	20	20	0	9.855	-23.3	-0.0200000000000003
%0	25	25	0	9.804	-19.7	0.72
%0	30	30	0	9.791	-20.4	-0.14
%0	35	35	0	9.782	-19.8	0.12
%0	40	40	0	9.755	-19.3	0.1
50	45	45	0	9.741	-17.4	0.38
%0	55	55	0	9.746	-17.4	0
%1	0	60	0	9.729	-17.7	-0.0600000000000001
%1	5	65	0	9.697	-17	0.14
%1	10	70	0	9.709	-17.3	-0.0600000000000001
%1	17	77	0	2.009	78.1	13.6285714285714
%1	23	83	0	2.000	73.8	-0.716666666666666
%1	28	88	0	1.999	76	0.440000000000001
%1	33	93	0	1.999	77.8	0.359999999999999
%1	38	98	0	1.995	79.4	0.320000000000002
%1	43	103	0	1.996	81.8	0.479999999999998
%1	48	108	0	1.995	84	0.440000000000001
%1	53	113	0	2.005	86	0.4
%1	58	118	0	2.006	87.7	0.340000000000001
%2	3	123	0	2.008	89.8	0.419999999999999
%2	8	128	0	2.009	90.4	0.120000000000002
%2	13	133	0	2.006	91	0.119999999999999
%2	18	138	0	2.006	91.7	0.140000000000001
%2	23	143	0	2.005	92.3	0.119999999999999
%2	28	148	0	2.004	92.4	0.0200000000000017
%2	33	153	0	2.007	93.4	0.2
%2	38	158	0	2.003	93.9	0.1
%2	43	163	0	2.002	95	0.219999999999999
%2	48	168	0	2.001	95.4	0.0800000000000011
2	53	173	0	2.002	95.6	0.0399999999999977
2	58	178	0	2.001	95.6	0
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus),Emeas,1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

%plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-13 -3 40 150])

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -12.0185 50 0.253456 15.7464

list
string: Total Cu
 -6.91521 60 0.230415 11.5688

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%1	17	77	0	2.009	78.1	13.6285714285714
%1	23	83	0	2.000	73.8	-0.716666666666666
%1	28	88	0	1.999	76	0.440000000000001
%1	33	93	0	1.999	77.8	0.359999999999999
%1	38	98	0	1.995	79.4	0.320000000000002
%1	43	103	0	1.996	81.8	0.479999999999998
%1	48	108	0	1.995	84	0.440000000000001
%1	53	113	0	2.005	86	0.4
%1	58	118	0	2.006	87.7	0.340000000000001
%2	3	123	0	2.008	89.8	0.419999999999999
%2	8	128	0	2.009	90.4	0.120000000000002
%2	13	133	0	2.006	91	0.119999999999999
%2	18	138	0	2.006	91.7	0.140000000000001
%2	23	143	0	2.005	92.3	0.119999999999999
%2	28	148	0	2.004	92.4	0.0200000000000017
%2	33	153	0	2.007	93.4	0.2
%2	38	158	0	2.003	93.9	0.1
%2	43	163	0	2.002	95	0.219999999999999
%2	48	168	0	2.001	95.4	0.0800000000000011
2	53	173	0	2.002	95.6	0.0399999999999977
2	58	178	0	2.001	95.6	0
%3	0	180	50	2.001	97.9	1.15000000000001
%3	5	185	50	2	102.8	0.979999999999998
%3	10	190	50	2	103.8	0.2
%3	22	202	50	1.998	105.2	0.116666666666667
%3	32	212	50	1.997	106.2	0.1
%3	37	217	50	1.996	107	0.159999999999999
%3	42	222	50	1.995	106.6	-0.0800000000000011
%3	47	227	50	1.995	107.2	0.120000000000002
%3	52	232	50	1.995	107.6	0.0799999999999983
%3	57	237	50	1.996	107.3	-0.0599999999999994
%4	2	242	50	2.021	108.5	0.240000000000001
%4	7	247	50	2.021	108.7	0.0400000000000006
4	12	252	50	2.021	108.3	-0.0800000000000011
4	17	257	50	2.021	108.8	0.1
%4	19	259	150	2.02	110	0.600000000000001
%4	24	264	150	2.021	115.7	1.14
%4	29	269	150	2.02	117	0.259999999999999
%4	34	274	150	2.02	115.5	-0.3
%4	39	279	150	2.02	116.3	0.159999999999999
%4	44	284	150	2.019	117.3	0.2
%4	49	289	150	2.019	116.8	-0.1
%4	54	294	150	2.019	118.5	0.340000000000001
%4	59	299	150	2.019	118	-0.1
5	4	304	150	2.019	118.1	0.0199999999999989
5	14	314	150	2.018	118.4	0.0300000000000011
%5	15	315	400	2.02	121.6	3.19999999999999
%5	20	320	400	2.019	125.8	0.840000000000001
%5	25	325	400	2.019	127.5	0.340000000000001
%5	30	330	400	2.019	126.4	-0.219999999999999
%5	35	335	400	2.019	127.8	0.279999999999998
5	40	340	400	2.019	127.6	-0.0400000000000006
5	45	345	400	2.019	127.4	-0.0399999999999977
%5	46	346	900	2.022	129.9	2.5
%5	51	351	900	2.022	135.3	1.08
%5	56	356	900	2.022	135.9	0.119999999999999
%6	1	361	900	2.022	136.8	0.180000000000001
%6	6	366	900	2.023	137.1	0.0599999999999966
6	11	371	900	2.022	137.4	0.0600000000000023
6	16	376	900	2.023	137.3	-0.0199999999999989
%6	17	377	1900	2.029	142	4.69999999999999
%6	22	382	1900	2.029	144.5	0.5
%6	27	387	1900	2.029	144.8	0.0600000000000023
%6	32	392	1900	2.028	145.2	0.0799999999999955
%6	37	397	1900	2.028	146.3	0.220000000000005
%6	42	402	1900	2.028	146.7	0.0799999999999955
%6	47	407	1900	2.028	147.4	0.140000000000003
6	52	412	1900	2.028	147.2	-0.0400000000000034
6	58	418	1900	2.028	145.9	-0.216666666666664
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	10	-29.6	
%0	5	5	0	9.928	-26.9	0.540000000000001
%0	15	15	0	9.866	-23.2	0.37
%0	20	20	0	9.855	-23.3	-0.0200000000000003
%0	25	25	0	9.804	-19.7	0.72
%0	30	30	0	9.791	-20.4	-0.14
%0	35	35	0	9.782	-19.8	0.12
%0	40	40	0	9.755	-19.3	0.1
%50	45	45	0	9.741	-17.4	0.38
%0	55	55	0	9.746	-17.4	0
%1	0	60	0	9.729	-17.7	-0.0600000000000001
1	5	65	0	9.697	-17	0.14
1	10	70	0	9.709	-17.3	-0.0600000000000001
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus),Emeas,1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

%plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-13 -3 40 150])

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -12.0185 50 0.253456 15.7464

list
string: Total Cu
 -6.91521 60 0.230415 11.5688

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%1	17	77	0	2.009	78.1	13.6285714285714
%1	23	83	0	2.000	73.8	-0.716666666666666
%1	28	88	0	1.999	76	0.440000000000001
%1	33	93	0	1.999	77.8	0.359999999999999
%1	38	98	0	1.995	79.4	0.320000000000002
%1	43	103	0	1.996	81.8	0.479999999999998
%1	48	108	0	1.995	84	0.440000000000001
%1	53	113	0	2.005	86	0.4
%1	58	118	0	2.006	87.7	0.340000000000001
%2	3	123	0	2.008	89.8	0.419999999999999
%2	8	128	0	2.009	90.4	0.120000000000002
%2	13	133	0	2.006	91	0.119999999999999
%2	18	138	0	2.006	91.7	0.140000000000001
%2	23	143	0	2.005	92.3	0.119999999999999
%2	28	148	0	2.004	92.4	0.0200000000000017
%2	33	153	0	2.007	93.4	0.2
%2	38	158	0	2.003	93.9	0.1
%2	43	163	0	2.002	95	0.219999999999999
%2	48	168	0	2.001	95.4	0.0800000000000011
2	53	173	0	2.002	95.6	0.0399999999999977
2	58	178	0	2.001	95.6	0
%3	0	180	50	2.001	97.9	1.15000000000001
%3	5	185	50	2	102.8	0.979999999999998
%3	10	190	50	2	103.8	0.2
%3	22	202	50	1.998	105.2	0.116666666666667
%3	32	212	50	1.997	106.2	0.1
%3	37	217	50	1.996	107	0.159999999999999
%3	42	222	50	1.995	106.6	-0.0800000000000011
%3	47	227	50	1.995	107.2	0.120000000000002
%3	52	232	50	1.995	107.6	0.0799999999999983
%3	57	237	50	1.996	107.3	-0.0599999999999994
%4	2	242	50	2.021	108.5	0.240000000000001
%4	7	247	50	2.021	108.7	0.0400000000000006
4	12	252	50	2.021	108.3	-0.0800000000000011
4	17	257	50	2.021	108.8	0.1
%4	19	259	150	2.02	110	0.600000000000001
%4	24	264	150	2.021	115.7	1.14
%4	29	269	150	2.02	117	0.259999999999999
%4	34	274	150	2.02	115.5	-0.3
%4	39	279	150	2.02	116.3	0.159999999999999
%4	44	284	150	2.019	117.3	0.2
%4	49	289	150	2.019	116.8	-0.1
%4	54	294	150	2.019	118.5	0.340000000000001
%4	59	299	150	2.019	118	-0.1
5	4	304	150	2.019	118.1	0.0199999999999989
5	14	314	150	2.018	118.4	0.0300000000000011
%5	15	315	400	2.02	121.6	3.19999999999999
%5	20	320	400	2.019	125.8	0.840000000000001
%5	25	325	400	2.019	127.5	0.340000000000001
%5	30	330	400	2.019	126.4	-0.219999999999999
%5	35	335	400	2.019	127.8	0.279999999999998
5	40	340	400	2.019	127.6	-0.0400000000000006
5	45	345	400	2.019	127.4	-0.0399999999999977
%5	46	346	900	2.022	129.9	2.5
%5	51	351	900	2.022	135.3	1.08
%5	56	356	900	2.022	135.9	0.119999999999999
%6	1	361	900	2.022	136.8	0.180000000000001
%6	6	366	900	2.023	137.1	0.0599999999999966
6	11	371	900	2.022	137.4	0.0600000000000023
6	16	376	900	2.023	137.3	-0.0199999999999989
%6	17	377	1900	2.029	142	4.69999999999999
%6	22	382	1900	2.029	144.5	0.5
%6	27	387	1900	2.029	144.8	0.0600000000000023
%6	32	392	1900	2.028	145.2	0.0799999999999955
%6	37	397	1900	2.028	146.3	0.220000000000005
%6	42	402	1900	2.028	146.7	0.0799999999999955
%6	47	407	1900	2.028	147.4	0.140000000000003
6	52	412	1900	2.028	147.2	-0.0400000000000034
6	58	418	1900	2.028	145.9	-0.216666666666664
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	10	-29.6	
%0	5	5	0	9.928	-26.9	0.540000000000001
%0	15	15	0	9.866	-23.2	0.37
%0	20	20	0	9.855	-23.3	-0.0200000000000003
%0	25	25	0	9.804	-19.7	0.72
%0	30	30	0	9.791	-20.4	-0.14
%0	35	35	0	9.782	-19.8	0.12
%0	40	40	0	9.755	-19.3	0.1
%50	45	45	0	9.741	-17.4	0.38
%0	55	55	0	9.746	-17.4	0
%1	0	60	0	9.729	-17.7	-0.0600000000000001
1	5	65	0	9.697	-17	0.14
1	10	70	0	9.709	-17.3	-0.0600000000000001
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus),Emeas,1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.7030; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

%plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-13 -3 40 150])

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -12.8513 50 0.253456 15.7464

list
string: Total Cu
 -6.91521 60 0.230415 11.5688

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.7030; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

%plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-16 -3 40 150])

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -12.8893 50 0.329493 15.7464

list
string: Total Cu
 -6.94977 60 0.299539 11.5688

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.7030; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

%plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-16 -3 -40 150])

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -12.8893 50 0.329493 27.1984

list
string: Total Cu
 -6.94977 60 0.299539 19.9825

[I 20:41:27.127 NotebookApp] Saving file at /KNO3_pH10_0pt1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%1	17	77	0	2.009	78.1	13.6285714285714
%1	23	83	0	2.000	73.8	-0.716666666666666
%1	28	88	0	1.999	76	0.440000000000001
%1	33	93	0	1.999	77.8	0.359999999999999
%1	38	98	0	1.995	79.4	0.320000000000002
%1	43	103	0	1.996	81.8	0.479999999999998
%1	48	108	0	1.995	84	0.440000000000001
%1	53	113	0	2.005	86	0.4
%1	58	118	0	2.006	87.7	0.340000000000001
%2	3	123	0	2.008	89.8	0.419999999999999
%2	8	128	0	2.009	90.4	0.120000000000002
%2	13	133	0	2.006	91	0.119999999999999
%2	18	138	0	2.006	91.7	0.140000000000001
%2	23	143	0	2.005	92.3	0.119999999999999
%2	28	148	0	2.004	92.4	0.0200000000000017
%2	33	153	0	2.007	93.4	0.2
%2	38	158	0	2.003	93.9	0.1
%2	43	163	0	2.002	95	0.219999999999999
%2	48	168	0	2.001	95.4	0.0800000000000011
%2	53	173	0	2.002	95.6	0.0399999999999977
%2	58	178	0	2.001	95.6	0
%3	0	180	50	2.001	97.9	1.15000000000001
%3	5	185	50	2	102.8	0.979999999999998
%3	10	190	50	2	103.8	0.2
%3	22	202	50	1.998	105.2	0.116666666666667
%3	32	212	50	1.997	106.2	0.1
%3	37	217	50	1.996	107	0.159999999999999
%3	42	222	50	1.995	106.6	-0.0800000000000011
%3	47	227	50	1.995	107.2	0.120000000000002
%3	52	232	50	1.995	107.6	0.0799999999999983
%3	57	237	50	1.996	107.3	-0.0599999999999994
%4	2	242	50	2.021	108.5	0.240000000000001
%4	7	247	50	2.021	108.7	0.0400000000000006
4	12	252	50	2.021	108.3	-0.0800000000000011
4	17	257	50	2.021	108.8	0.1
%4	19	259	150	2.02	110	0.600000000000001
%4	24	264	150	2.021	115.7	1.14
%4	29	269	150	2.02	117	0.259999999999999
%4	34	274	150	2.02	115.5	-0.3
%4	39	279	150	2.02	116.3	0.159999999999999
%4	44	284	150	2.019	117.3	0.2
%4	49	289	150	2.019	116.8	-0.1
%4	54	294	150	2.019	118.5	0.340000000000001
%4	59	299	150	2.019	118	-0.1
5	4	304	150	2.019	118.1	0.0199999999999989
5	14	314	150	2.018	118.4	0.0300000000000011
%5	15	315	400	2.02	121.6	3.19999999999999
%5	20	320	400	2.019	125.8	0.840000000000001
%5	25	325	400	2.019	127.5	0.340000000000001
%5	30	330	400	2.019	126.4	-0.219999999999999
%5	35	335	400	2.019	127.8	0.279999999999998
5	40	340	400	2.019	127.6	-0.0400000000000006
5	45	345	400	2.019	127.4	-0.0399999999999977
%5	46	346	900	2.022	129.9	2.5
%5	51	351	900	2.022	135.3	1.08
%5	56	356	900	2.022	135.9	0.119999999999999
%6	1	361	900	2.022	136.8	0.180000000000001
%6	6	366	900	2.023	137.1	0.0599999999999966
6	11	371	900	2.022	137.4	0.0600000000000023
6	16	376	900	2.023	137.3	-0.0199999999999989
%6	17	377	1900	2.029	142	4.69999999999999
%6	22	382	1900	2.029	144.5	0.5
%6	27	387	1900	2.029	144.8	0.0600000000000023
%6	32	392	1900	2.028	145.2	0.0799999999999955
%6	37	397	1900	2.028	146.3	0.220000000000005
%6	42	402	1900	2.028	146.7	0.0799999999999955
%6	47	407	1900	2.028	147.4	0.140000000000003
6	52	412	1900	2.028	147.2	-0.0400000000000034
6	58	418	1900	2.028	145.9	-0.216666666666664
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	10	-29.6	
%0	5	5	0	9.928	-26.9	0.540000000000001
%0	15	15	0	9.866	-23.2	0.37
%0	20	20	0	9.855	-23.3	-0.0200000000000003
%0	25	25	0	9.804	-19.7	0.72
%0	30	30	0	9.791	-20.4	-0.14
%0	35	35	0	9.782	-19.8	0.12
%0	40	40	0	9.755	-19.3	0.1
%50	45	45	0	9.741	-17.4	0.38
%0	55	55	0	9.746	-17.4	0
%1	0	60	0	9.729	-17.7	-0.0600000000000001
1	5	65	0	9.697	-17	0.14
1	10	70	0	9.709	-17.3	-0.0600000000000001
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus),Emeas,1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.7030; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

%plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-16 -3 -40 150])

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -12.8893 50 0.329493 27.1984

list
string: Total Cu
 -6.94977 60 0.299539 19.9825

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%1	17	77	0	2.009	78.1	13.6285714285714
%1	23	83	0	2.000	73.8	-0.716666666666666
%1	28	88	0	1.999	76	0.440000000000001
%1	33	93	0	1.999	77.8	0.359999999999999
%1	38	98	0	1.995	79.4	0.320000000000002
%1	43	103	0	1.996	81.8	0.479999999999998
%1	48	108	0	1.995	84	0.440000000000001
%1	53	113	0	2.005	86	0.4
%1	58	118	0	2.006	87.7	0.340000000000001
%2	3	123	0	2.008	89.8	0.419999999999999
%2	8	128	0	2.009	90.4	0.120000000000002
%2	13	133	0	2.006	91	0.119999999999999
%2	18	138	0	2.006	91.7	0.140000000000001
%2	23	143	0	2.005	92.3	0.119999999999999
%2	28	148	0	2.004	92.4	0.0200000000000017
%2	33	153	0	2.007	93.4	0.2
%2	38	158	0	2.003	93.9	0.1
%2	43	163	0	2.002	95	0.219999999999999
%2	48	168	0	2.001	95.4	0.0800000000000011
2	53	173	0	2.002	95.6	0.0399999999999977
2	58	178	0	2.001	95.6	0
%3	0	180	50	2.001	97.9	1.15000000000001
%3	5	185	50	2	102.8	0.979999999999998
%3	10	190	50	2	103.8	0.2
%3	22	202	50	1.998	105.2	0.116666666666667
%3	32	212	50	1.997	106.2	0.1
%3	37	217	50	1.996	107	0.159999999999999
%3	42	222	50	1.995	106.6	-0.0800000000000011
%3	47	227	50	1.995	107.2	0.120000000000002
%3	52	232	50	1.995	107.6	0.0799999999999983
%3	57	237	50	1.996	107.3	-0.0599999999999994
%4	2	242	50	2.021	108.5	0.240000000000001
%4	7	247	50	2.021	108.7	0.0400000000000006
4	12	252	50	2.021	108.3	-0.0800000000000011
4	17	257	50	2.021	108.8	0.1
%4	19	259	150	2.02	110	0.600000000000001
%4	24	264	150	2.021	115.7	1.14
%4	29	269	150	2.02	117	0.259999999999999
%4	34	274	150	2.02	115.5	-0.3
%4	39	279	150	2.02	116.3	0.159999999999999
%4	44	284	150	2.019	117.3	0.2
%4	49	289	150	2.019	116.8	-0.1
%4	54	294	150	2.019	118.5	0.340000000000001
%4	59	299	150	2.019	118	-0.1
5	4	304	150	2.019	118.1	0.0199999999999989
5	14	314	150	2.018	118.4	0.0300000000000011
%5	15	315	400	2.02	121.6	3.19999999999999
%5	20	320	400	2.019	125.8	0.840000000000001
%5	25	325	400	2.019	127.5	0.340000000000001
%5	30	330	400	2.019	126.4	-0.219999999999999
%5	35	335	400	2.019	127.8	0.279999999999998
5	40	340	400	2.019	127.6	-0.0400000000000006
5	45	345	400	2.019	127.4	-0.0399999999999977
%5	46	346	900	2.022	129.9	2.5
%5	51	351	900	2.022	135.3	1.08
%5	56	356	900	2.022	135.9	0.119999999999999
%6	1	361	900	2.022	136.8	0.180000000000001
%6	6	366	900	2.023	137.1	0.0599999999999966
6	11	371	900	2.022	137.4	0.0600000000000023
6	16	376	900	2.023	137.3	-0.0199999999999989
%6	17	377	1900	2.029	142	4.69999999999999
%6	22	382	1900	2.029	144.5	0.5
%6	27	387	1900	2.029	144.8	0.0600000000000023
%6	32	392	1900	2.028	145.2	0.0799999999999955
%6	37	397	1900	2.028	146.3	0.220000000000005
%6	42	402	1900	2.028	146.7	0.0799999999999955
%6	47	407	1900	2.028	147.4	0.140000000000003
6	52	412	1900	2.028	147.2	-0.0400000000000034
6	58	418	1900	2.028	145.9	-0.216666666666664
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	10	-29.6	
%0	5	5	0	9.928	-26.9	0.540000000000001
%0	15	15	0	9.866	-23.2	0.37
%0	20	20	0	9.855	-23.3	-0.0200000000000003
%0	25	25	0	9.804	-19.7	0.72
%0	30	30	0	9.791	-20.4	-0.14
%0	35	35	0	9.782	-19.8	0.12
%0	40	40	0	9.755	-19.3	0.1
%50	45	45	0	9.741	-17.4	0.38
%0	55	55	0	9.746	-17.4	0
%1	0	60	0	9.729	-17.7	-0.0600000000000001
1	5	65	0	9.697	-17	0.14
1	10	70	0	9.709	-17.3	-0.0600000000000001
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus),Emeas,1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.7030; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

%plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-16 -3 -40 150])

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -12.8893 50 0.329493 27.1984

list
string: Total Cu
 -6.94977 60 0.299539 19.9825

[I 20:43:18.546 NotebookApp] Saving file at /KNO3_pH9pt5_1uMCuT.ipynb
Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=79.3; Eorig=-26.4; %m=21.5;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
[I 20:43:27.170 NotebookApp] Saving file at /KNO3_pH10_0pt1uMCuT.ipynb
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

%plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -11.0185 50 0.253456 35.7873

list
string: Total Cu
 -5.91521 40 0.230415 26.2927

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'r--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -11.0185 50 0.253456 35.7873

list
string: Total Cu
 -5.91521 40 0.230415 26.2927

[I 20:45:18.592 NotebookApp] Saving file at /KNO3_pH9pt5_1uMCuT.ipynb
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'r--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuwithCuOs) log10(CuwithCuOs)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -11.0185 50 0.253456 35.7873

list
string: Total Cu
 -5.91521 40 0.230415 26.2927

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'r--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuwithCuOs) log10(CuwithCuOs)],[-100 150],'g--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -11.0185 50 0.253456 35.7873

list
string: Total Cu
 -5.91521 40 0.230415 26.2927

[I 20:47:18.635 NotebookApp] Saving file at /KNO3_pH9pt5_1uMCuT.ipynb
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-13 -3 40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.12544 50 0.253456 15.7464

list
string: Total Cu
 -6.91521 60 0.230415 11.5688

[I 20:48:09.003 NotebookApp] Saving file at /KNO3_pH8_0pt1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
4	35	275	0	2.001	115.1	0.2
4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(2:end)),Emeas(2:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=115; Eorig=52; %m=21.5;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-13 -3 40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.12544 50 0.253456 15.7464

list
string: Total Cu
 -6.91521 60 0.230415 11.5688

Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
4	35	275	0	2.001	115.1	0.2
4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=115; Eorig=52; %m=21.5;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-13 -3 40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.12544 50 0.253456 15.7464

list
string: Total Cu
 -6.91521 60 0.230415 11.5688

[I 20:50:09.043 NotebookApp] Saving file at /KNO3_pH8_0pt1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	"cumulative vol added"	pH	mvA	delta
% 1	30	90	0	2.029	73.3	9.97
% 1	35	95	0	2.023	73.4	0.02
% 1	40	100	0	2.022	76.8	0.68
% 1	45	105	0	2.002	77.8	0.2
% 1	55	115	0	2.004	74.9	-0.29
% 2	5	125	0	2.002	74.5	-0.04
%2	10	130	0	2.002	74.6	0.02
2	15	135	0	2.002	74.8	0.04
2	17	137	0	2.002	79.3	2.25
% 2	22	142	50	2.002	90	2.14
% 2	27	147	50	2.001	93.5	0.7
% 2	32	152	50	2.002	96.3	0.56
% 2	37	157	50	2.001	95.8	-0.1
%2	42	162	50	2.002	91.4	-0.88
%2	47	167	50	2	91	-0.08
%2	52	172	50	2.001	90.6	-0.08
% 2	57	177	150	2.000	90.6	0
% 2	58	178	150	2.001	94.4	3.8
% 3	3	183	150	2.002	100	1.12
% 3	8	188	150	2	101.3	0.26
% 3	13	193	150	2.001	107.5	1.24
% 3	18	198	150	2	108.7	0.24
% 3	23	203	150	2.002	108.6	-0.02
%3	28	208	150	2.001	109	0.08
%3	33	213	150	2	108.8	-0.04
3	38	218	150	2.001	108.4	-0.08
% 3	43	223	400	1.999	108.4	0
% 3	44	224	400	2.001	114.1	5.7
% 3	49	229	400	2.003	118.4	0.86
% 3	54	234	400	2.001	118.2	-0.04
%3	59	239	400	2.002	118	-0.04
4	4	244	400	2.002	118.4	0.08
% 4	5	245	900	2.005	122.1	3.7
% 4	10	250	900	2.005	126.6	0.9
% 4	15	255	900	2.005	128	0.28
%4	20	260	900	2.005	128.5	0.1
%4	25	265	900	2.006	128.2	-0.06
4	30	270	900	2.004	127.8	-0.08
% 4	31	271	1900	2.011	133	5.2
% 4	36	276	1900	2.012	136.5	0.7
% 4	41	281	1900	2.011	137.2	0.14
% 4	46	286	1900	2.011	137.4	0.04
%4	51	291	1900	2.01	136.8	-0.12
4	56	296	1900	2.011	137.2	0.08
% 5	1	301	3400	2.011	136.8	-0.08
% 5	3	303	3400	2.02	142.5	2.85
% 5	8	308	3400	2.022	143.2	0.14
% 5	13	313	3400	2.021	143.4	0.04
% 5	18	318	3400	2.022	143.1	-0.06
% 5	23	323	3400	2.021	142	-0.22
% 5	28	328	3400	2.021	142.4	0.08
% 5	33	333	3400	2.021	142	-0.08
%5	38	338	3400	2.019	141.1	-0.18
5	43	343	3400	2.019	142.2	0.22
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative vol added	pH	mvA	delta	mVB	deltaB	comments
% 0	0	0	0	9.625	60.9	
% 0	5	5	0	9.657	47.3	-2.72
% 0	15	15	0	9.574	-34.7	-8.2
% 0	20	20	0	9.643	-33	0.34
% 0	25	25	0	9.256	-19	2.8
% 0	30	30	0	9.54	-29.6	-2.12
% 0	35	35	0	9.537	-28.8	0.16
% 0	40	40	0	9.54	-28.4	0.08
% 0	45	45	0	9.532	-27	0.28
% 0	50	50	0	9.527	-27.6	-0.12
% 0	55	55	0	9.517	-27.7	-0.02
% 1	0	60	0	9.512	-27.7	0
% 1	5	65	0	9.502	-26.2	0.3
%1	10	70	0	9.501	-26.3	-0.02
%1	15	75	0	9.486	-26.5	-0.04
1	20	80	0	9.482	-26.4	0.02
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-6;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus),Emeas,1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=79.3; Eorig=-26.4; %m=21.5;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	"cumulative vol added"	pH	mvA	delta
% 1	30	90	0	2.029	73.3	9.97
% 1	35	95	0	2.023	73.4	0.02
% 1	40	100	0	2.022	76.8	0.68
% 1	45	105	0	2.002	77.8	0.2
% 1	55	115	0	2.004	74.9	-0.29
% 2	5	125	0	2.002	74.5	-0.04
%2	10	130	0	2.002	74.6	0.02
2	15	135	0	2.002	74.8	0.04
2	17	137	0	2.002	79.3	2.25
% 2	22	142	50	2.002	90	2.14
% 2	27	147	50	2.001	93.5	0.7
% 2	32	152	50	2.002	96.3	0.56
% 2	37	157	50	2.001	95.8	-0.1
%2	42	162	50	2.002	91.4	-0.88
%2	47	167	50	2	91	-0.08
%2	52	172	50	2.001	90.6	-0.08
% 2	57	177	150	2.000	90.6	0
% 2	58	178	150	2.001	94.4	3.8
% 3	3	183	150	2.002	100	1.12
% 3	8	188	150	2	101.3	0.26
% 3	13	193	150	2.001	107.5	1.24
% 3	18	198	150	2	108.7	0.24
% 3	23	203	150	2.002	108.6	-0.02
%3	28	208	150	2.001	109	0.08
%3	33	213	150	2	108.8	-0.04
3	38	218	150	2.001	108.4	-0.08
% 3	43	223	400	1.999	108.4	0
% 3	44	224	400	2.001	114.1	5.7
% 3	49	229	400	2.003	118.4	0.86
% 3	54	234	400	2.001	118.2	-0.04
%3	59	239	400	2.002	118	-0.04
4	4	244	400	2.002	118.4	0.08
% 4	5	245	900	2.005	122.1	3.7
% 4	10	250	900	2.005	126.6	0.9
% 4	15	255	900	2.005	128	0.28
%4	20	260	900	2.005	128.5	0.1
%4	25	265	900	2.006	128.2	-0.06
4	30	270	900	2.004	127.8	-0.08
% 4	31	271	1900	2.011	133	5.2
% 4	36	276	1900	2.012	136.5	0.7
% 4	41	281	1900	2.011	137.2	0.14
% 4	46	286	1900	2.011	137.4	0.04
%4	51	291	1900	2.01	136.8	-0.12
4	56	296	1900	2.011	137.2	0.08
% 5	1	301	3400	2.011	136.8	-0.08
% 5	3	303	3400	2.02	142.5	2.85
% 5	8	308	3400	2.022	143.2	0.14
% 5	13	313	3400	2.021	143.4	0.04
% 5	18	318	3400	2.022	143.1	-0.06
% 5	23	323	3400	2.021	142	-0.22
% 5	28	328	3400	2.021	142.4	0.08
% 5	33	333	3400	2.021	142	-0.08
%5	38	338	3400	2.019	141.1	-0.18
5	43	343	3400	2.019	142.2	0.22
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative vol added	pH	mvA	delta	mVB	deltaB	comments
% 0	0	0	0	9.625	60.9	
% 0	5	5	0	9.657	47.3	-2.72
% 0	15	15	0	9.574	-34.7	-8.2
% 0	20	20	0	9.643	-33	0.34
% 0	25	25	0	9.256	-19	2.8
% 0	30	30	0	9.54	-29.6	-2.12
% 0	35	35	0	9.537	-28.8	0.16
% 0	40	40	0	9.54	-28.4	0.08
% 0	45	45	0	9.532	-27	0.28
% 0	50	50	0	9.527	-27.6	-0.12
% 0	55	55	0	9.517	-27.7	-0.02
% 1	0	60	0	9.512	-27.7	0
% 1	5	65	0	9.502	-26.2	0.3
%1	10	70	0	9.501	-26.3	-0.02
%1	15	75	0	9.486	-26.5	-0.04
1	20	80	0	9.482	-26.4	0.02
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-6; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus),Emeas,1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=79.3; Eorig=-26.4; %m=21.5;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'r--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuwithCuOs) log10(CuwithCuOs)],[-100 150],'g--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -11.0185 50 0.253456 35.7873

list
string: Total Cu
 -5.91521 40 0.230415 26.2927

[I 20:51:18.692 NotebookApp] Saving file at /KNO3_pH9pt5_1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%1	17	77	0	2.009	78.1	13.6285714285714
%1	23	83	0	2.000	73.8	-0.716666666666666
%1	28	88	0	1.999	76	0.440000000000001
%1	33	93	0	1.999	77.8	0.359999999999999
%1	38	98	0	1.995	79.4	0.320000000000002
%1	43	103	0	1.996	81.8	0.479999999999998
%1	48	108	0	1.995	84	0.440000000000001
%1	53	113	0	2.005	86	0.4
%1	58	118	0	2.006	87.7	0.340000000000001
%2	3	123	0	2.008	89.8	0.419999999999999
%2	8	128	0	2.009	90.4	0.120000000000002
%2	13	133	0	2.006	91	0.119999999999999
%2	18	138	0	2.006	91.7	0.140000000000001
%2	23	143	0	2.005	92.3	0.119999999999999
%2	28	148	0	2.004	92.4	0.0200000000000017
%2	33	153	0	2.007	93.4	0.2
%2	38	158	0	2.003	93.9	0.1
%2	43	163	0	2.002	95	0.219999999999999
%2	48	168	0	2.001	95.4	0.0800000000000011
2	53	173	0	2.002	95.6	0.0399999999999977
2	58	178	0	2.001	95.6	0
%3	0	180	50	2.001	97.9	1.15000000000001
%3	5	185	50	2	102.8	0.979999999999998
%3	10	190	50	2	103.8	0.2
%3	22	202	50	1.998	105.2	0.116666666666667
%3	32	212	50	1.997	106.2	0.1
%3	37	217	50	1.996	107	0.159999999999999
%3	42	222	50	1.995	106.6	-0.0800000000000011
%3	47	227	50	1.995	107.2	0.120000000000002
%3	52	232	50	1.995	107.6	0.0799999999999983
%3	57	237	50	1.996	107.3	-0.0599999999999994
%4	2	242	50	2.021	108.5	0.240000000000001
%4	7	247	50	2.021	108.7	0.0400000000000006
4	12	252	50	2.021	108.3	-0.0800000000000011
4	17	257	50	2.021	108.8	0.1
%4	19	259	150	2.02	110	0.600000000000001
%4	24	264	150	2.021	115.7	1.14
%4	29	269	150	2.02	117	0.259999999999999
%4	34	274	150	2.02	115.5	-0.3
%4	39	279	150	2.02	116.3	0.159999999999999
%4	44	284	150	2.019	117.3	0.2
%4	49	289	150	2.019	116.8	-0.1
%4	54	294	150	2.019	118.5	0.340000000000001
%4	59	299	150	2.019	118	-0.1
5	4	304	150	2.019	118.1	0.0199999999999989
5	14	314	150	2.018	118.4	0.0300000000000011
%5	15	315	400	2.02	121.6	3.19999999999999
%5	20	320	400	2.019	125.8	0.840000000000001
%5	25	325	400	2.019	127.5	0.340000000000001
%5	30	330	400	2.019	126.4	-0.219999999999999
%5	35	335	400	2.019	127.8	0.279999999999998
5	40	340	400	2.019	127.6	-0.0400000000000006
5	45	345	400	2.019	127.4	-0.0399999999999977
%5	46	346	900	2.022	129.9	2.5
%5	51	351	900	2.022	135.3	1.08
%5	56	356	900	2.022	135.9	0.119999999999999
%6	1	361	900	2.022	136.8	0.180000000000001
%6	6	366	900	2.023	137.1	0.0599999999999966
6	11	371	900	2.022	137.4	0.0600000000000023
6	16	376	900	2.023	137.3	-0.0199999999999989
%6	17	377	1900	2.029	142	4.69999999999999
%6	22	382	1900	2.029	144.5	0.5
%6	27	387	1900	2.029	144.8	0.0600000000000023
%6	32	392	1900	2.028	145.2	0.0799999999999955
%6	37	397	1900	2.028	146.3	0.220000000000005
%6	42	402	1900	2.028	146.7	0.0799999999999955
%6	47	407	1900	2.028	147.4	0.140000000000003
6	52	412	1900	2.028	147.2	-0.0400000000000034
6	58	418	1900	2.028	145.9	-0.216666666666664
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	10	-29.6	
%0	5	5	0	9.928	-26.9	0.540000000000001
%0	15	15	0	9.866	-23.2	0.37
%0	20	20	0	9.855	-23.3	-0.0200000000000003
%0	25	25	0	9.804	-19.7	0.72
%0	30	30	0	9.791	-20.4	-0.14
%0	35	35	0	9.782	-19.8	0.12
%0	40	40	0	9.755	-19.3	0.1
%50	45	45	0	9.741	-17.4	0.38
%0	55	55	0	9.746	-17.4	0
%1	0	60	0	9.729	-17.7	-0.0600000000000001
1	5	65	0	9.697	-17	0.14
1	10	70	0	9.709	-17.3	-0.0600000000000001
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(2:end)),Emeas(2:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.7030; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

%plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-16 -3 -40 150])

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -12.8893 50 0.329493 27.1984

list
string: Total Cu
 -6.94977 60 0.299539 19.9825

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%1	17	77	0	2.009	78.1	13.6285714285714
%1	23	83	0	2.000	73.8	-0.716666666666666
%1	28	88	0	1.999	76	0.440000000000001
%1	33	93	0	1.999	77.8	0.359999999999999
%1	38	98	0	1.995	79.4	0.320000000000002
%1	43	103	0	1.996	81.8	0.479999999999998
%1	48	108	0	1.995	84	0.440000000000001
%1	53	113	0	2.005	86	0.4
%1	58	118	0	2.006	87.7	0.340000000000001
%2	3	123	0	2.008	89.8	0.419999999999999
%2	8	128	0	2.009	90.4	0.120000000000002
%2	13	133	0	2.006	91	0.119999999999999
%2	18	138	0	2.006	91.7	0.140000000000001
%2	23	143	0	2.005	92.3	0.119999999999999
%2	28	148	0	2.004	92.4	0.0200000000000017
%2	33	153	0	2.007	93.4	0.2
%2	38	158	0	2.003	93.9	0.1
%2	43	163	0	2.002	95	0.219999999999999
%2	48	168	0	2.001	95.4	0.0800000000000011
2	53	173	0	2.002	95.6	0.0399999999999977
2	58	178	0	2.001	95.6	0
%3	0	180	50	2.001	97.9	1.15000000000001
%3	5	185	50	2	102.8	0.979999999999998
%3	10	190	50	2	103.8	0.2
%3	22	202	50	1.998	105.2	0.116666666666667
%3	32	212	50	1.997	106.2	0.1
%3	37	217	50	1.996	107	0.159999999999999
%3	42	222	50	1.995	106.6	-0.0800000000000011
%3	47	227	50	1.995	107.2	0.120000000000002
%3	52	232	50	1.995	107.6	0.0799999999999983
%3	57	237	50	1.996	107.3	-0.0599999999999994
%4	2	242	50	2.021	108.5	0.240000000000001
%4	7	247	50	2.021	108.7	0.0400000000000006
4	12	252	50	2.021	108.3	-0.0800000000000011
4	17	257	50	2.021	108.8	0.1
%4	19	259	150	2.02	110	0.600000000000001
%4	24	264	150	2.021	115.7	1.14
%4	29	269	150	2.02	117	0.259999999999999
%4	34	274	150	2.02	115.5	-0.3
%4	39	279	150	2.02	116.3	0.159999999999999
%4	44	284	150	2.019	117.3	0.2
%4	49	289	150	2.019	116.8	-0.1
%4	54	294	150	2.019	118.5	0.340000000000001
%4	59	299	150	2.019	118	-0.1
5	4	304	150	2.019	118.1	0.0199999999999989
5	14	314	150	2.018	118.4	0.0300000000000011
%5	15	315	400	2.02	121.6	3.19999999999999
%5	20	320	400	2.019	125.8	0.840000000000001
%5	25	325	400	2.019	127.5	0.340000000000001
%5	30	330	400	2.019	126.4	-0.219999999999999
%5	35	335	400	2.019	127.8	0.279999999999998
5	40	340	400	2.019	127.6	-0.0400000000000006
5	45	345	400	2.019	127.4	-0.0399999999999977
%5	46	346	900	2.022	129.9	2.5
%5	51	351	900	2.022	135.3	1.08
%5	56	356	900	2.022	135.9	0.119999999999999
%6	1	361	900	2.022	136.8	0.180000000000001
%6	6	366	900	2.023	137.1	0.0599999999999966
6	11	371	900	2.022	137.4	0.0600000000000023
6	16	376	900	2.023	137.3	-0.0199999999999989
%6	17	377	1900	2.029	142	4.69999999999999
%6	22	382	1900	2.029	144.5	0.5
%6	27	387	1900	2.029	144.8	0.0600000000000023
%6	32	392	1900	2.028	145.2	0.0799999999999955
%6	37	397	1900	2.028	146.3	0.220000000000005
%6	42	402	1900	2.028	146.7	0.0799999999999955
%6	47	407	1900	2.028	147.4	0.140000000000003
6	52	412	1900	2.028	147.2	-0.0400000000000034
6	58	418	1900	2.028	145.9	-0.216666666666664
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	10	-29.6	
%0	5	5	0	9.928	-26.9	0.540000000000001
%0	15	15	0	9.866	-23.2	0.37
%0	20	20	0	9.855	-23.3	-0.0200000000000003
%0	25	25	0	9.804	-19.7	0.72
%0	30	30	0	9.791	-20.4	-0.14
%0	35	35	0	9.782	-19.8	0.12
%0	40	40	0	9.755	-19.3	0.1
%50	45	45	0	9.741	-17.4	0.38
%0	55	55	0	9.746	-17.4	0
%1	0	60	0	9.729	-17.7	-0.0600000000000001
1	5	65	0	9.697	-17	0.14
1	10	70	0	9.709	-17.3	-0.0600000000000001
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.7030; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

%plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-16 -3 -40 150])

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -12.8893 50 0.329493 27.1984

list
string: Total Cu
 -6.94977 60 0.299539 19.9825

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%1	17	77	0	2.009	78.1	13.6285714285714
%1	23	83	0	2.000	73.8	-0.716666666666666
%1	28	88	0	1.999	76	0.440000000000001
%1	33	93	0	1.999	77.8	0.359999999999999
%1	38	98	0	1.995	79.4	0.320000000000002
%1	43	103	0	1.996	81.8	0.479999999999998
%1	48	108	0	1.995	84	0.440000000000001
%1	53	113	0	2.005	86	0.4
%1	58	118	0	2.006	87.7	0.340000000000001
%2	3	123	0	2.008	89.8	0.419999999999999
%2	8	128	0	2.009	90.4	0.120000000000002
%2	13	133	0	2.006	91	0.119999999999999
%2	18	138	0	2.006	91.7	0.140000000000001
%2	23	143	0	2.005	92.3	0.119999999999999
%2	28	148	0	2.004	92.4	0.0200000000000017
%2	33	153	0	2.007	93.4	0.2
%2	38	158	0	2.003	93.9	0.1
%2	43	163	0	2.002	95	0.219999999999999
%2	48	168	0	2.001	95.4	0.0800000000000011
2	53	173	0	2.002	95.6	0.0399999999999977
2	58	178	0	2.001	95.6	0
%3	0	180	50	2.001	97.9	1.15000000000001
%3	5	185	50	2	102.8	0.979999999999998
%3	10	190	50	2	103.8	0.2
%3	22	202	50	1.998	105.2	0.116666666666667
%3	32	212	50	1.997	106.2	0.1
%3	37	217	50	1.996	107	0.159999999999999
%3	42	222	50	1.995	106.6	-0.0800000000000011
%3	47	227	50	1.995	107.2	0.120000000000002
%3	52	232	50	1.995	107.6	0.0799999999999983
%3	57	237	50	1.996	107.3	-0.0599999999999994
%4	2	242	50	2.021	108.5	0.240000000000001
%4	7	247	50	2.021	108.7	0.0400000000000006
4	12	252	50	2.021	108.3	-0.0800000000000011
4	17	257	50	2.021	108.8	0.1
%4	19	259	150	2.02	110	0.600000000000001
%4	24	264	150	2.021	115.7	1.14
%4	29	269	150	2.02	117	0.259999999999999
%4	34	274	150	2.02	115.5	-0.3
%4	39	279	150	2.02	116.3	0.159999999999999
%4	44	284	150	2.019	117.3	0.2
%4	49	289	150	2.019	116.8	-0.1
%4	54	294	150	2.019	118.5	0.340000000000001
%4	59	299	150	2.019	118	-0.1
5	4	304	150	2.019	118.1	0.0199999999999989
5	14	314	150	2.018	118.4	0.0300000000000011
%5	15	315	400	2.02	121.6	3.19999999999999
%5	20	320	400	2.019	125.8	0.840000000000001
%5	25	325	400	2.019	127.5	0.340000000000001
%5	30	330	400	2.019	126.4	-0.219999999999999
%5	35	335	400	2.019	127.8	0.279999999999998
5	40	340	400	2.019	127.6	-0.0400000000000006
5	45	345	400	2.019	127.4	-0.0399999999999977
%5	46	346	900	2.022	129.9	2.5
%5	51	351	900	2.022	135.3	1.08
%5	56	356	900	2.022	135.9	0.119999999999999
%6	1	361	900	2.022	136.8	0.180000000000001
%6	6	366	900	2.023	137.1	0.0599999999999966
6	11	371	900	2.022	137.4	0.0600000000000023
6	16	376	900	2.023	137.3	-0.0199999999999989
%6	17	377	1900	2.029	142	4.69999999999999
%6	22	382	1900	2.029	144.5	0.5
%6	27	387	1900	2.029	144.8	0.0600000000000023
%6	32	392	1900	2.028	145.2	0.0799999999999955
%6	37	397	1900	2.028	146.3	0.220000000000005
%6	42	402	1900	2.028	146.7	0.0799999999999955
%6	47	407	1900	2.028	147.4	0.140000000000003
6	52	412	1900	2.028	147.2	-0.0400000000000034
6	58	418	1900	2.028	145.9	-0.216666666666664
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	10	-29.6	
%0	5	5	0	9.928	-26.9	0.540000000000001
%0	15	15	0	9.866	-23.2	0.37
%0	20	20	0	9.855	-23.3	-0.0200000000000003
%0	25	25	0	9.804	-19.7	0.72
%0	30	30	0	9.791	-20.4	-0.14
%0	35	35	0	9.782	-19.8	0.12
%0	40	40	0	9.755	-19.3	0.1
%50	45	45	0	9.741	-17.4	0.38
%0	55	55	0	9.746	-17.4	0
%1	0	60	0	9.729	-17.7	-0.0600000000000001
1	5	65	0	9.697	-17	0.14
1	10	70	0	9.709	-17.3	-0.0600000000000001
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-16 -3 -40 150])

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -12.8893 50 0.329493 27.1984

list
string: Total Cu
 -6.94977 60 0.299539 19.9825

[I 20:53:27.249 NotebookApp] Saving file at /KNO3_pH10_0pt1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%1	17	77	0	2.009	78.1	13.6285714285714
%1	23	83	0	2.000	73.8	-0.716666666666666
%1	28	88	0	1.999	76	0.440000000000001
%1	33	93	0	1.999	77.8	0.359999999999999
%1	38	98	0	1.995	79.4	0.320000000000002
%1	43	103	0	1.996	81.8	0.479999999999998
%1	48	108	0	1.995	84	0.440000000000001
%1	53	113	0	2.005	86	0.4
%1	58	118	0	2.006	87.7	0.340000000000001
%2	3	123	0	2.008	89.8	0.419999999999999
%2	8	128	0	2.009	90.4	0.120000000000002
%2	13	133	0	2.006	91	0.119999999999999
%2	18	138	0	2.006	91.7	0.140000000000001
%2	23	143	0	2.005	92.3	0.119999999999999
%2	28	148	0	2.004	92.4	0.0200000000000017
%2	33	153	0	2.007	93.4	0.2
%2	38	158	0	2.003	93.9	0.1
%2	43	163	0	2.002	95	0.219999999999999
%2	48	168	0	2.001	95.4	0.0800000000000011
2	53	173	0	2.002	95.6	0.0399999999999977
2	58	178	0	2.001	95.6	0
%3	0	180	50	2.001	97.9	1.15000000000001
%3	5	185	50	2	102.8	0.979999999999998
%3	10	190	50	2	103.8	0.2
%3	22	202	50	1.998	105.2	0.116666666666667
%3	32	212	50	1.997	106.2	0.1
%3	37	217	50	1.996	107	0.159999999999999
%3	42	222	50	1.995	106.6	-0.0800000000000011
%3	47	227	50	1.995	107.2	0.120000000000002
%3	52	232	50	1.995	107.6	0.0799999999999983
%3	57	237	50	1.996	107.3	-0.0599999999999994
%4	2	242	50	2.021	108.5	0.240000000000001
%4	7	247	50	2.021	108.7	0.0400000000000006
4	12	252	50	2.021	108.3	-0.0800000000000011
4	17	257	50	2.021	108.8	0.1
%4	19	259	150	2.02	110	0.600000000000001
%4	24	264	150	2.021	115.7	1.14
%4	29	269	150	2.02	117	0.259999999999999
%4	34	274	150	2.02	115.5	-0.3
%4	39	279	150	2.02	116.3	0.159999999999999
%4	44	284	150	2.019	117.3	0.2
%4	49	289	150	2.019	116.8	-0.1
%4	54	294	150	2.019	118.5	0.340000000000001
%4	59	299	150	2.019	118	-0.1
5	4	304	150	2.019	118.1	0.0199999999999989
5	14	314	150	2.018	118.4	0.0300000000000011
%5	15	315	400	2.02	121.6	3.19999999999999
%5	20	320	400	2.019	125.8	0.840000000000001
%5	25	325	400	2.019	127.5	0.340000000000001
%5	30	330	400	2.019	126.4	-0.219999999999999
%5	35	335	400	2.019	127.8	0.279999999999998
5	40	340	400	2.019	127.6	-0.0400000000000006
5	45	345	400	2.019	127.4	-0.0399999999999977
%5	46	346	900	2.022	129.9	2.5
%5	51	351	900	2.022	135.3	1.08
%5	56	356	900	2.022	135.9	0.119999999999999
%6	1	361	900	2.022	136.8	0.180000000000001
%6	6	366	900	2.023	137.1	0.0599999999999966
6	11	371	900	2.022	137.4	0.0600000000000023
6	16	376	900	2.023	137.3	-0.0199999999999989
%6	17	377	1900	2.029	142	4.69999999999999
%6	22	382	1900	2.029	144.5	0.5
%6	27	387	1900	2.029	144.8	0.0600000000000023
%6	32	392	1900	2.028	145.2	0.0799999999999955
%6	37	397	1900	2.028	146.3	0.220000000000005
%6	42	402	1900	2.028	146.7	0.0799999999999955
%6	47	407	1900	2.028	147.4	0.140000000000003
6	52	412	1900	2.028	147.2	-0.0400000000000034
6	58	418	1900	2.028	145.9	-0.216666666666664
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	10	-29.6	
%0	5	5	0	9.928	-26.9	0.540000000000001
%0	15	15	0	9.866	-23.2	0.37
%0	20	20	0	9.855	-23.3	-0.0200000000000003
%0	25	25	0	9.804	-19.7	0.72
%0	30	30	0	9.791	-20.4	-0.14
%0	35	35	0	9.782	-19.8	0.12
%0	40	40	0	9.755	-19.3	0.1
%50	45	45	0	9.741	-17.4	0.38
%0	55	55	0	9.746	-17.4	0
%1	0	60	0	9.729	-17.7	-0.0600000000000001
1	5	65	0	9.697	-17	0.14
1	10	70	0	9.709	-17.3	-0.0600000000000001
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(2:end)),Emeas(2:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-16 -3 -40 150])

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -12.8893 50 0.329493 27.1984

list
string: Total Cu
 -6.94977 60 0.299539 19.9825

[I 20:55:27.295 NotebookApp] Saving file at /KNO3_pH10_0pt1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%1	17	77	0	2.009	78.1	13.6285714285714
%1	23	83	0	2.000	73.8	-0.716666666666666
%1	28	88	0	1.999	76	0.440000000000001
%1	33	93	0	1.999	77.8	0.359999999999999
%1	38	98	0	1.995	79.4	0.320000000000002
%1	43	103	0	1.996	81.8	0.479999999999998
%1	48	108	0	1.995	84	0.440000000000001
%1	53	113	0	2.005	86	0.4
%1	58	118	0	2.006	87.7	0.340000000000001
%2	3	123	0	2.008	89.8	0.419999999999999
%2	8	128	0	2.009	90.4	0.120000000000002
%2	13	133	0	2.006	91	0.119999999999999
%2	18	138	0	2.006	91.7	0.140000000000001
%2	23	143	0	2.005	92.3	0.119999999999999
%2	28	148	0	2.004	92.4	0.0200000000000017
%2	33	153	0	2.007	93.4	0.2
%2	38	158	0	2.003	93.9	0.1
%2	43	163	0	2.002	95	0.219999999999999
%2	48	168	0	2.001	95.4	0.0800000000000011
2	53	173	0	2.002	95.6	0.0399999999999977
2	58	178	0	2.001	95.6	0
%3	0	180	50	2.001	97.9	1.15000000000001
%3	5	185	50	2	102.8	0.979999999999998
%3	10	190	50	2	103.8	0.2
%3	22	202	50	1.998	105.2	0.116666666666667
%3	32	212	50	1.997	106.2	0.1
%3	37	217	50	1.996	107	0.159999999999999
%3	42	222	50	1.995	106.6	-0.0800000000000011
%3	47	227	50	1.995	107.2	0.120000000000002
%3	52	232	50	1.995	107.6	0.0799999999999983
%3	57	237	50	1.996	107.3	-0.0599999999999994
%4	2	242	50	2.021	108.5	0.240000000000001
%4	7	247	50	2.021	108.7	0.0400000000000006
4	12	252	50	2.021	108.3	-0.0800000000000011
4	17	257	50	2.021	108.8	0.1
%4	19	259	150	2.02	110	0.600000000000001
%4	24	264	150	2.021	115.7	1.14
%4	29	269	150	2.02	117	0.259999999999999
%4	34	274	150	2.02	115.5	-0.3
%4	39	279	150	2.02	116.3	0.159999999999999
%4	44	284	150	2.019	117.3	0.2
%4	49	289	150	2.019	116.8	-0.1
%4	54	294	150	2.019	118.5	0.340000000000001
%4	59	299	150	2.019	118	-0.1
5	4	304	150	2.019	118.1	0.0199999999999989
5	14	314	150	2.018	118.4	0.0300000000000011
%5	15	315	400	2.02	121.6	3.19999999999999
%5	20	320	400	2.019	125.8	0.840000000000001
%5	25	325	400	2.019	127.5	0.340000000000001
%5	30	330	400	2.019	126.4	-0.219999999999999
%5	35	335	400	2.019	127.8	0.279999999999998
5	40	340	400	2.019	127.6	-0.0400000000000006
5	45	345	400	2.019	127.4	-0.0399999999999977
%5	46	346	900	2.022	129.9	2.5
%5	51	351	900	2.022	135.3	1.08
%5	56	356	900	2.022	135.9	0.119999999999999
%6	1	361	900	2.022	136.8	0.180000000000001
%6	6	366	900	2.023	137.1	0.0599999999999966
6	11	371	900	2.022	137.4	0.0600000000000023
6	16	376	900	2.023	137.3	-0.0199999999999989
%6	17	377	1900	2.029	142	4.69999999999999
%6	22	382	1900	2.029	144.5	0.5
%6	27	387	1900	2.029	144.8	0.0600000000000023
%6	32	392	1900	2.028	145.2	0.0799999999999955
%6	37	397	1900	2.028	146.3	0.220000000000005
%6	42	402	1900	2.028	146.7	0.0799999999999955
%6	47	407	1900	2.028	147.4	0.140000000000003
6	52	412	1900	2.028	147.2	-0.0400000000000034
6	58	418	1900	2.028	145.9	-0.216666666666664
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	10	-29.6	
%0	5	5	0	9.928	-26.9	0.540000000000001
%0	15	15	0	9.866	-23.2	0.37
%0	20	20	0	9.855	-23.3	-0.0200000000000003
%0	25	25	0	9.804	-19.7	0.72
%0	30	30	0	9.791	-20.4	-0.14
%0	35	35	0	9.782	-19.8	0.12
%0	40	40	0	9.755	-19.3	0.1
%50	45	45	0	9.741	-17.4	0.38
%0	55	55	0	9.746	-17.4	0
%1	0	60	0	9.729	-17.7	-0.0600000000000001
1	5	65	0	9.697	-17	0.14
1	10	70	0	9.709	-17.3	-0.0600000000000001
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(2:end)),Emeas(2:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=95.6; Eorig=-17.3; %m=21.5;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%1	17	77	0	2.009	78.1	13.6285714285714
%1	23	83	0	2.000	73.8	-0.716666666666666
%1	28	88	0	1.999	76	0.440000000000001
%1	33	93	0	1.999	77.8	0.359999999999999
%1	38	98	0	1.995	79.4	0.320000000000002
%1	43	103	0	1.996	81.8	0.479999999999998
%1	48	108	0	1.995	84	0.440000000000001
%1	53	113	0	2.005	86	0.4
%1	58	118	0	2.006	87.7	0.340000000000001
%2	3	123	0	2.008	89.8	0.419999999999999
%2	8	128	0	2.009	90.4	0.120000000000002
%2	13	133	0	2.006	91	0.119999999999999
%2	18	138	0	2.006	91.7	0.140000000000001
%2	23	143	0	2.005	92.3	0.119999999999999
%2	28	148	0	2.004	92.4	0.0200000000000017
%2	33	153	0	2.007	93.4	0.2
%2	38	158	0	2.003	93.9	0.1
%2	43	163	0	2.002	95	0.219999999999999
%2	48	168	0	2.001	95.4	0.0800000000000011
2	53	173	0	2.002	95.6	0.0399999999999977
2	58	178	0	2.001	95.6	0
%3	0	180	50	2.001	97.9	1.15000000000001
%3	5	185	50	2	102.8	0.979999999999998
%3	10	190	50	2	103.8	0.2
%3	22	202	50	1.998	105.2	0.116666666666667
%3	32	212	50	1.997	106.2	0.1
%3	37	217	50	1.996	107	0.159999999999999
%3	42	222	50	1.995	106.6	-0.0800000000000011
%3	47	227	50	1.995	107.2	0.120000000000002
%3	52	232	50	1.995	107.6	0.0799999999999983
%3	57	237	50	1.996	107.3	-0.0599999999999994
%4	2	242	50	2.021	108.5	0.240000000000001
%4	7	247	50	2.021	108.7	0.0400000000000006
4	12	252	50	2.021	108.3	-0.0800000000000011
4	17	257	50	2.021	108.8	0.1
%4	19	259	150	2.02	110	0.600000000000001
%4	24	264	150	2.021	115.7	1.14
%4	29	269	150	2.02	117	0.259999999999999
%4	34	274	150	2.02	115.5	-0.3
%4	39	279	150	2.02	116.3	0.159999999999999
%4	44	284	150	2.019	117.3	0.2
%4	49	289	150	2.019	116.8	-0.1
%4	54	294	150	2.019	118.5	0.340000000000001
%4	59	299	150	2.019	118	-0.1
5	4	304	150	2.019	118.1	0.0199999999999989
5	14	314	150	2.018	118.4	0.0300000000000011
%5	15	315	400	2.02	121.6	3.19999999999999
%5	20	320	400	2.019	125.8	0.840000000000001
%5	25	325	400	2.019	127.5	0.340000000000001
%5	30	330	400	2.019	126.4	-0.219999999999999
%5	35	335	400	2.019	127.8	0.279999999999998
5	40	340	400	2.019	127.6	-0.0400000000000006
5	45	345	400	2.019	127.4	-0.0399999999999977
%5	46	346	900	2.022	129.9	2.5
%5	51	351	900	2.022	135.3	1.08
%5	56	356	900	2.022	135.9	0.119999999999999
%6	1	361	900	2.022	136.8	0.180000000000001
%6	6	366	900	2.023	137.1	0.0599999999999966
6	11	371	900	2.022	137.4	0.0600000000000023
6	16	376	900	2.023	137.3	-0.0199999999999989
%6	17	377	1900	2.029	142	4.69999999999999
%6	22	382	1900	2.029	144.5	0.5
%6	27	387	1900	2.029	144.8	0.0600000000000023
%6	32	392	1900	2.028	145.2	0.0799999999999955
%6	37	397	1900	2.028	146.3	0.220000000000005
%6	42	402	1900	2.028	146.7	0.0799999999999955
%6	47	407	1900	2.028	147.4	0.140000000000003
6	52	412	1900	2.028	147.2	-0.0400000000000034
6	58	418	1900	2.028	145.9	-0.216666666666664
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	10	-29.6	
%0	5	5	0	9.928	-26.9	0.540000000000001
%0	15	15	0	9.866	-23.2	0.37
%0	20	20	0	9.855	-23.3	-0.0200000000000003
%0	25	25	0	9.804	-19.7	0.72
%0	30	30	0	9.791	-20.4	-0.14
%0	35	35	0	9.782	-19.8	0.12
%0	40	40	0	9.755	-19.3	0.1
%50	45	45	0	9.741	-17.4	0.38
%0	55	55	0	9.746	-17.4	0
%1	0	60	0	9.729	-17.7	-0.0600000000000001
1	5	65	0	9.697	-17	0.14
1	10	70	0	9.709	-17.3	-0.0600000000000001
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(2:end)),Emeas(2:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=95.6; Eorig=-17.3; %m=21.5;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-16 -3 -40 150])

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -12.8893 50 0.329493 27.1984

list
string: Total Cu
 -6.94977 60 0.299539 19.9825

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%1	17	77	0	2.009	78.1	13.6285714285714
%1	23	83	0	2.000	73.8	-0.716666666666666
%1	28	88	0	1.999	76	0.440000000000001
%1	33	93	0	1.999	77.8	0.359999999999999
%1	38	98	0	1.995	79.4	0.320000000000002
%1	43	103	0	1.996	81.8	0.479999999999998
%1	48	108	0	1.995	84	0.440000000000001
%1	53	113	0	2.005	86	0.4
%1	58	118	0	2.006	87.7	0.340000000000001
%2	3	123	0	2.008	89.8	0.419999999999999
%2	8	128	0	2.009	90.4	0.120000000000002
%2	13	133	0	2.006	91	0.119999999999999
%2	18	138	0	2.006	91.7	0.140000000000001
%2	23	143	0	2.005	92.3	0.119999999999999
%2	28	148	0	2.004	92.4	0.0200000000000017
%2	33	153	0	2.007	93.4	0.2
%2	38	158	0	2.003	93.9	0.1
%2	43	163	0	2.002	95	0.219999999999999
%2	48	168	0	2.001	95.4	0.0800000000000011
2	53	173	0	2.002	95.6	0.0399999999999977
2	58	178	0	2.001	95.6	0
%3	0	180	50	2.001	97.9	1.15000000000001
%3	5	185	50	2	102.8	0.979999999999998
%3	10	190	50	2	103.8	0.2
%3	22	202	50	1.998	105.2	0.116666666666667
%3	32	212	50	1.997	106.2	0.1
%3	37	217	50	1.996	107	0.159999999999999
%3	42	222	50	1.995	106.6	-0.0800000000000011
%3	47	227	50	1.995	107.2	0.120000000000002
%3	52	232	50	1.995	107.6	0.0799999999999983
%3	57	237	50	1.996	107.3	-0.0599999999999994
%4	2	242	50	2.021	108.5	0.240000000000001
%4	7	247	50	2.021	108.7	0.0400000000000006
4	12	252	50	2.021	108.3	-0.0800000000000011
4	17	257	50	2.021	108.8	0.1
%4	19	259	150	2.02	110	0.600000000000001
%4	24	264	150	2.021	115.7	1.14
%4	29	269	150	2.02	117	0.259999999999999
%4	34	274	150	2.02	115.5	-0.3
%4	39	279	150	2.02	116.3	0.159999999999999
%4	44	284	150	2.019	117.3	0.2
%4	49	289	150	2.019	116.8	-0.1
%4	54	294	150	2.019	118.5	0.340000000000001
%4	59	299	150	2.019	118	-0.1
5	4	304	150	2.019	118.1	0.0199999999999989
5	14	314	150	2.018	118.4	0.0300000000000011
%5	15	315	400	2.02	121.6	3.19999999999999
%5	20	320	400	2.019	125.8	0.840000000000001
%5	25	325	400	2.019	127.5	0.340000000000001
%5	30	330	400	2.019	126.4	-0.219999999999999
%5	35	335	400	2.019	127.8	0.279999999999998
5	40	340	400	2.019	127.6	-0.0400000000000006
5	45	345	400	2.019	127.4	-0.0399999999999977
%5	46	346	900	2.022	129.9	2.5
%5	51	351	900	2.022	135.3	1.08
%5	56	356	900	2.022	135.9	0.119999999999999
%6	1	361	900	2.022	136.8	0.180000000000001
%6	6	366	900	2.023	137.1	0.0599999999999966
6	11	371	900	2.022	137.4	0.0600000000000023
6	16	376	900	2.023	137.3	-0.0199999999999989
%6	17	377	1900	2.029	142	4.69999999999999
%6	22	382	1900	2.029	144.5	0.5
%6	27	387	1900	2.029	144.8	0.0600000000000023
%6	32	392	1900	2.028	145.2	0.0799999999999955
%6	37	397	1900	2.028	146.3	0.220000000000005
%6	42	402	1900	2.028	146.7	0.0799999999999955
%6	47	407	1900	2.028	147.4	0.140000000000003
6	52	412	1900	2.028	147.2	-0.0400000000000034
6	58	418	1900	2.028	145.9	-0.216666666666664
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	10	-29.6	
%0	5	5	0	9.928	-26.9	0.540000000000001
%0	15	15	0	9.866	-23.2	0.37
%0	20	20	0	9.855	-23.3	-0.0200000000000003
%0	25	25	0	9.804	-19.7	0.72
%0	30	30	0	9.791	-20.4	-0.14
%0	35	35	0	9.782	-19.8	0.12
%0	40	40	0	9.755	-19.3	0.1
%50	45	45	0	9.741	-17.4	0.38
%0	55	55	0	9.746	-17.4	0
%1	0	60	0	9.729	-17.7	-0.0600000000000001
1	5	65	0	9.697	-17	0.14
1	10	70	0	9.709	-17.3	-0.0600000000000001
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(2:end)),Emeas(2:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=95.6; Eorig=-17.3; %m=21.5;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-16 -3 -40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -12.8893 50 0.329493 27.1984

list
string: Total Cu
 -6.94977 60 0.299539 19.9825

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=95.6; Eorig=-17.3; m=21.5;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%1	17	77	0	2.009	78.1	13.6285714285714
%1	23	83	0	2.000	73.8	-0.716666666666666
%1	28	88	0	1.999	76	0.440000000000001
%1	33	93	0	1.999	77.8	0.359999999999999
%1	38	98	0	1.995	79.4	0.320000000000002
%1	43	103	0	1.996	81.8	0.479999999999998
%1	48	108	0	1.995	84	0.440000000000001
%1	53	113	0	2.005	86	0.4
%1	58	118	0	2.006	87.7	0.340000000000001
%2	3	123	0	2.008	89.8	0.419999999999999
%2	8	128	0	2.009	90.4	0.120000000000002
%2	13	133	0	2.006	91	0.119999999999999
%2	18	138	0	2.006	91.7	0.140000000000001
%2	23	143	0	2.005	92.3	0.119999999999999
%2	28	148	0	2.004	92.4	0.0200000000000017
%2	33	153	0	2.007	93.4	0.2
%2	38	158	0	2.003	93.9	0.1
%2	43	163	0	2.002	95	0.219999999999999
%2	48	168	0	2.001	95.4	0.0800000000000011
2	53	173	0	2.002	95.6	0.0399999999999977
2	58	178	0	2.001	95.6	0
%3	0	180	50	2.001	97.9	1.15000000000001
%3	5	185	50	2	102.8	0.979999999999998
%3	10	190	50	2	103.8	0.2
%3	22	202	50	1.998	105.2	0.116666666666667
%3	32	212	50	1.997	106.2	0.1
%3	37	217	50	1.996	107	0.159999999999999
%3	42	222	50	1.995	106.6	-0.0800000000000011
%3	47	227	50	1.995	107.2	0.120000000000002
%3	52	232	50	1.995	107.6	0.0799999999999983
%3	57	237	50	1.996	107.3	-0.0599999999999994
%4	2	242	50	2.021	108.5	0.240000000000001
%4	7	247	50	2.021	108.7	0.0400000000000006
4	12	252	50	2.021	108.3	-0.0800000000000011
4	17	257	50	2.021	108.8	0.1
%4	19	259	150	2.02	110	0.600000000000001
%4	24	264	150	2.021	115.7	1.14
%4	29	269	150	2.02	117	0.259999999999999
%4	34	274	150	2.02	115.5	-0.3
%4	39	279	150	2.02	116.3	0.159999999999999
%4	44	284	150	2.019	117.3	0.2
%4	49	289	150	2.019	116.8	-0.1
%4	54	294	150	2.019	118.5	0.340000000000001
%4	59	299	150	2.019	118	-0.1
5	4	304	150	2.019	118.1	0.0199999999999989
5	14	314	150	2.018	118.4	0.0300000000000011
%5	15	315	400	2.02	121.6	3.19999999999999
%5	20	320	400	2.019	125.8	0.840000000000001
%5	25	325	400	2.019	127.5	0.340000000000001
%5	30	330	400	2.019	126.4	-0.219999999999999
%5	35	335	400	2.019	127.8	0.279999999999998
5	40	340	400	2.019	127.6	-0.0400000000000006
5	45	345	400	2.019	127.4	-0.0399999999999977
%5	46	346	900	2.022	129.9	2.5
%5	51	351	900	2.022	135.3	1.08
%5	56	356	900	2.022	135.9	0.119999999999999
%6	1	361	900	2.022	136.8	0.180000000000001
%6	6	366	900	2.023	137.1	0.0599999999999966
6	11	371	900	2.022	137.4	0.0600000000000023
6	16	376	900	2.023	137.3	-0.0199999999999989
%6	17	377	1900	2.029	142	4.69999999999999
%6	22	382	1900	2.029	144.5	0.5
%6	27	387	1900	2.029	144.8	0.0600000000000023
%6	32	392	1900	2.028	145.2	0.0799999999999955
%6	37	397	1900	2.028	146.3	0.220000000000005
%6	42	402	1900	2.028	146.7	0.0799999999999955
%6	47	407	1900	2.028	147.4	0.140000000000003
6	52	412	1900	2.028	147.2	-0.0400000000000034
6	58	418	1900	2.028	145.9	-0.216666666666664
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	10	-29.6	
%0	5	5	0	9.928	-26.9	0.540000000000001
%0	15	15	0	9.866	-23.2	0.37
%0	20	20	0	9.855	-23.3	-0.0200000000000003
%0	25	25	0	9.804	-19.7	0.72
%0	30	30	0	9.791	-20.4	-0.14
%0	35	35	0	9.782	-19.8	0.12
%0	40	40	0	9.755	-19.3	0.1
%50	45	45	0	9.741	-17.4	0.38
%0	55	55	0	9.746	-17.4	0
%1	0	60	0	9.729	-17.7	-0.0600000000000001
1	5	65	0	9.697	-17	0.14
1	10	70	0	9.709	-17.3	-0.0600000000000001
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(2:end)),Emeas(2:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=95.6; Eorig=-17.3; m=21.5;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-16 -3 -40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -12.8893 50 0.329493 27.1984

list
string: Total Cu
 -6.94977 60 0.299539 19.9825

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
4	35	275	0	2.001	115.1	0.2
4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=115; Eorig=52; m=21.5;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-13 -3 40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.12544 50 0.253456 15.7464

list
string: Total Cu
 -6.91521 60 0.230415 11.5688

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	"cumulative vol added"	pH	mvA	delta
% 1	30	90	0	2.029	73.3	9.97
% 1	35	95	0	2.023	73.4	0.02
% 1	40	100	0	2.022	76.8	0.68
% 1	45	105	0	2.002	77.8	0.2
% 1	55	115	0	2.004	74.9	-0.29
% 2	5	125	0	2.002	74.5	-0.04
%2	10	130	0	2.002	74.6	0.02
2	15	135	0	2.002	74.8	0.04
2	17	137	0	2.002	79.3	2.25
% 2	22	142	50	2.002	90	2.14
% 2	27	147	50	2.001	93.5	0.7
% 2	32	152	50	2.002	96.3	0.56
% 2	37	157	50	2.001	95.8	-0.1
%2	42	162	50	2.002	91.4	-0.88
%2	47	167	50	2	91	-0.08
%2	52	172	50	2.001	90.6	-0.08
% 2	57	177	150	2.000	90.6	0
% 2	58	178	150	2.001	94.4	3.8
% 3	3	183	150	2.002	100	1.12
% 3	8	188	150	2	101.3	0.26
% 3	13	193	150	2.001	107.5	1.24
% 3	18	198	150	2	108.7	0.24
% 3	23	203	150	2.002	108.6	-0.02
%3	28	208	150	2.001	109	0.08
%3	33	213	150	2	108.8	-0.04
3	38	218	150	2.001	108.4	-0.08
% 3	43	223	400	1.999	108.4	0
% 3	44	224	400	2.001	114.1	5.7
% 3	49	229	400	2.003	118.4	0.86
% 3	54	234	400	2.001	118.2	-0.04
%3	59	239	400	2.002	118	-0.04
4	4	244	400	2.002	118.4	0.08
% 4	5	245	900	2.005	122.1	3.7
% 4	10	250	900	2.005	126.6	0.9
% 4	15	255	900	2.005	128	0.28
%4	20	260	900	2.005	128.5	0.1
%4	25	265	900	2.006	128.2	-0.06
4	30	270	900	2.004	127.8	-0.08
% 4	31	271	1900	2.011	133	5.2
% 4	36	276	1900	2.012	136.5	0.7
% 4	41	281	1900	2.011	137.2	0.14
% 4	46	286	1900	2.011	137.4	0.04
%4	51	291	1900	2.01	136.8	-0.12
4	56	296	1900	2.011	137.2	0.08
% 5	1	301	3400	2.011	136.8	-0.08
% 5	3	303	3400	2.02	142.5	2.85
% 5	8	308	3400	2.022	143.2	0.14
% 5	13	313	3400	2.021	143.4	0.04
% 5	18	318	3400	2.022	143.1	-0.06
% 5	23	323	3400	2.021	142	-0.22
% 5	28	328	3400	2.021	142.4	0.08
% 5	33	333	3400	2.021	142	-0.08
%5	38	338	3400	2.019	141.1	-0.18
5	43	343	3400	2.019	142.2	0.22
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative vol added	pH	mvA	delta	mVB	deltaB	comments
% 0	0	0	0	9.625	60.9	
% 0	5	5	0	9.657	47.3	-2.72
% 0	15	15	0	9.574	-34.7	-8.2
% 0	20	20	0	9.643	-33	0.34
% 0	25	25	0	9.256	-19	2.8
% 0	30	30	0	9.54	-29.6	-2.12
% 0	35	35	0	9.537	-28.8	0.16
% 0	40	40	0	9.54	-28.4	0.08
% 0	45	45	0	9.532	-27	0.28
% 0	50	50	0	9.527	-27.6	-0.12
% 0	55	55	0	9.517	-27.7	-0.02
% 1	0	60	0	9.512	-27.7	0
% 1	5	65	0	9.502	-26.2	0.3
%1	10	70	0	9.501	-26.3	-0.02
%1	15	75	0	9.486	-26.5	-0.04
1	20	80	0	9.482	-26.4	0.02
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-6; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus),Emeas,1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=79.3; Eorig=-26.4; %m=21.5;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'r--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuwithCuOs) log10(CuwithCuOs)],[-100 150],'g--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -11.0185 50 0.253456 35.7873

list
string: Total Cu
 -5.91521 40 0.230415 26.2927

[I 20:57:18.751 NotebookApp] Saving file at /KNO3_pH9pt5_1uMCuT.ipynb
[I 20:57:27.341 NotebookApp] Saving file at /KNO3_pH10_0pt1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	"cumulative vol added"	pH	mvA	delta
% 1	30	90	0	2.029	73.3	9.97
% 1	35	95	0	2.023	73.4	0.02
% 1	40	100	0	2.022	76.8	0.68
% 1	45	105	0	2.002	77.8	0.2
% 1	55	115	0	2.004	74.9	-0.29
% 2	5	125	0	2.002	74.5	-0.04
%2	10	130	0	2.002	74.6	0.02
2	15	135	0	2.002	74.8	0.04
2	17	137	0	2.002	79.3	2.25
% 2	22	142	50	2.002	90	2.14
% 2	27	147	50	2.001	93.5	0.7
% 2	32	152	50	2.002	96.3	0.56
% 2	37	157	50	2.001	95.8	-0.1
%2	42	162	50	2.002	91.4	-0.88
%2	47	167	50	2	91	-0.08
%2	52	172	50	2.001	90.6	-0.08
% 2	57	177	150	2.000	90.6	0
% 2	58	178	150	2.001	94.4	3.8
% 3	3	183	150	2.002	100	1.12
% 3	8	188	150	2	101.3	0.26
% 3	13	193	150	2.001	107.5	1.24
% 3	18	198	150	2	108.7	0.24
% 3	23	203	150	2.002	108.6	-0.02
%3	28	208	150	2.001	109	0.08
%3	33	213	150	2	108.8	-0.04
3	38	218	150	2.001	108.4	-0.08
% 3	43	223	400	1.999	108.4	0
% 3	44	224	400	2.001	114.1	5.7
% 3	49	229	400	2.003	118.4	0.86
% 3	54	234	400	2.001	118.2	-0.04
%3	59	239	400	2.002	118	-0.04
4	4	244	400	2.002	118.4	0.08
% 4	5	245	900	2.005	122.1	3.7
% 4	10	250	900	2.005	126.6	0.9
% 4	15	255	900	2.005	128	0.28
%4	20	260	900	2.005	128.5	0.1
%4	25	265	900	2.006	128.2	-0.06
4	30	270	900	2.004	127.8	-0.08
% 4	31	271	1900	2.011	133	5.2
% 4	36	276	1900	2.012	136.5	0.7
% 4	41	281	1900	2.011	137.2	0.14
% 4	46	286	1900	2.011	137.4	0.04
%4	51	291	1900	2.01	136.8	-0.12
4	56	296	1900	2.011	137.2	0.08
% 5	1	301	3400	2.011	136.8	-0.08
% 5	3	303	3400	2.02	142.5	2.85
% 5	8	308	3400	2.022	143.2	0.14
% 5	13	313	3400	2.021	143.4	0.04
% 5	18	318	3400	2.022	143.1	-0.06
% 5	23	323	3400	2.021	142	-0.22
% 5	28	328	3400	2.021	142.4	0.08
% 5	33	333	3400	2.021	142	-0.08
%5	38	338	3400	2.019	141.1	-0.18
5	43	343	3400	2.019	142.2	0.22
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative vol added	pH	mvA	delta	mVB	deltaB	comments
% 0	0	0	0	9.625	60.9	
% 0	5	5	0	9.657	47.3	-2.72
% 0	15	15	0	9.574	-34.7	-8.2
% 0	20	20	0	9.643	-33	0.34
% 0	25	25	0	9.256	-19	2.8
% 0	30	30	0	9.54	-29.6	-2.12
% 0	35	35	0	9.537	-28.8	0.16
% 0	40	40	0	9.54	-28.4	0.08
% 0	45	45	0	9.532	-27	0.28
% 0	50	50	0	9.527	-27.6	-0.12
% 0	55	55	0	9.517	-27.7	-0.02
% 1	0	60	0	9.512	-27.7	0
% 1	5	65	0	9.502	-26.2	0.3
%1	10	70	0	9.501	-26.3	-0.02
%1	15	75	0	9.486	-26.5	-0.04
1	20	80	0	9.482	-26.4	0.02
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-6; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus),Emeas,1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=79.3; Eorig=-26.4; m=21.5;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'r--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuwithCuOs) log10(CuwithCuOs)],[-100 150],'g--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -11.0185 50 0.253456 35.7873

list
string: Total Cu
 -5.91521 40 0.230415 26.2927

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
4	35	275	0	2.001	115.1	0.2
4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=115; Eorig=52; m=21.5;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-13 -3 40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.12544 50 0.253456 15.7464

list
string: Total Cu
 -6.91521 60 0.230415 11.5688

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%1	17	77	0	2.009	78.1	13.6285714285714
%1	23	83	0	2.000	73.8	-0.716666666666666
%1	28	88	0	1.999	76	0.440000000000001
%1	33	93	0	1.999	77.8	0.359999999999999
%1	38	98	0	1.995	79.4	0.320000000000002
%1	43	103	0	1.996	81.8	0.479999999999998
%1	48	108	0	1.995	84	0.440000000000001
%1	53	113	0	2.005	86	0.4
%1	58	118	0	2.006	87.7	0.340000000000001
%2	3	123	0	2.008	89.8	0.419999999999999
%2	8	128	0	2.009	90.4	0.120000000000002
%2	13	133	0	2.006	91	0.119999999999999
%2	18	138	0	2.006	91.7	0.140000000000001
%2	23	143	0	2.005	92.3	0.119999999999999
%2	28	148	0	2.004	92.4	0.0200000000000017
%2	33	153	0	2.007	93.4	0.2
%2	38	158	0	2.003	93.9	0.1
%2	43	163	0	2.002	95	0.219999999999999
%2	48	168	0	2.001	95.4	0.0800000000000011
2	53	173	0	2.002	95.6	0.0399999999999977
2	58	178	0	2.001	95.6	0
%3	0	180	50	2.001	97.9	1.15000000000001
%3	5	185	50	2	102.8	0.979999999999998
%3	10	190	50	2	103.8	0.2
%3	22	202	50	1.998	105.2	0.116666666666667
%3	32	212	50	1.997	106.2	0.1
%3	37	217	50	1.996	107	0.159999999999999
%3	42	222	50	1.995	106.6	-0.0800000000000011
%3	47	227	50	1.995	107.2	0.120000000000002
%3	52	232	50	1.995	107.6	0.0799999999999983
%3	57	237	50	1.996	107.3	-0.0599999999999994
%4	2	242	50	2.021	108.5	0.240000000000001
%4	7	247	50	2.021	108.7	0.0400000000000006
4	12	252	50	2.021	108.3	-0.0800000000000011
4	17	257	50	2.021	108.8	0.1
%4	19	259	150	2.02	110	0.600000000000001
%4	24	264	150	2.021	115.7	1.14
%4	29	269	150	2.02	117	0.259999999999999
%4	34	274	150	2.02	115.5	-0.3
%4	39	279	150	2.02	116.3	0.159999999999999
%4	44	284	150	2.019	117.3	0.2
%4	49	289	150	2.019	116.8	-0.1
%4	54	294	150	2.019	118.5	0.340000000000001
%4	59	299	150	2.019	118	-0.1
5	4	304	150	2.019	118.1	0.0199999999999989
5	14	314	150	2.018	118.4	0.0300000000000011
%5	15	315	400	2.02	121.6	3.19999999999999
%5	20	320	400	2.019	125.8	0.840000000000001
%5	25	325	400	2.019	127.5	0.340000000000001
%5	30	330	400	2.019	126.4	-0.219999999999999
%5	35	335	400	2.019	127.8	0.279999999999998
5	40	340	400	2.019	127.6	-0.0400000000000006
5	45	345	400	2.019	127.4	-0.0399999999999977
%5	46	346	900	2.022	129.9	2.5
%5	51	351	900	2.022	135.3	1.08
%5	56	356	900	2.022	135.9	0.119999999999999
%6	1	361	900	2.022	136.8	0.180000000000001
%6	6	366	900	2.023	137.1	0.0599999999999966
6	11	371	900	2.022	137.4	0.0600000000000023
6	16	376	900	2.023	137.3	-0.0199999999999989
%6	17	377	1900	2.029	142	4.69999999999999
%6	22	382	1900	2.029	144.5	0.5
%6	27	387	1900	2.029	144.8	0.0600000000000023
%6	32	392	1900	2.028	145.2	0.0799999999999955
%6	37	397	1900	2.028	146.3	0.220000000000005
%6	42	402	1900	2.028	146.7	0.0799999999999955
%6	47	407	1900	2.028	147.4	0.140000000000003
6	52	412	1900	2.028	147.2	-0.0400000000000034
6	58	418	1900	2.028	145.9	-0.216666666666664
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	10	-29.6	
%0	5	5	0	9.928	-26.9	0.540000000000001
%0	15	15	0	9.866	-23.2	0.37
%0	20	20	0	9.855	-23.3	-0.0200000000000003
%0	25	25	0	9.804	-19.7	0.72
%0	30	30	0	9.791	-20.4	-0.14
%0	35	35	0	9.782	-19.8	0.12
%0	40	40	0	9.755	-19.3	0.1
%50	45	45	0	9.741	-17.4	0.38
%0	55	55	0	9.746	-17.4	0
%1	0	60	0	9.729	-17.7	-0.0600000000000001
1	5	65	0	9.697	-17	0.14
1	10	70	0	9.709	-17.3	-0.0600000000000001
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(2:end)),Emeas(2:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=95.6; Eorig=-17.3; m=21.5;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-16 -3 -40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -12.8893 50 0.329493 27.1984

list
string: Total Cu
 -6.94977 60 0.299539 19.9825

[I 20:58:09.106 NotebookApp] Saving file at /KNO3_pH8_0pt1uMCuT.ipynb
[I 20:59:18.796 NotebookApp] Saving file at /KNO3_pH9pt5_1uMCuT.ipynb
[I 20:59:27.379 NotebookApp] Saving file at /KNO3_pH10_0pt1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%1	17	77	0	2.009	78.1	13.6285714285714
%1	23	83	0	2.000	73.8	-0.716666666666666
%1	28	88	0	1.999	76	0.440000000000001
%1	33	93	0	1.999	77.8	0.359999999999999
%1	38	98	0	1.995	79.4	0.320000000000002
%1	43	103	0	1.996	81.8	0.479999999999998
%1	48	108	0	1.995	84	0.440000000000001
%1	53	113	0	2.005	86	0.4
%1	58	118	0	2.006	87.7	0.340000000000001
%2	3	123	0	2.008	89.8	0.419999999999999
%2	8	128	0	2.009	90.4	0.120000000000002
%2	13	133	0	2.006	91	0.119999999999999
%2	18	138	0	2.006	91.7	0.140000000000001
%2	23	143	0	2.005	92.3	0.119999999999999
%2	28	148	0	2.004	92.4	0.0200000000000017
%2	33	153	0	2.007	93.4	0.2
%2	38	158	0	2.003	93.9	0.1
%2	43	163	0	2.002	95	0.219999999999999
%2	48	168	0	2.001	95.4	0.0800000000000011
2	53	173	0	2.002	95.6	0.0399999999999977
2	58	178	0	2.001	95.6	0
%3	0	180	50	2.001	97.9	1.15000000000001
%3	5	185	50	2	102.8	0.979999999999998
%3	10	190	50	2	103.8	0.2
%3	22	202	50	1.998	105.2	0.116666666666667
%3	32	212	50	1.997	106.2	0.1
%3	37	217	50	1.996	107	0.159999999999999
%3	42	222	50	1.995	106.6	-0.0800000000000011
%3	47	227	50	1.995	107.2	0.120000000000002
%3	52	232	50	1.995	107.6	0.0799999999999983
%3	57	237	50	1.996	107.3	-0.0599999999999994
%4	2	242	50	2.021	108.5	0.240000000000001
%4	7	247	50	2.021	108.7	0.0400000000000006
4	12	252	50	2.021	108.3	-0.0800000000000011
4	17	257	50	2.021	108.8	0.1
%4	19	259	150	2.02	110	0.600000000000001
%4	24	264	150	2.021	115.7	1.14
%4	29	269	150	2.02	117	0.259999999999999
%4	34	274	150	2.02	115.5	-0.3
%4	39	279	150	2.02	116.3	0.159999999999999
%4	44	284	150	2.019	117.3	0.2
%4	49	289	150	2.019	116.8	-0.1
%4	54	294	150	2.019	118.5	0.340000000000001
%4	59	299	150	2.019	118	-0.1
5	4	304	150	2.019	118.1	0.0199999999999989
5	14	314	150	2.018	118.4	0.0300000000000011
%5	15	315	400	2.02	121.6	3.19999999999999
%5	20	320	400	2.019	125.8	0.840000000000001
%5	25	325	400	2.019	127.5	0.340000000000001
%5	30	330	400	2.019	126.4	-0.219999999999999
%5	35	335	400	2.019	127.8	0.279999999999998
5	40	340	400	2.019	127.6	-0.0400000000000006
5	45	345	400	2.019	127.4	-0.0399999999999977
%5	46	346	900	2.022	129.9	2.5
%5	51	351	900	2.022	135.3	1.08
%5	56	356	900	2.022	135.9	0.119999999999999
%6	1	361	900	2.022	136.8	0.180000000000001
%6	6	366	900	2.023	137.1	0.0599999999999966
6	11	371	900	2.022	137.4	0.0600000000000023
6	16	376	900	2.023	137.3	-0.0199999999999989
%6	17	377	1900	2.029	142	4.69999999999999
%6	22	382	1900	2.029	144.5	0.5
%6	27	387	1900	2.029	144.8	0.0600000000000023
%6	32	392	1900	2.028	145.2	0.0799999999999955
%6	37	397	1900	2.028	146.3	0.220000000000005
%6	42	402	1900	2.028	146.7	0.0799999999999955
%6	47	407	1900	2.028	147.4	0.140000000000003
6	52	412	1900	2.028	147.2	-0.0400000000000034
6	58	418	1900	2.028	145.9	-0.216666666666664
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	10	-29.6	
%0	5	5	0	9.928	-26.9	0.540000000000001
%0	15	15	0	9.866	-23.2	0.37
%0	20	20	0	9.855	-23.3	-0.0200000000000003
%0	25	25	0	9.804	-19.7	0.72
%0	30	30	0	9.791	-20.4	-0.14
%0	35	35	0	9.782	-19.8	0.12
%0	40	40	0	9.755	-19.3	0.1
%50	45	45	0	9.741	-17.4	0.38
%0	55	55	0	9.746	-17.4	0
%1	0	60	0	9.729	-17.7	-0.0600000000000001
1	5	65	0	9.697	-17	0.14
1	10	70	0	9.709	-17.3	-0.0600000000000001
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=95.6; Eorig=-17.3; m=21.5;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-16 -3 -40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -12.8893 50 0.329493 27.1984

list
string: Total Cu
 -6.94977 60 0.299539 19.9825

[I 21:01:27.419 NotebookApp] Saving file at /KNO3_pH10_0pt1uMCuT.ipynb
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-1.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-16 -3 -40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -16.8769 50 0.329493 27.1984

list
string: Total Cu
 -6.94977 60 0.299539 19.9825

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-11.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-16 -3 -40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -9.25022 50 0.329493 27.1984

list
string: Total Cu
 -6.94977 60 0.299539 19.9825

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-16 -3 -40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -12.8893 50 0.329493 27.1984

list
string: Total Cu
 -6.94977 60 0.299539 19.9825

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-13.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-16 -3 -40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -9.25022 50 0.329493 27.1984

list
string: Total Cu
 -6.94977 60 0.299539 19.9825

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%1	17	77	0	2.009	78.1	13.6285714285714
%1	23	83	0	2.000	73.8	-0.716666666666666
%1	28	88	0	1.999	76	0.440000000000001
%1	33	93	0	1.999	77.8	0.359999999999999
%1	38	98	0	1.995	79.4	0.320000000000002
%1	43	103	0	1.996	81.8	0.479999999999998
%1	48	108	0	1.995	84	0.440000000000001
%1	53	113	0	2.005	86	0.4
%1	58	118	0	2.006	87.7	0.340000000000001
%2	3	123	0	2.008	89.8	0.419999999999999
%2	8	128	0	2.009	90.4	0.120000000000002
%2	13	133	0	2.006	91	0.119999999999999
%2	18	138	0	2.006	91.7	0.140000000000001
%2	23	143	0	2.005	92.3	0.119999999999999
%2	28	148	0	2.004	92.4	0.0200000000000017
%2	33	153	0	2.007	93.4	0.2
%2	38	158	0	2.003	93.9	0.1
%2	43	163	0	2.002	95	0.219999999999999
%2	48	168	0	2.001	95.4	0.0800000000000011
2	53	173	0	2.002	95.6	0.0399999999999977
2	58	178	0	2.001	95.6	0
%3	0	180	50	2.001	97.9	1.15000000000001
%3	5	185	50	2	102.8	0.979999999999998
%3	10	190	50	2	103.8	0.2
%3	22	202	50	1.998	105.2	0.116666666666667
%3	32	212	50	1.997	106.2	0.1
%3	37	217	50	1.996	107	0.159999999999999
%3	42	222	50	1.995	106.6	-0.0800000000000011
%3	47	227	50	1.995	107.2	0.120000000000002
%3	52	232	50	1.995	107.6	0.0799999999999983
%3	57	237	50	1.996	107.3	-0.0599999999999994
%4	2	242	50	2.021	108.5	0.240000000000001
%4	7	247	50	2.021	108.7	0.0400000000000006
4	12	252	50	2.021	108.3	-0.0800000000000011
4	17	257	50	2.021	108.8	0.1
%4	19	259	150	2.02	110	0.600000000000001
%4	24	264	150	2.021	115.7	1.14
%4	29	269	150	2.02	117	0.259999999999999
%4	34	274	150	2.02	115.5	-0.3
%4	39	279	150	2.02	116.3	0.159999999999999
%4	44	284	150	2.019	117.3	0.2
%4	49	289	150	2.019	116.8	-0.1
%4	54	294	150	2.019	118.5	0.340000000000001
%4	59	299	150	2.019	118	-0.1
5	4	304	150	2.019	118.1	0.0199999999999989
5	14	314	150	2.018	118.4	0.0300000000000011
%5	15	315	400	2.02	121.6	3.19999999999999
%5	20	320	400	2.019	125.8	0.840000000000001
%5	25	325	400	2.019	127.5	0.340000000000001
%5	30	330	400	2.019	126.4	-0.219999999999999
%5	35	335	400	2.019	127.8	0.279999999999998
5	40	340	400	2.019	127.6	-0.0400000000000006
5	45	345	400	2.019	127.4	-0.0399999999999977
%5	46	346	900	2.022	129.9	2.5
%5	51	351	900	2.022	135.3	1.08
%5	56	356	900	2.022	135.9	0.119999999999999
%6	1	361	900	2.022	136.8	0.180000000000001
%6	6	366	900	2.023	137.1	0.0599999999999966
6	11	371	900	2.022	137.4	0.0600000000000023
6	16	376	900	2.023	137.3	-0.0199999999999989
%6	17	377	1900	2.029	142	4.69999999999999
%6	22	382	1900	2.029	144.5	0.5
%6	27	387	1900	2.029	144.8	0.0600000000000023
%6	32	392	1900	2.028	145.2	0.0799999999999955
%6	37	397	1900	2.028	146.3	0.220000000000005
%6	42	402	1900	2.028	146.7	0.0799999999999955
%6	47	407	1900	2.028	147.4	0.140000000000003
6	52	412	1900	2.028	147.2	-0.0400000000000034
6	58	418	1900	2.028	145.9	-0.216666666666664
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	10	-29.6	
%0	5	5	0	9.928	-26.9	0.540000000000001
%0	15	15	0	9.866	-23.2	0.37
%0	20	20	0	9.855	-23.3	-0.0200000000000003
%0	25	25	0	9.804	-19.7	0.72
%0	30	30	0	9.791	-20.4	-0.14
%0	35	35	0	9.782	-19.8	0.12
%0	40	40	0	9.755	-19.3	0.1
%50	45	45	0	9.741	-17.4	0.38
%0	55	55	0	9.746	-17.4	0
%1	0	60	0	9.729	-17.7	-0.0600000000000001
1	5	65	0	9.697	-17	0.14
1	10	70	0	9.709	-17.3	-0.0600000000000001
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=95.6; Eorig=-17.3; m=21.5;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-16 -3 -40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -12.8893 50 0.329493 27.1984

list
string: Total Cu
 -6.94977 60 0.299539 19.9825

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%1	17	77	0	2.009	78.1	13.6285714285714
%1	23	83	0	2.000	73.8	-0.716666666666666
%1	28	88	0	1.999	76	0.440000000000001
%1	33	93	0	1.999	77.8	0.359999999999999
%1	38	98	0	1.995	79.4	0.320000000000002
%1	43	103	0	1.996	81.8	0.479999999999998
%1	48	108	0	1.995	84	0.440000000000001
%1	53	113	0	2.005	86	0.4
%1	58	118	0	2.006	87.7	0.340000000000001
%2	3	123	0	2.008	89.8	0.419999999999999
%2	8	128	0	2.009	90.4	0.120000000000002
%2	13	133	0	2.006	91	0.119999999999999
%2	18	138	0	2.006	91.7	0.140000000000001
%2	23	143	0	2.005	92.3	0.119999999999999
%2	28	148	0	2.004	92.4	0.0200000000000017
%2	33	153	0	2.007	93.4	0.2
%2	38	158	0	2.003	93.9	0.1
%2	43	163	0	2.002	95	0.219999999999999
%2	48	168	0	2.001	95.4	0.0800000000000011
2	53	173	0	2.002	95.6	0.0399999999999977
2	58	178	0	2.001	95.6	0
%3	0	180	50	2.001	97.9	1.15000000000001
%3	5	185	50	2	102.8	0.979999999999998
%3	10	190	50	2	103.8	0.2
%3	22	202	50	1.998	105.2	0.116666666666667
%3	32	212	50	1.997	106.2	0.1
%3	37	217	50	1.996	107	0.159999999999999
%3	42	222	50	1.995	106.6	-0.0800000000000011
%3	47	227	50	1.995	107.2	0.120000000000002
%3	52	232	50	1.995	107.6	0.0799999999999983
%3	57	237	50	1.996	107.3	-0.0599999999999994
%4	2	242	50	2.021	108.5	0.240000000000001
%4	7	247	50	2.021	108.7	0.0400000000000006
4	12	252	50	2.021	108.3	-0.0800000000000011
4	17	257	50	2.021	108.8	0.1
%4	19	259	150	2.02	110	0.600000000000001
%4	24	264	150	2.021	115.7	1.14
%4	29	269	150	2.02	117	0.259999999999999
%4	34	274	150	2.02	115.5	-0.3
%4	39	279	150	2.02	116.3	0.159999999999999
%4	44	284	150	2.019	117.3	0.2
%4	49	289	150	2.019	116.8	-0.1
%4	54	294	150	2.019	118.5	0.340000000000001
%4	59	299	150	2.019	118	-0.1
5	4	304	150	2.019	118.1	0.0199999999999989
5	14	314	150	2.018	118.4	0.0300000000000011
%5	15	315	400	2.02	121.6	3.19999999999999
%5	20	320	400	2.019	125.8	0.840000000000001
%5	25	325	400	2.019	127.5	0.340000000000001
%5	30	330	400	2.019	126.4	-0.219999999999999
%5	35	335	400	2.019	127.8	0.279999999999998
5	40	340	400	2.019	127.6	-0.0400000000000006
5	45	345	400	2.019	127.4	-0.0399999999999977
%5	46	346	900	2.022	129.9	2.5
%5	51	351	900	2.022	135.3	1.08
%5	56	356	900	2.022	135.9	0.119999999999999
%6	1	361	900	2.022	136.8	0.180000000000001
%6	6	366	900	2.023	137.1	0.0599999999999966
6	11	371	900	2.022	137.4	0.0600000000000023
6	16	376	900	2.023	137.3	-0.0199999999999989
%6	17	377	1900	2.029	142	4.69999999999999
%6	22	382	1900	2.029	144.5	0.5
%6	27	387	1900	2.029	144.8	0.0600000000000023
%6	32	392	1900	2.028	145.2	0.0799999999999955
%6	37	397	1900	2.028	146.3	0.220000000000005
%6	42	402	1900	2.028	146.7	0.0799999999999955
%6	47	407	1900	2.028	147.4	0.140000000000003
6	52	412	1900	2.028	147.2	-0.0400000000000034
6	58	418	1900	2.028	145.9	-0.216666666666664
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	10	-29.6	
%0	5	5	0	9.928	-26.9	0.540000000000001
%0	15	15	0	9.866	-23.2	0.37
%0	20	20	0	9.855	-23.3	-0.0200000000000003
%0	25	25	0	9.804	-19.7	0.72
%0	30	30	0	9.791	-20.4	-0.14
%0	35	35	0	9.782	-19.8	0.12
%0	40	40	0	9.755	-19.3	0.1
%50	45	45	0	9.741	-17.4	0.38
%0	55	55	0	9.746	-17.4	0
%1	0	60	0	9.729	-17.7	-0.0600000000000001
1	5	65	0	9.697	-17	0.14
1	10	70	0	9.709	-17.3	-0.0600000000000001
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=95.6; Eorig=-17.3; m=21.5;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 -40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -12.8893 50 0.329493 27.1984

list
string: Total Cu
 -6.94977 60 0.299539 19.9825

[I 21:03:27.464 NotebookApp] Saving file at /KNO3_pH10_0pt1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%1	17	77	0	2.009	78.1	13.6285714285714
%1	23	83	0	2.000	73.8	-0.716666666666666
%1	28	88	0	1.999	76	0.440000000000001
%1	33	93	0	1.999	77.8	0.359999999999999
%1	38	98	0	1.995	79.4	0.320000000000002
%1	43	103	0	1.996	81.8	0.479999999999998
%1	48	108	0	1.995	84	0.440000000000001
%1	53	113	0	2.005	86	0.4
%1	58	118	0	2.006	87.7	0.340000000000001
%2	3	123	0	2.008	89.8	0.419999999999999
%2	8	128	0	2.009	90.4	0.120000000000002
%2	13	133	0	2.006	91	0.119999999999999
%2	18	138	0	2.006	91.7	0.140000000000001
%2	23	143	0	2.005	92.3	0.119999999999999
%2	28	148	0	2.004	92.4	0.0200000000000017
%2	33	153	0	2.007	93.4	0.2
%2	38	158	0	2.003	93.9	0.1
%2	43	163	0	2.002	95	0.219999999999999
%2	48	168	0	2.001	95.4	0.0800000000000011
2	53	173	0	2.002	95.6	0.0399999999999977
2	58	178	0	2.001	95.6	0
%3	0	180	50	2.001	97.9	1.15000000000001
%3	5	185	50	2	102.8	0.979999999999998
%3	10	190	50	2	103.8	0.2
%3	22	202	50	1.998	105.2	0.116666666666667
%3	32	212	50	1.997	106.2	0.1
%3	37	217	50	1.996	107	0.159999999999999
%3	42	222	50	1.995	106.6	-0.0800000000000011
%3	47	227	50	1.995	107.2	0.120000000000002
%3	52	232	50	1.995	107.6	0.0799999999999983
%3	57	237	50	1.996	107.3	-0.0599999999999994
%4	2	242	50	2.021	108.5	0.240000000000001
%4	7	247	50	2.021	108.7	0.0400000000000006
4	12	252	50	2.021	108.3	-0.0800000000000011
4	17	257	50	2.021	108.8	0.1
%4	19	259	150	2.02	110	0.600000000000001
%4	24	264	150	2.021	115.7	1.14
%4	29	269	150	2.02	117	0.259999999999999
%4	34	274	150	2.02	115.5	-0.3
%4	39	279	150	2.02	116.3	0.159999999999999
%4	44	284	150	2.019	117.3	0.2
%4	49	289	150	2.019	116.8	-0.1
%4	54	294	150	2.019	118.5	0.340000000000001
%4	59	299	150	2.019	118	-0.1
5	4	304	150	2.019	118.1	0.0199999999999989
5	14	314	150	2.018	118.4	0.0300000000000011
%5	15	315	400	2.02	121.6	3.19999999999999
%5	20	320	400	2.019	125.8	0.840000000000001
%5	25	325	400	2.019	127.5	0.340000000000001
%5	30	330	400	2.019	126.4	-0.219999999999999
%5	35	335	400	2.019	127.8	0.279999999999998
5	40	340	400	2.019	127.6	-0.0400000000000006
5	45	345	400	2.019	127.4	-0.0399999999999977
%5	46	346	900	2.022	129.9	2.5
%5	51	351	900	2.022	135.3	1.08
%5	56	356	900	2.022	135.9	0.119999999999999
%6	1	361	900	2.022	136.8	0.180000000000001
%6	6	366	900	2.023	137.1	0.0599999999999966
6	11	371	900	2.022	137.4	0.0600000000000023
6	16	376	900	2.023	137.3	-0.0199999999999989
%6	17	377	1900	2.029	142	4.69999999999999
%6	22	382	1900	2.029	144.5	0.5
%6	27	387	1900	2.029	144.8	0.0600000000000023
%6	32	392	1900	2.028	145.2	0.0799999999999955
%6	37	397	1900	2.028	146.3	0.220000000000005
%6	42	402	1900	2.028	146.7	0.0799999999999955
%6	47	407	1900	2.028	147.4	0.140000000000003
6	52	412	1900	2.028	147.2	-0.0400000000000034
6	58	418	1900	2.028	145.9	-0.216666666666664
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	10	-29.6	
%0	5	5	0	9.928	-26.9	0.540000000000001
%0	15	15	0	9.866	-23.2	0.37
%0	20	20	0	9.855	-23.3	-0.0200000000000003
%0	25	25	0	9.804	-19.7	0.72
%0	30	30	0	9.791	-20.4	-0.14
%0	35	35	0	9.782	-19.8	0.12
%0	40	40	0	9.755	-19.3	0.1
%50	45	45	0	9.741	-17.4	0.38
%0	55	55	0	9.746	-17.4	0
%1	0	60	0	9.729	-17.7	-0.0600000000000001
1	5	65	0	9.697	-17	0.14
1	10	70	0	9.709	-17.3	-0.0600000000000001
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=95.6; Eorig=-17.3; m=21.5;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 -40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -12.8893 50 0.329493 27.1984

list
string: Total Cu
 -6.94977 60 0.299539 19.9825

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%1	17	77	0	2.009	78.1	13.6285714285714
%1	23	83	0	2.000	73.8	-0.716666666666666
%1	28	88	0	1.999	76	0.440000000000001
%1	33	93	0	1.999	77.8	0.359999999999999
%1	38	98	0	1.995	79.4	0.320000000000002
%1	43	103	0	1.996	81.8	0.479999999999998
%1	48	108	0	1.995	84	0.440000000000001
%1	53	113	0	2.005	86	0.4
%1	58	118	0	2.006	87.7	0.340000000000001
%2	3	123	0	2.008	89.8	0.419999999999999
%2	8	128	0	2.009	90.4	0.120000000000002
%2	13	133	0	2.006	91	0.119999999999999
%2	18	138	0	2.006	91.7	0.140000000000001
%2	23	143	0	2.005	92.3	0.119999999999999
%2	28	148	0	2.004	92.4	0.0200000000000017
%2	33	153	0	2.007	93.4	0.2
%2	38	158	0	2.003	93.9	0.1
%2	43	163	0	2.002	95	0.219999999999999
%2	48	168	0	2.001	95.4	0.0800000000000011
2	53	173	0	2.002	95.6	0.0399999999999977
2	58	178	0	2.001	95.6	0
%3	0	180	50	2.001	97.9	1.15000000000001
%3	5	185	50	2	102.8	0.979999999999998
%3	10	190	50	2	103.8	0.2
%3	22	202	50	1.998	105.2	0.116666666666667
%3	32	212	50	1.997	106.2	0.1
%3	37	217	50	1.996	107	0.159999999999999
%3	42	222	50	1.995	106.6	-0.0800000000000011
%3	47	227	50	1.995	107.2	0.120000000000002
%3	52	232	50	1.995	107.6	0.0799999999999983
%3	57	237	50	1.996	107.3	-0.0599999999999994
%4	2	242	50	2.021	108.5	0.240000000000001
%4	7	247	50	2.021	108.7	0.0400000000000006
4	12	252	50	2.021	108.3	-0.0800000000000011
4	17	257	50	2.021	108.8	0.1
%4	19	259	150	2.02	110	0.600000000000001
%4	24	264	150	2.021	115.7	1.14
%4	29	269	150	2.02	117	0.259999999999999
%4	34	274	150	2.02	115.5	-0.3
%4	39	279	150	2.02	116.3	0.159999999999999
%4	44	284	150	2.019	117.3	0.2
%4	49	289	150	2.019	116.8	-0.1
%4	54	294	150	2.019	118.5	0.340000000000001
%4	59	299	150	2.019	118	-0.1
5	4	304	150	2.019	118.1	0.0199999999999989
5	14	314	150	2.018	118.4	0.0300000000000011
%5	15	315	400	2.02	121.6	3.19999999999999
%5	20	320	400	2.019	125.8	0.840000000000001
%5	25	325	400	2.019	127.5	0.340000000000001
%5	30	330	400	2.019	126.4	-0.219999999999999
%5	35	335	400	2.019	127.8	0.279999999999998
5	40	340	400	2.019	127.6	-0.0400000000000006
5	45	345	400	2.019	127.4	-0.0399999999999977
%5	46	346	900	2.022	129.9	2.5
%5	51	351	900	2.022	135.3	1.08
%5	56	356	900	2.022	135.9	0.119999999999999
%6	1	361	900	2.022	136.8	0.180000000000001
%6	6	366	900	2.023	137.1	0.0599999999999966
6	11	371	900	2.022	137.4	0.0600000000000023
6	16	376	900	2.023	137.3	-0.0199999999999989
%6	17	377	1900	2.029	142	4.69999999999999
%6	22	382	1900	2.029	144.5	0.5
%6	27	387	1900	2.029	144.8	0.0600000000000023
%6	32	392	1900	2.028	145.2	0.0799999999999955
%6	37	397	1900	2.028	146.3	0.220000000000005
%6	42	402	1900	2.028	146.7	0.0799999999999955
%6	47	407	1900	2.028	147.4	0.140000000000003
6	52	412	1900	2.028	147.2	-0.0400000000000034
6	58	418	1900	2.028	145.9	-0.216666666666664
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	10	-29.6	
%0	5	5	0	9.928	-26.9	0.540000000000001
%0	15	15	0	9.866	-23.2	0.37
%0	20	20	0	9.855	-23.3	-0.0200000000000003
%0	25	25	0	9.804	-19.7	0.72
%0	30	30	0	9.791	-20.4	-0.14
%0	35	35	0	9.782	-19.8	0.12
%0	40	40	0	9.755	-19.3	0.1
%50	45	45	0	9.741	-17.4	0.38
%0	55	55	0	9.746	-17.4	0
%1	0	60	0	9.729	-17.7	-0.0600000000000001
1	5	65	0	9.697	-17	0.14
1	10	70	0	9.709	-17.3	-0.0600000000000001
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=95.6; Eorig=-17.3; m=21.5; m=24.254;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 -40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -12.8893 50 0.329493 27.1984

list
string: Total Cu
 -6.94977 60 0.299539 19.9825

[I 21:05:19.712 NotebookApp] Saving file at /KNO3_pH10_0pt1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%1	17	77	0	2.009	78.1	13.6285714285714
%1	23	83	0	2.000	73.8	-0.716666666666666
%1	28	88	0	1.999	76	0.440000000000001
%1	33	93	0	1.999	77.8	0.359999999999999
%1	38	98	0	1.995	79.4	0.320000000000002
%1	43	103	0	1.996	81.8	0.479999999999998
%1	48	108	0	1.995	84	0.440000000000001
%1	53	113	0	2.005	86	0.4
%1	58	118	0	2.006	87.7	0.340000000000001
%2	3	123	0	2.008	89.8	0.419999999999999
%2	8	128	0	2.009	90.4	0.120000000000002
%2	13	133	0	2.006	91	0.119999999999999
%2	18	138	0	2.006	91.7	0.140000000000001
%2	23	143	0	2.005	92.3	0.119999999999999
%2	28	148	0	2.004	92.4	0.0200000000000017
%2	33	153	0	2.007	93.4	0.2
%2	38	158	0	2.003	93.9	0.1
%2	43	163	0	2.002	95	0.219999999999999
%2	48	168	0	2.001	95.4	0.0800000000000011
2	53	173	0	2.002	95.6	0.0399999999999977
2	58	178	0	2.001	95.6	0
%3	0	180	50	2.001	97.9	1.15000000000001
%3	5	185	50	2	102.8	0.979999999999998
%3	10	190	50	2	103.8	0.2
%3	22	202	50	1.998	105.2	0.116666666666667
%3	32	212	50	1.997	106.2	0.1
%3	37	217	50	1.996	107	0.159999999999999
%3	42	222	50	1.995	106.6	-0.0800000000000011
%3	47	227	50	1.995	107.2	0.120000000000002
%3	52	232	50	1.995	107.6	0.0799999999999983
%3	57	237	50	1.996	107.3	-0.0599999999999994
%4	2	242	50	2.021	108.5	0.240000000000001
%4	7	247	50	2.021	108.7	0.0400000000000006
4	12	252	50	2.021	108.3	-0.0800000000000011
4	17	257	50	2.021	108.8	0.1
%4	19	259	150	2.02	110	0.600000000000001
%4	24	264	150	2.021	115.7	1.14
%4	29	269	150	2.02	117	0.259999999999999
%4	34	274	150	2.02	115.5	-0.3
%4	39	279	150	2.02	116.3	0.159999999999999
%4	44	284	150	2.019	117.3	0.2
%4	49	289	150	2.019	116.8	-0.1
%4	54	294	150	2.019	118.5	0.340000000000001
%4	59	299	150	2.019	118	-0.1
5	4	304	150	2.019	118.1	0.0199999999999989
5	14	314	150	2.018	118.4	0.0300000000000011
%5	15	315	400	2.02	121.6	3.19999999999999
%5	20	320	400	2.019	125.8	0.840000000000001
%5	25	325	400	2.019	127.5	0.340000000000001
%5	30	330	400	2.019	126.4	-0.219999999999999
%5	35	335	400	2.019	127.8	0.279999999999998
5	40	340	400	2.019	127.6	-0.0400000000000006
5	45	345	400	2.019	127.4	-0.0399999999999977
%5	46	346	900	2.022	129.9	2.5
%5	51	351	900	2.022	135.3	1.08
%5	56	356	900	2.022	135.9	0.119999999999999
%6	1	361	900	2.022	136.8	0.180000000000001
%6	6	366	900	2.023	137.1	0.0599999999999966
6	11	371	900	2.022	137.4	0.0600000000000023
6	16	376	900	2.023	137.3	-0.0199999999999989
%6	17	377	1900	2.029	142	4.69999999999999
%6	22	382	1900	2.029	144.5	0.5
%6	27	387	1900	2.029	144.8	0.0600000000000023
%6	32	392	1900	2.028	145.2	0.0799999999999955
%6	37	397	1900	2.028	146.3	0.220000000000005
%6	42	402	1900	2.028	146.7	0.0799999999999955
%6	47	407	1900	2.028	147.4	0.140000000000003
6	52	412	1900	2.028	147.2	-0.0400000000000034
6	58	418	1900	2.028	145.9	-0.216666666666664
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	10	-29.6	
%0	5	5	0	9.928	-26.9	0.540000000000001
%0	15	15	0	9.866	-23.2	0.37
%0	20	20	0	9.855	-23.3	-0.0200000000000003
%0	25	25	0	9.804	-19.7	0.72
%0	30	30	0	9.791	-20.4	-0.14
%0	35	35	0	9.782	-19.8	0.12
%0	40	40	0	9.755	-19.3	0.1
%50	45	45	0	9.741	-17.4	0.38
%0	55	55	0	9.746	-17.4	0
%1	0	60	0	9.729	-17.7	-0.0600000000000001
1	5	65	0	9.697	-17	0.14
1	10	70	0	9.709	-17.3	-0.0600000000000001
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=95.6; Eorig=-17.3; m=21.5; m=24.254; m=param(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 -40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -12.8893 50 0.329493 27.1984

list
string: Total Cu
 -6.94977 60 0.299539 19.9825

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%1	17	77	0	2.009	78.1	13.6285714285714
%1	23	83	0	2.000	73.8	-0.716666666666666
%1	28	88	0	1.999	76	0.440000000000001
%1	33	93	0	1.999	77.8	0.359999999999999
%1	38	98	0	1.995	79.4	0.320000000000002
%1	43	103	0	1.996	81.8	0.479999999999998
%1	48	108	0	1.995	84	0.440000000000001
%1	53	113	0	2.005	86	0.4
%1	58	118	0	2.006	87.7	0.340000000000001
%2	3	123	0	2.008	89.8	0.419999999999999
%2	8	128	0	2.009	90.4	0.120000000000002
%2	13	133	0	2.006	91	0.119999999999999
%2	18	138	0	2.006	91.7	0.140000000000001
%2	23	143	0	2.005	92.3	0.119999999999999
%2	28	148	0	2.004	92.4	0.0200000000000017
%2	33	153	0	2.007	93.4	0.2
%2	38	158	0	2.003	93.9	0.1
%2	43	163	0	2.002	95	0.219999999999999
%2	48	168	0	2.001	95.4	0.0800000000000011
2	53	173	0	2.002	95.6	0.0399999999999977
2	58	178	0	2.001	95.6	0
%3	0	180	50	2.001	97.9	1.15000000000001
%3	5	185	50	2	102.8	0.979999999999998
%3	10	190	50	2	103.8	0.2
%3	22	202	50	1.998	105.2	0.116666666666667
%3	32	212	50	1.997	106.2	0.1
%3	37	217	50	1.996	107	0.159999999999999
%3	42	222	50	1.995	106.6	-0.0800000000000011
%3	47	227	50	1.995	107.2	0.120000000000002
%3	52	232	50	1.995	107.6	0.0799999999999983
%3	57	237	50	1.996	107.3	-0.0599999999999994
%4	2	242	50	2.021	108.5	0.240000000000001
%4	7	247	50	2.021	108.7	0.0400000000000006
4	12	252	50	2.021	108.3	-0.0800000000000011
4	17	257	50	2.021	108.8	0.1
%4	19	259	150	2.02	110	0.600000000000001
%4	24	264	150	2.021	115.7	1.14
%4	29	269	150	2.02	117	0.259999999999999
%4	34	274	150	2.02	115.5	-0.3
%4	39	279	150	2.02	116.3	0.159999999999999
%4	44	284	150	2.019	117.3	0.2
%4	49	289	150	2.019	116.8	-0.1
%4	54	294	150	2.019	118.5	0.340000000000001
%4	59	299	150	2.019	118	-0.1
5	4	304	150	2.019	118.1	0.0199999999999989
5	14	314	150	2.018	118.4	0.0300000000000011
%5	15	315	400	2.02	121.6	3.19999999999999
%5	20	320	400	2.019	125.8	0.840000000000001
%5	25	325	400	2.019	127.5	0.340000000000001
%5	30	330	400	2.019	126.4	-0.219999999999999
%5	35	335	400	2.019	127.8	0.279999999999998
5	40	340	400	2.019	127.6	-0.0400000000000006
5	45	345	400	2.019	127.4	-0.0399999999999977
%5	46	346	900	2.022	129.9	2.5
%5	51	351	900	2.022	135.3	1.08
%5	56	356	900	2.022	135.9	0.119999999999999
%6	1	361	900	2.022	136.8	0.180000000000001
%6	6	366	900	2.023	137.1	0.0599999999999966
6	11	371	900	2.022	137.4	0.0600000000000023
6	16	376	900	2.023	137.3	-0.0199999999999989
%6	17	377	1900	2.029	142	4.69999999999999
%6	22	382	1900	2.029	144.5	0.5
%6	27	387	1900	2.029	144.8	0.0600000000000023
%6	32	392	1900	2.028	145.2	0.0799999999999955
%6	37	397	1900	2.028	146.3	0.220000000000005
%6	42	402	1900	2.028	146.7	0.0799999999999955
%6	47	407	1900	2.028	147.4	0.140000000000003
6	52	412	1900	2.028	147.2	-0.0400000000000034
6	58	418	1900	2.028	145.9	-0.216666666666664
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	10	-29.6	
%0	5	5	0	9.928	-26.9	0.540000000000001
%0	15	15	0	9.866	-23.2	0.37
%0	20	20	0	9.855	-23.3	-0.0200000000000003
%0	25	25	0	9.804	-19.7	0.72
%0	30	30	0	9.791	-20.4	-0.14
%0	35	35	0	9.782	-19.8	0.12
%0	40	40	0	9.755	-19.3	0.1
%50	45	45	0	9.741	-17.4	0.38
%0	55	55	0	9.746	-17.4	0
%1	0	60	0	9.729	-17.7	-0.0600000000000001
1	5	65	0	9.697	-17	0.14
1	10	70	0	9.709	-17.3	-0.0600000000000001
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
paramlinear=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=95.6; Eorig=-17.3; m=21.5; m=24.254; m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 -40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -12.8893 50 0.329493 27.1984

list
string: Total Cu
 -6.94977 60 0.299539 19.9825

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
4	35	275	0	2.001	115.1	0.2
4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
paramlinear=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=115; Eorig=52; m=21.5;  m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

axis([-13 -3 40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.12544 50 0.253456 15.7464

list
string: Total Cu
 -6.91521 60 0.230415 11.5688

[I 21:07:19.760 NotebookApp] Saving file at /KNO3_pH10_0pt1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
4	35	275	0	2.001	115.1	0.2
4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
paramlinear=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=115; Eorig=52; m=21.5;  m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-13 -3 40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.12544 50 0.253456 15.7464

list
string: Total Cu
 -6.91521 60 0.230415 11.5688

[I 21:08:09.175 NotebookApp] Saving file at /KNO3_pH8_0pt1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%1	17	77	0	2.009	78.1	13.6285714285714
%1	23	83	0	2.000	73.8	-0.716666666666666
%1	28	88	0	1.999	76	0.440000000000001
%1	33	93	0	1.999	77.8	0.359999999999999
%1	38	98	0	1.995	79.4	0.320000000000002
%1	43	103	0	1.996	81.8	0.479999999999998
%1	48	108	0	1.995	84	0.440000000000001
%1	53	113	0	2.005	86	0.4
%1	58	118	0	2.006	87.7	0.340000000000001
%2	3	123	0	2.008	89.8	0.419999999999999
%2	8	128	0	2.009	90.4	0.120000000000002
%2	13	133	0	2.006	91	0.119999999999999
%2	18	138	0	2.006	91.7	0.140000000000001
%2	23	143	0	2.005	92.3	0.119999999999999
%2	28	148	0	2.004	92.4	0.0200000000000017
%2	33	153	0	2.007	93.4	0.2
%2	38	158	0	2.003	93.9	0.1
%2	43	163	0	2.002	95	0.219999999999999
%2	48	168	0	2.001	95.4	0.0800000000000011
2	53	173	0	2.002	95.6	0.0399999999999977
2	58	178	0	2.001	95.6	0
%3	0	180	50	2.001	97.9	1.15000000000001
%3	5	185	50	2	102.8	0.979999999999998
%3	10	190	50	2	103.8	0.2
%3	22	202	50	1.998	105.2	0.116666666666667
%3	32	212	50	1.997	106.2	0.1
%3	37	217	50	1.996	107	0.159999999999999
%3	42	222	50	1.995	106.6	-0.0800000000000011
%3	47	227	50	1.995	107.2	0.120000000000002
%3	52	232	50	1.995	107.6	0.0799999999999983
%3	57	237	50	1.996	107.3	-0.0599999999999994
%4	2	242	50	2.021	108.5	0.240000000000001
%4	7	247	50	2.021	108.7	0.0400000000000006
4	12	252	50	2.021	108.3	-0.0800000000000011
4	17	257	50	2.021	108.8	0.1
%4	19	259	150	2.02	110	0.600000000000001
%4	24	264	150	2.021	115.7	1.14
%4	29	269	150	2.02	117	0.259999999999999
%4	34	274	150	2.02	115.5	-0.3
%4	39	279	150	2.02	116.3	0.159999999999999
%4	44	284	150	2.019	117.3	0.2
%4	49	289	150	2.019	116.8	-0.1
%4	54	294	150	2.019	118.5	0.340000000000001
%4	59	299	150	2.019	118	-0.1
5	4	304	150	2.019	118.1	0.0199999999999989
5	14	314	150	2.018	118.4	0.0300000000000011
%5	15	315	400	2.02	121.6	3.19999999999999
%5	20	320	400	2.019	125.8	0.840000000000001
%5	25	325	400	2.019	127.5	0.340000000000001
%5	30	330	400	2.019	126.4	-0.219999999999999
%5	35	335	400	2.019	127.8	0.279999999999998
5	40	340	400	2.019	127.6	-0.0400000000000006
5	45	345	400	2.019	127.4	-0.0399999999999977
%5	46	346	900	2.022	129.9	2.5
%5	51	351	900	2.022	135.3	1.08
%5	56	356	900	2.022	135.9	0.119999999999999
%6	1	361	900	2.022	136.8	0.180000000000001
%6	6	366	900	2.023	137.1	0.0599999999999966
6	11	371	900	2.022	137.4	0.0600000000000023
6	16	376	900	2.023	137.3	-0.0199999999999989
%6	17	377	1900	2.029	142	4.69999999999999
%6	22	382	1900	2.029	144.5	0.5
%6	27	387	1900	2.029	144.8	0.0600000000000023
%6	32	392	1900	2.028	145.2	0.0799999999999955
%6	37	397	1900	2.028	146.3	0.220000000000005
%6	42	402	1900	2.028	146.7	0.0799999999999955
%6	47	407	1900	2.028	147.4	0.140000000000003
6	52	412	1900	2.028	147.2	-0.0400000000000034
6	58	418	1900	2.028	145.9	-0.216666666666664
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	10	-29.6	
%0	5	5	0	9.928	-26.9	0.540000000000001
%0	15	15	0	9.866	-23.2	0.37
%0	20	20	0	9.855	-23.3	-0.0200000000000003
%0	25	25	0	9.804	-19.7	0.72
%0	30	30	0	9.791	-20.4	-0.14
%0	35	35	0	9.782	-19.8	0.12
%0	40	40	0	9.755	-19.3	0.1
%50	45	45	0	9.741	-17.4	0.38
%0	55	55	0	9.746	-17.4	0
%1	0	60	0	9.729	-17.7	-0.0600000000000001
1	5	65	0	9.697	-17	0.14
1	10	70	0	9.709	-17.3	-0.0600000000000001
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
paramlinear=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=95.6; Eorig=-17.3; m=21.5; m=24.254; m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 -40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -12.8893 50 0.329493 27.1984

list
string: Total Cu
 -6.94977 60 0.299539 19.9825

Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.16346 50 0.329493 15.7464

list
string: Total Cu
 -6.94977 60 0.299539 11.5688

[I 21:09:19.799 NotebookApp] Saving file at /KNO3_pH10_0pt1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
4	35	275	0	2.001	115.1	0.2
4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
paramlinear=polyfit(log10(CuTplus(4:end)),Emeas(4:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=115; Eorig=52; m=21.5;  m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.16346 50 0.329493 15.7464

list
string: Total Cu
 -6.94977 60 0.299539 11.5688

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
4	35	275	0	2.001	115.1	0.2
4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
paramlinear=polyfit(log10(CuTplus(4:end)),Emeas(4:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=115; Eorig=52; m=21.5;  m=paramlinear(1); m=24.25;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.16346 50 0.329493 15.7464

list
string: Total Cu
 -6.94977 60 0.299539 11.5688

[I 21:10:09.224 NotebookApp] Saving file at /KNO3_pH8_0pt1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
4	35	275	0	2.001	115.1	0.2
4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
paramlinear=polyfit(log10(CuTplus(4:end)),Emeas(4:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=115; Eorig=52; m=21.5;  
%m=paramlinear(1); m=24.25;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.16346 50 0.329493 15.7464

list
string: Total Cu
 -6.94977 60 0.299539 11.5688

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
4	35	275	0	2.001	115.1	0.2
4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
paramlinear=polyfit(log10(CuTplus(4:end)),Emeas(4:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=115; Eorig=52; m=21.5; %m=paramlinear(1); m=24.25;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.16346 50 0.329493 15.7464

list
string: Total Cu
 -6.94977 60 0.299539 11.5688

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
4	35	275	0	2.001	115.1	0.2
4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
paramlinear=polyfit(log10(CuTplus(4:end)),Emeas(4:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=115; Eorig=52; m=21.5; m=paramlinear(1); m=24.25;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.16346 50 0.329493 15.7464

list
string: Total Cu
 -6.94977 60 0.299539 11.5688

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
4	35	275	0	2.001	115.1	0.2
4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(4:end)),Emeas(4:end),1)
paramlinear=polyfit(log10(CuTplus(4:end)),Emeas(4:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=115; Eorig=52; m=21.5; m=paramlinear(1); m=24.25;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.16346 50 0.329493 15.7464

list
string: Total Cu
 -6.94977 60 0.299539 11.5688

[I 21:12:09.267 NotebookApp] Saving file at /KNO3_pH8_0pt1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	"cumulative vol added"	pH	mvA	delta
% 1	30	90	0	2.029	73.3	9.97
% 1	35	95	0	2.023	73.4	0.02
% 1	40	100	0	2.022	76.8	0.68
% 1	45	105	0	2.002	77.8	0.2
% 1	55	115	0	2.004	74.9	-0.29
% 2	5	125	0	2.002	74.5	-0.04
%2	10	130	0	2.002	74.6	0.02
2	15	135	0	2.002	74.8	0.04
2	17	137	0	2.002	79.3	2.25
% 2	22	142	50	2.002	90	2.14
% 2	27	147	50	2.001	93.5	0.7
% 2	32	152	50	2.002	96.3	0.56
% 2	37	157	50	2.001	95.8	-0.1
%2	42	162	50	2.002	91.4	-0.88
%2	47	167	50	2	91	-0.08
%2	52	172	50	2.001	90.6	-0.08
% 2	57	177	150	2.000	90.6	0
% 2	58	178	150	2.001	94.4	3.8
% 3	3	183	150	2.002	100	1.12
% 3	8	188	150	2	101.3	0.26
% 3	13	193	150	2.001	107.5	1.24
% 3	18	198	150	2	108.7	0.24
% 3	23	203	150	2.002	108.6	-0.02
%3	28	208	150	2.001	109	0.08
%3	33	213	150	2	108.8	-0.04
3	38	218	150	2.001	108.4	-0.08
% 3	43	223	400	1.999	108.4	0
% 3	44	224	400	2.001	114.1	5.7
% 3	49	229	400	2.003	118.4	0.86
% 3	54	234	400	2.001	118.2	-0.04
%3	59	239	400	2.002	118	-0.04
4	4	244	400	2.002	118.4	0.08
% 4	5	245	900	2.005	122.1	3.7
% 4	10	250	900	2.005	126.6	0.9
% 4	15	255	900	2.005	128	0.28
%4	20	260	900	2.005	128.5	0.1
%4	25	265	900	2.006	128.2	-0.06
4	30	270	900	2.004	127.8	-0.08
% 4	31	271	1900	2.011	133	5.2
% 4	36	276	1900	2.012	136.5	0.7
% 4	41	281	1900	2.011	137.2	0.14
% 4	46	286	1900	2.011	137.4	0.04
%4	51	291	1900	2.01	136.8	-0.12
4	56	296	1900	2.011	137.2	0.08
% 5	1	301	3400	2.011	136.8	-0.08
% 5	3	303	3400	2.02	142.5	2.85
% 5	8	308	3400	2.022	143.2	0.14
% 5	13	313	3400	2.021	143.4	0.04
% 5	18	318	3400	2.022	143.1	-0.06
% 5	23	323	3400	2.021	142	-0.22
% 5	28	328	3400	2.021	142.4	0.08
% 5	33	333	3400	2.021	142	-0.08
%5	38	338	3400	2.019	141.1	-0.18
5	43	343	3400	2.019	142.2	0.22
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative vol added	pH	mvA	delta	mVB	deltaB	comments
% 0	0	0	0	9.625	60.9	
% 0	5	5	0	9.657	47.3	-2.72
% 0	15	15	0	9.574	-34.7	-8.2
% 0	20	20	0	9.643	-33	0.34
% 0	25	25	0	9.256	-19	2.8
% 0	30	30	0	9.54	-29.6	-2.12
% 0	35	35	0	9.537	-28.8	0.16
% 0	40	40	0	9.54	-28.4	0.08
% 0	45	45	0	9.532	-27	0.28
% 0	50	50	0	9.527	-27.6	-0.12
% 0	55	55	0	9.517	-27.7	-0.02
% 1	0	60	0	9.512	-27.7	0
% 1	5	65	0	9.502	-26.2	0.3
%1	10	70	0	9.501	-26.3	-0.02
%1	15	75	0	9.486	-26.5	-0.04
1	20	80	0	9.482	-26.4	0.02
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-6; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus),Emeas,1)
paramlinear=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=79.3; Eorig=-26.4; m=21.5; m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'r--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuwithCuOs) log10(CuwithCuOs)],[-100 150],'g--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -11.0185 50 0.253456 35.7873

list
string: Total Cu
 -5.91521 40 0.230415 26.2927

[I 21:13:18.880 NotebookApp] Saving file at /KNO3_pH9pt5_1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	"cumulative vol added"	pH	mvA	delta
% 1	30	90	0	2.029	73.3	9.97
% 1	35	95	0	2.023	73.4	0.02
% 1	40	100	0	2.022	76.8	0.68
% 1	45	105	0	2.002	77.8	0.2
% 1	55	115	0	2.004	74.9	-0.29
% 2	5	125	0	2.002	74.5	-0.04
%2	10	130	0	2.002	74.6	0.02
2	15	135	0	2.002	74.8	0.04
2	17	137	0	2.002	79.3	2.25
% 2	22	142	50	2.002	90	2.14
% 2	27	147	50	2.001	93.5	0.7
% 2	32	152	50	2.002	96.3	0.56
% 2	37	157	50	2.001	95.8	-0.1
%2	42	162	50	2.002	91.4	-0.88
2	47	167	50	2	91	-0.08
2	52	172	50	2.001	90.6	-0.08
% 2	57	177	150	2.000	90.6	0
% 2	58	178	150	2.001	94.4	3.8
% 3	3	183	150	2.002	100	1.12
% 3	8	188	150	2	101.3	0.26
% 3	13	193	150	2.001	107.5	1.24
% 3	18	198	150	2	108.7	0.24
% 3	23	203	150	2.002	108.6	-0.02
%3	28	208	150	2.001	109	0.08
%3	33	213	150	2	108.8	-0.04
3	38	218	150	2.001	108.4	-0.08
% 3	43	223	400	1.999	108.4	0
% 3	44	224	400	2.001	114.1	5.7
% 3	49	229	400	2.003	118.4	0.86
% 3	54	234	400	2.001	118.2	-0.04
%3	59	239	400	2.002	118	-0.04
4	4	244	400	2.002	118.4	0.08
% 4	5	245	900	2.005	122.1	3.7
% 4	10	250	900	2.005	126.6	0.9
% 4	15	255	900	2.005	128	0.28
%4	20	260	900	2.005	128.5	0.1
%4	25	265	900	2.006	128.2	-0.06
4	30	270	900	2.004	127.8	-0.08
% 4	31	271	1900	2.011	133	5.2
% 4	36	276	1900	2.012	136.5	0.7
% 4	41	281	1900	2.011	137.2	0.14
% 4	46	286	1900	2.011	137.4	0.04
%4	51	291	1900	2.01	136.8	-0.12
4	56	296	1900	2.011	137.2	0.08
% 5	1	301	3400	2.011	136.8	-0.08
% 5	3	303	3400	2.02	142.5	2.85
% 5	8	308	3400	2.022	143.2	0.14
% 5	13	313	3400	2.021	143.4	0.04
% 5	18	318	3400	2.022	143.1	-0.06
% 5	23	323	3400	2.021	142	-0.22
% 5	28	328	3400	2.021	142.4	0.08
% 5	33	333	3400	2.021	142	-0.08
%5	38	338	3400	2.019	141.1	-0.18
5	43	343	3400	2.019	142.2	0.22
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative vol added	pH	mvA	delta	mVB	deltaB	comments
% 0	0	0	0	9.625	60.9	
% 0	5	5	0	9.657	47.3	-2.72
% 0	15	15	0	9.574	-34.7	-8.2
% 0	20	20	0	9.643	-33	0.34
% 0	25	25	0	9.256	-19	2.8
% 0	30	30	0	9.54	-29.6	-2.12
% 0	35	35	0	9.537	-28.8	0.16
% 0	40	40	0	9.54	-28.4	0.08
% 0	45	45	0	9.532	-27	0.28
% 0	50	50	0	9.527	-27.6	-0.12
% 0	55	55	0	9.517	-27.7	-0.02
% 1	0	60	0	9.512	-27.7	0
% 1	5	65	0	9.502	-26.2	0.3
%1	10	70	0	9.501	-26.3	-0.02
%1	15	75	0	9.486	-26.5	-0.04
1	20	80	0	9.482	-26.4	0.02
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-6; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus),Emeas,1)
paramlinear=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=79.3; Eorig=-26.4; m=21.5; m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'r--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuwithCuOs) log10(CuwithCuOs)],[-100 150],'g--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -11.0185 50 0.253456 35.7873

list
string: Total Cu
 -5.91521 40 0.230415 26.2927

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	"cumulative vol added"	pH	mvA	delta
% 1	30	90	0	2.029	73.3	9.97
% 1	35	95	0	2.023	73.4	0.02
% 1	40	100	0	2.022	76.8	0.68
% 1	45	105	0	2.002	77.8	0.2
% 1	55	115	0	2.004	74.9	-0.29
% 2	5	125	0	2.002	74.5	-0.04
%2	10	130	0	2.002	74.6	0.02
2	15	135	0	2.002	74.8	0.04
2	17	137	0	2.002	79.3	2.25
% 2	22	142	50	2.002	90	2.14
% 2	27	147	50	2.001	93.5	0.7
% 2	32	152	50	2.002	96.3	0.56
% 2	37	157	50	2.001	95.8	-0.1
%2	42	162	50	2.002	91.4	-0.88
2	47	167	50	2	91	-0.08
2	52	172	50	2.001	90.6	-0.08
% 2	57	177	150	2.000	90.6	0
% 2	58	178	150	2.001	94.4	3.8
% 3	3	183	150	2.002	100	1.12
% 3	8	188	150	2	101.3	0.26
% 3	13	193	150	2.001	107.5	1.24
% 3	18	198	150	2	108.7	0.24
% 3	23	203	150	2.002	108.6	-0.02
%3	28	208	150	2.001	109	0.08
%3	33	213	150	2	108.8	-0.04
3	38	218	150	2.001	108.4	-0.08
% 3	43	223	400	1.999	108.4	0
% 3	44	224	400	2.001	114.1	5.7
% 3	49	229	400	2.003	118.4	0.86
% 3	54	234	400	2.001	118.2	-0.04
%3	59	239	400	2.002	118	-0.04
4	4	244	400	2.002	118.4	0.08
% 4	5	245	900	2.005	122.1	3.7
% 4	10	250	900	2.005	126.6	0.9
% 4	15	255	900	2.005	128	0.28
%4	20	260	900	2.005	128.5	0.1
%4	25	265	900	2.006	128.2	-0.06
4	30	270	900	2.004	127.8	-0.08
% 4	31	271	1900	2.011	133	5.2
% 4	36	276	1900	2.012	136.5	0.7
% 4	41	281	1900	2.011	137.2	0.14
% 4	46	286	1900	2.011	137.4	0.04
%4	51	291	1900	2.01	136.8	-0.12
4	56	296	1900	2.011	137.2	0.08
% 5	1	301	3400	2.011	136.8	-0.08
% 5	3	303	3400	2.02	142.5	2.85
% 5	8	308	3400	2.022	143.2	0.14
% 5	13	313	3400	2.021	143.4	0.04
% 5	18	318	3400	2.022	143.1	-0.06
% 5	23	323	3400	2.021	142	-0.22
% 5	28	328	3400	2.021	142.4	0.08
% 5	33	333	3400	2.021	142	-0.08
%5	38	338	3400	2.019	141.1	-0.18
5	43	343	3400	2.019	142.2	0.22
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative vol added	pH	mvA	delta	mVB	deltaB	comments
% 0	0	0	0	9.625	60.9	
% 0	5	5	0	9.657	47.3	-2.72
% 0	15	15	0	9.574	-34.7	-8.2
% 0	20	20	0	9.643	-33	0.34
% 0	25	25	0	9.256	-19	2.8
% 0	30	30	0	9.54	-29.6	-2.12
% 0	35	35	0	9.537	-28.8	0.16
% 0	40	40	0	9.54	-28.4	0.08
% 0	45	45	0	9.532	-27	0.28
% 0	50	50	0	9.527	-27.6	-0.12
% 0	55	55	0	9.517	-27.7	-0.02
% 1	0	60	0	9.512	-27.7	0
% 1	5	65	0	9.502	-26.2	0.3
%1	10	70	0	9.501	-26.3	-0.02
%1	15	75	0	9.486	-26.5	-0.04
1	20	80	0	9.482	-26.4	0.02
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-6; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus),Emeas,1)
paramlinear=polyfit(log10(CuTplus(5:end)),Emeas(5:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=79.3; Eorig=-26.4; m=21.5; m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'r--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuwithCuOs) log10(CuwithCuOs)],[-100 150],'g--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -11.0185 50 0.253456 35.7873

list
string: Total Cu
 -5.91521 40 0.230415 26.2927

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	"cumulative vol added"	pH	mvA	delta
% 1	30	90	0	2.029	73.3	9.97
% 1	35	95	0	2.023	73.4	0.02
% 1	40	100	0	2.022	76.8	0.68
% 1	45	105	0	2.002	77.8	0.2
% 1	55	115	0	2.004	74.9	-0.29
% 2	5	125	0	2.002	74.5	-0.04
%2	10	130	0	2.002	74.6	0.02
2	15	135	0	2.002	74.8	0.04
2	17	137	0	2.002	79.3	2.25
% 2	22	142	50	2.002	90	2.14
% 2	27	147	50	2.001	93.5	0.7
% 2	32	152	50	2.002	96.3	0.56
% 2	37	157	50	2.001	95.8	-0.1
%2	42	162	50	2.002	91.4	-0.88
2	47	167	50	2	91	-0.08
2	52	172	50	2.001	90.6	-0.08
% 2	57	177	150	2.000	90.6	0
% 2	58	178	150	2.001	94.4	3.8
% 3	3	183	150	2.002	100	1.12
% 3	8	188	150	2	101.3	0.26
% 3	13	193	150	2.001	107.5	1.24
% 3	18	198	150	2	108.7	0.24
% 3	23	203	150	2.002	108.6	-0.02
%3	28	208	150	2.001	109	0.08
%3	33	213	150	2	108.8	-0.04
3	38	218	150	2.001	108.4	-0.08
% 3	43	223	400	1.999	108.4	0
% 3	44	224	400	2.001	114.1	5.7
% 3	49	229	400	2.003	118.4	0.86
% 3	54	234	400	2.001	118.2	-0.04
%3	59	239	400	2.002	118	-0.04
4	4	244	400	2.002	118.4	0.08
% 4	5	245	900	2.005	122.1	3.7
% 4	10	250	900	2.005	126.6	0.9
% 4	15	255	900	2.005	128	0.28
%4	20	260	900	2.005	128.5	0.1
%4	25	265	900	2.006	128.2	-0.06
4	30	270	900	2.004	127.8	-0.08
% 4	31	271	1900	2.011	133	5.2
% 4	36	276	1900	2.012	136.5	0.7
% 4	41	281	1900	2.011	137.2	0.14
% 4	46	286	1900	2.011	137.4	0.04
%4	51	291	1900	2.01	136.8	-0.12
4	56	296	1900	2.011	137.2	0.08
% 5	1	301	3400	2.011	136.8	-0.08
% 5	3	303	3400	2.02	142.5	2.85
% 5	8	308	3400	2.022	143.2	0.14
% 5	13	313	3400	2.021	143.4	0.04
% 5	18	318	3400	2.022	143.1	-0.06
% 5	23	323	3400	2.021	142	-0.22
% 5	28	328	3400	2.021	142.4	0.08
% 5	33	333	3400	2.021	142	-0.08
%5	38	338	3400	2.019	141.1	-0.18
5	43	343	3400	2.019	142.2	0.22
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative vol added	pH	mvA	delta	mVB	deltaB	comments
% 0	0	0	0	9.625	60.9	
% 0	5	5	0	9.657	47.3	-2.72
% 0	15	15	0	9.574	-34.7	-8.2
% 0	20	20	0	9.643	-33	0.34
% 0	25	25	0	9.256	-19	2.8
% 0	30	30	0	9.54	-29.6	-2.12
% 0	35	35	0	9.537	-28.8	0.16
% 0	40	40	0	9.54	-28.4	0.08
% 0	45	45	0	9.532	-27	0.28
% 0	50	50	0	9.527	-27.6	-0.12
% 0	55	55	0	9.517	-27.7	-0.02
% 1	0	60	0	9.512	-27.7	0
% 1	5	65	0	9.502	-26.2	0.3
%1	10	70	0	9.501	-26.3	-0.02
%1	15	75	0	9.486	-26.5	-0.04
1	20	80	0	9.482	-26.4	0.02
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-6; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus),Emeas,1)
paramlinear=polyfit(log10(CuTplus(5:end)),Emeas(5:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=79.3; Eorig=-26.4; m=21.5; m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'r--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuwithCuOs) log10(CuwithCuOs)],[-100 150],'g--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -11.0185 50 0.253456 35.7873

list
string: Total Cu
 -5.91521 40 0.230415 26.2927

[I 21:15:18.923 NotebookApp] Saving file at /KNO3_pH9pt5_1uMCuT.ipynb
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'r--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'m--'); hold on
plot([log10(CuwithCuOs) log10(CuwithCuOs)],[-100 150],'g--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -11.0185 50 0.253456 35.7873

list
string: Total Cu
 -5.91521 40 0.230415 26.2927

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
4	35	275	0	2.001	115.1	0.2
4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(4:end)),Emeas(4:end),1)
paramlinear=polyfit(log10(CuTplus(4:end)),Emeas(4:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=115; Eorig=52; m=21.5; m=paramlinear(1); m=24.25;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.16346 50 0.329493 15.7464

list
string: Total Cu
 -6.94977 60 0.299539 11.5688

[I 21:17:18.968 NotebookApp] Saving file at /KNO3_pH9pt5_1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
4	35	275	0	2.001	115.1	0.2
4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
paramlinear=polyfit(log10(CuTplus(4:end)),Emeas(4:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=115; Eorig=52; m=21.5; m=paramlinear(1); m=24.25;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.16346 50 0.329493 15.7464

list
string: Total Cu
 -6.94977 60 0.299539 11.5688

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
4	35	275	0	2.001	115.1	0.2
4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
paramlinear=polyfit(log10(CuTplus(4:end)),Emeas(4:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=115; Eorig=52; m=21.5; m=paramlinear(1); %m=24.25;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.16346 50 0.329493 15.7464

list
string: Total Cu
 -6.94977 60 0.299539 11.5688

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
4	35	275	0	2.001	115.1	0.2
4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-6; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
paramlinear=polyfit(log10(CuTplus(4:end)),Emeas(4:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=115; Eorig=52; m=21.5; m=paramlinear(1); %m=24.25;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -7.16346 50 0.329493 15.7464

list
string: Total Cu
 -5.94977 60 0.299539 11.5688

[I 21:18:09.315 NotebookApp] Saving file at /KNO3_pH8_0pt1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
4	35	275	0	2.001	115.1	0.2
4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
paramlinear=polyfit(log10(CuTplus(4:end)),Emeas(4:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=115; Eorig=52; m=21.5; m=paramlinear(1); %m=24.25;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cuall)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.16346 50 0.329493 15.7464

list
string: Total Cu
 -6.94977 60 0.299539 11.5688

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
4	35	275	0	2.001	115.1	0.2
4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
paramlinear=polyfit(log10(CuTplus(4:end)),Emeas(4:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=115; Eorig=52; m=21.5; m=paramlinear(1); m=24.25;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cuall)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.16346 50 0.329493 15.7464

list
string: Total Cu
 -6.94977 60 0.299539 11.5688

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
4	35	275	0	2.001	115.1	0.2
4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
paramlinear=polyfit(log10(CuTplus(4:end)),Emeas(4:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=115; Eorig=52; m=21.5; m=paramlinear(1); m=24.25;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.16346 50 0.329493 15.7464

list
string: Total Cu
 -6.94977 60 0.299539 11.5688

[I 21:20:09.356 NotebookApp] Saving file at /KNO3_pH8_0pt1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	"cumulative vol added"	pH	mvA	delta
% 1	30	90	0	2.029	73.3	9.97
% 1	35	95	0	2.023	73.4	0.02
% 1	40	100	0	2.022	76.8	0.68
% 1	45	105	0	2.002	77.8	0.2
% 1	55	115	0	2.004	74.9	-0.29
% 2	5	125	0	2.002	74.5	-0.04
%2	10	130	0	2.002	74.6	0.02
2	15	135	0	2.002	74.8	0.04
2	17	137	0	2.002	79.3	2.25
% 2	22	142	50	2.002	90	2.14
% 2	27	147	50	2.001	93.5	0.7
% 2	32	152	50	2.002	96.3	0.56
% 2	37	157	50	2.001	95.8	-0.1
%2	42	162	50	2.002	91.4	-0.88
2	47	167	50	2	91	-0.08
2	52	172	50	2.001	90.6	-0.08
% 2	57	177	150	2.000	90.6	0
% 2	58	178	150	2.001	94.4	3.8
% 3	3	183	150	2.002	100	1.12
% 3	8	188	150	2	101.3	0.26
% 3	13	193	150	2.001	107.5	1.24
% 3	18	198	150	2	108.7	0.24
% 3	23	203	150	2.002	108.6	-0.02
%3	28	208	150	2.001	109	0.08
%3	33	213	150	2	108.8	-0.04
3	38	218	150	2.001	108.4	-0.08
% 3	43	223	400	1.999	108.4	0
% 3	44	224	400	2.001	114.1	5.7
% 3	49	229	400	2.003	118.4	0.86
% 3	54	234	400	2.001	118.2	-0.04
%3	59	239	400	2.002	118	-0.04
4	4	244	400	2.002	118.4	0.08
% 4	5	245	900	2.005	122.1	3.7
% 4	10	250	900	2.005	126.6	0.9
% 4	15	255	900	2.005	128	0.28
%4	20	260	900	2.005	128.5	0.1
%4	25	265	900	2.006	128.2	-0.06
4	30	270	900	2.004	127.8	-0.08
% 4	31	271	1900	2.011	133	5.2
% 4	36	276	1900	2.012	136.5	0.7
% 4	41	281	1900	2.011	137.2	0.14
% 4	46	286	1900	2.011	137.4	0.04
%4	51	291	1900	2.01	136.8	-0.12
4	56	296	1900	2.011	137.2	0.08
% 5	1	301	3400	2.011	136.8	-0.08
% 5	3	303	3400	2.02	142.5	2.85
% 5	8	308	3400	2.022	143.2	0.14
% 5	13	313	3400	2.021	143.4	0.04
% 5	18	318	3400	2.022	143.1	-0.06
% 5	23	323	3400	2.021	142	-0.22
% 5	28	328	3400	2.021	142.4	0.08
% 5	33	333	3400	2.021	142	-0.08
%5	38	338	3400	2.019	141.1	-0.18
5	43	343	3400	2.019	142.2	0.22
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative vol added	pH	mvA	delta	mVB	deltaB	comments
% 0	0	0	0	9.625	60.9	
% 0	5	5	0	9.657	47.3	-2.72
% 0	15	15	0	9.574	-34.7	-8.2
% 0	20	20	0	9.643	-33	0.34
% 0	25	25	0	9.256	-19	2.8
% 0	30	30	0	9.54	-29.6	-2.12
% 0	35	35	0	9.537	-28.8	0.16
% 0	40	40	0	9.54	-28.4	0.08
% 0	45	45	0	9.532	-27	0.28
% 0	50	50	0	9.527	-27.6	-0.12
% 0	55	55	0	9.517	-27.7	-0.02
% 1	0	60	0	9.512	-27.7	0
% 1	5	65	0	9.502	-26.2	0.3
%1	10	70	0	9.501	-26.3	-0.02
%1	15	75	0	9.486	-26.5	-0.04
1	20	80	0	9.482	-26.4	0.02
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-6; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus),Emeas,1)
paramlinear=polyfit(log10(CuTplus(5:end)),Emeas(5:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=79.3; Eorig=-26.4; m=21.5; m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'r--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'m--'); hold on
plot([log10(CuwithCuOs) log10(CuwithCuOs)],[-100 150],'g--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -11.0185 50 0.253456 35.7873

list
string: Total Cu
 -5.91521 40 0.230415 26.2927

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%1	17	77	0	2.009	78.1	13.6285714285714
%1	23	83	0	2.000	73.8	-0.716666666666666
%1	28	88	0	1.999	76	0.440000000000001
%1	33	93	0	1.999	77.8	0.359999999999999
%1	38	98	0	1.995	79.4	0.320000000000002
%1	43	103	0	1.996	81.8	0.479999999999998
%1	48	108	0	1.995	84	0.440000000000001
%1	53	113	0	2.005	86	0.4
%1	58	118	0	2.006	87.7	0.340000000000001
%2	3	123	0	2.008	89.8	0.419999999999999
%2	8	128	0	2.009	90.4	0.120000000000002
%2	13	133	0	2.006	91	0.119999999999999
%2	18	138	0	2.006	91.7	0.140000000000001
%2	23	143	0	2.005	92.3	0.119999999999999
%2	28	148	0	2.004	92.4	0.0200000000000017
%2	33	153	0	2.007	93.4	0.2
%2	38	158	0	2.003	93.9	0.1
%2	43	163	0	2.002	95	0.219999999999999
%2	48	168	0	2.001	95.4	0.0800000000000011
2	53	173	0	2.002	95.6	0.0399999999999977
2	58	178	0	2.001	95.6	0
%3	0	180	50	2.001	97.9	1.15000000000001
%3	5	185	50	2	102.8	0.979999999999998
%3	10	190	50	2	103.8	0.2
%3	22	202	50	1.998	105.2	0.116666666666667
%3	32	212	50	1.997	106.2	0.1
%3	37	217	50	1.996	107	0.159999999999999
%3	42	222	50	1.995	106.6	-0.0800000000000011
%3	47	227	50	1.995	107.2	0.120000000000002
%3	52	232	50	1.995	107.6	0.0799999999999983
%3	57	237	50	1.996	107.3	-0.0599999999999994
%4	2	242	50	2.021	108.5	0.240000000000001
%4	7	247	50	2.021	108.7	0.0400000000000006
4	12	252	50	2.021	108.3	-0.0800000000000011
4	17	257	50	2.021	108.8	0.1
%4	19	259	150	2.02	110	0.600000000000001
%4	24	264	150	2.021	115.7	1.14
%4	29	269	150	2.02	117	0.259999999999999
%4	34	274	150	2.02	115.5	-0.3
%4	39	279	150	2.02	116.3	0.159999999999999
%4	44	284	150	2.019	117.3	0.2
%4	49	289	150	2.019	116.8	-0.1
%4	54	294	150	2.019	118.5	0.340000000000001
%4	59	299	150	2.019	118	-0.1
5	4	304	150	2.019	118.1	0.0199999999999989
5	14	314	150	2.018	118.4	0.0300000000000011
%5	15	315	400	2.02	121.6	3.19999999999999
%5	20	320	400	2.019	125.8	0.840000000000001
%5	25	325	400	2.019	127.5	0.340000000000001
%5	30	330	400	2.019	126.4	-0.219999999999999
%5	35	335	400	2.019	127.8	0.279999999999998
5	40	340	400	2.019	127.6	-0.0400000000000006
5	45	345	400	2.019	127.4	-0.0399999999999977
%5	46	346	900	2.022	129.9	2.5
%5	51	351	900	2.022	135.3	1.08
%5	56	356	900	2.022	135.9	0.119999999999999
%6	1	361	900	2.022	136.8	0.180000000000001
%6	6	366	900	2.023	137.1	0.0599999999999966
6	11	371	900	2.022	137.4	0.0600000000000023
6	16	376	900	2.023	137.3	-0.0199999999999989
%6	17	377	1900	2.029	142	4.69999999999999
%6	22	382	1900	2.029	144.5	0.5
%6	27	387	1900	2.029	144.8	0.0600000000000023
%6	32	392	1900	2.028	145.2	0.0799999999999955
%6	37	397	1900	2.028	146.3	0.220000000000005
%6	42	402	1900	2.028	146.7	0.0799999999999955
%6	47	407	1900	2.028	147.4	0.140000000000003
6	52	412	1900	2.028	147.2	-0.0400000000000034
6	58	418	1900	2.028	145.9	-0.216666666666664
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	10	-29.6	
%0	5	5	0	9.928	-26.9	0.540000000000001
%0	15	15	0	9.866	-23.2	0.37
%0	20	20	0	9.855	-23.3	-0.0200000000000003
%0	25	25	0	9.804	-19.7	0.72
%0	30	30	0	9.791	-20.4	-0.14
%0	35	35	0	9.782	-19.8	0.12
%0	40	40	0	9.755	-19.3	0.1
%50	45	45	0	9.741	-17.4	0.38
%0	55	55	0	9.746	-17.4	0
%1	0	60	0	9.729	-17.7	-0.0600000000000001
1	5	65	0	9.697	-17	0.14
1	10	70	0	9.709	-17.3	-0.0600000000000001
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
paramlinear=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=95.6; Eorig=-17.3; m=21.5; m=24.254; m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 -40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -12.8893 50 0.329493 27.1984

list
string: Total Cu
 -6.94977 60 0.299539 19.9825

[I 21:35:44.970 NotebookApp] Saving file at /KNO3_pH10_0pt1uMCuT.ipynb
[I 21:35:44.999 NotebookApp] Saving file at /KNO3_pH9pt5_1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
4	35	275	0	2.001	115.1	0.2
4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
paramlinear=polyfit(log10(CuTplus(4:end)),Emeas(4:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=115; Eorig=52; m=21.5; m=paramlinear(1); m=24.25;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.16346 50 0.329493 15.7464

list
string: Total Cu
 -6.94977 60 0.299539 11.5688

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
4	35	275	0	2.001	115.1	0.2
4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
paramlinear=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=115; Eorig=52; m=21.5; m=paramlinear(1); m=24.25;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.16346 50 0.329493 15.7464

list
string: Total Cu
 -6.94977 60 0.299539 11.5688

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
4	35	275	0	2.001	115.1	0.2
4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
paramlinear=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=115; Eorig=52; m=21.5; m=paramlinear(1); %m=24.25;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.16346 50 0.329493 15.7464

list
string: Total Cu
 -6.94977 60 0.299539 11.5688

[I 21:38:09.969 NotebookApp] Saving file at /KNO3_pH8_0pt1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	"cumulative vol added"	pH	mvA	delta
% 1	30	90	0	2.029	73.3	9.97
% 1	35	95	0	2.023	73.4	0.02
% 1	40	100	0	2.022	76.8	0.68
% 1	45	105	0	2.002	77.8	0.2
% 1	55	115	0	2.004	74.9	-0.29
% 2	5	125	0	2.002	74.5	-0.04
%2	10	130	0	2.002	74.6	0.02
2	15	135	0	2.002	74.8	0.04
2	17	137	0	2.002	79.3	2.25
% 2	22	142	50	2.002	90	2.14
% 2	27	147	50	2.001	93.5	0.7
% 2	32	152	50	2.002	96.3	0.56
% 2	37	157	50	2.001	95.8	-0.1
%2	42	162	50	2.002	91.4	-0.88
2	47	167	50	2	91	-0.08
2	52	172	50	2.001	90.6	-0.08
% 2	57	177	150	2.000	90.6	0
% 2	58	178	150	2.001	94.4	3.8
% 3	3	183	150	2.002	100	1.12
% 3	8	188	150	2	101.3	0.26
% 3	13	193	150	2.001	107.5	1.24
% 3	18	198	150	2	108.7	0.24
% 3	23	203	150	2.002	108.6	-0.02
%3	28	208	150	2.001	109	0.08
%3	33	213	150	2	108.8	-0.04
3	38	218	150	2.001	108.4	-0.08
% 3	43	223	400	1.999	108.4	0
% 3	44	224	400	2.001	114.1	5.7
% 3	49	229	400	2.003	118.4	0.86
% 3	54	234	400	2.001	118.2	-0.04
%3	59	239	400	2.002	118	-0.04
4	4	244	400	2.002	118.4	0.08
% 4	5	245	900	2.005	122.1	3.7
% 4	10	250	900	2.005	126.6	0.9
% 4	15	255	900	2.005	128	0.28
%4	20	260	900	2.005	128.5	0.1
%4	25	265	900	2.006	128.2	-0.06
4	30	270	900	2.004	127.8	-0.08
% 4	31	271	1900	2.011	133	5.2
% 4	36	276	1900	2.012	136.5	0.7
% 4	41	281	1900	2.011	137.2	0.14
% 4	46	286	1900	2.011	137.4	0.04
%4	51	291	1900	2.01	136.8	-0.12
4	56	296	1900	2.011	137.2	0.08
% 5	1	301	3400	2.011	136.8	-0.08
% 5	3	303	3400	2.02	142.5	2.85
% 5	8	308	3400	2.022	143.2	0.14
% 5	13	313	3400	2.021	143.4	0.04
% 5	18	318	3400	2.022	143.1	-0.06
% 5	23	323	3400	2.021	142	-0.22
% 5	28	328	3400	2.021	142.4	0.08
% 5	33	333	3400	2.021	142	-0.08
%5	38	338	3400	2.019	141.1	-0.18
5	43	343	3400	2.019	142.2	0.22
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative vol added	pH	mvA	delta	mVB	deltaB	comments
% 0	0	0	0	9.625	60.9	
% 0	5	5	0	9.657	47.3	-2.72
% 0	15	15	0	9.574	-34.7	-8.2
% 0	20	20	0	9.643	-33	0.34
% 0	25	25	0	9.256	-19	2.8
% 0	30	30	0	9.54	-29.6	-2.12
% 0	35	35	0	9.537	-28.8	0.16
% 0	40	40	0	9.54	-28.4	0.08
% 0	45	45	0	9.532	-27	0.28
% 0	50	50	0	9.527	-27.6	-0.12
% 0	55	55	0	9.517	-27.7	-0.02
% 1	0	60	0	9.512	-27.7	0
% 1	5	65	0	9.502	-26.2	0.3
%1	10	70	0	9.501	-26.3	-0.02
%1	15	75	0	9.486	-26.5	-0.04
1	20	80	0	9.482	-26.4	0.02
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-6; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
paramlinear=polyfit(log10(CuTplus(5:end)),Emeas(5:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=79.3; Eorig=-26.4; m=21.5; m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'r--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'m--'); hold on
plot([log10(CuwithCuOs) log10(CuwithCuOs)],[-100 150],'g--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -150
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -11.0185 50 0.253456 42.9448

list
string: Total Cu
 -5.91521 40 0.230415 31.5513

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	"cumulative vol added"	pH	mvA	delta
% 1	30	90	0	2.029	73.3	9.97
% 1	35	95	0	2.023	73.4	0.02
% 1	40	100	0	2.022	76.8	0.68
% 1	45	105	0	2.002	77.8	0.2
% 1	55	115	0	2.004	74.9	-0.29
% 2	5	125	0	2.002	74.5	-0.04
%2	10	130	0	2.002	74.6	0.02
2	15	135	0	2.002	74.8	0.04
2	17	137	0	2.002	79.3	2.25
% 2	22	142	50	2.002	90	2.14
% 2	27	147	50	2.001	93.5	0.7
% 2	32	152	50	2.002	96.3	0.56
% 2	37	157	50	2.001	95.8	-0.1
%2	42	162	50	2.002	91.4	-0.88
2	47	167	50	2	91	-0.08
2	52	172	50	2.001	90.6	-0.08
% 2	57	177	150	2.000	90.6	0
% 2	58	178	150	2.001	94.4	3.8
% 3	3	183	150	2.002	100	1.12
% 3	8	188	150	2	101.3	0.26
% 3	13	193	150	2.001	107.5	1.24
% 3	18	198	150	2	108.7	0.24
% 3	23	203	150	2.002	108.6	-0.02
%3	28	208	150	2.001	109	0.08
%3	33	213	150	2	108.8	-0.04
3	38	218	150	2.001	108.4	-0.08
% 3	43	223	400	1.999	108.4	0
% 3	44	224	400	2.001	114.1	5.7
% 3	49	229	400	2.003	118.4	0.86
% 3	54	234	400	2.001	118.2	-0.04
%3	59	239	400	2.002	118	-0.04
4	4	244	400	2.002	118.4	0.08
% 4	5	245	900	2.005	122.1	3.7
% 4	10	250	900	2.005	126.6	0.9
% 4	15	255	900	2.005	128	0.28
%4	20	260	900	2.005	128.5	0.1
%4	25	265	900	2.006	128.2	-0.06
4	30	270	900	2.004	127.8	-0.08
% 4	31	271	1900	2.011	133	5.2
% 4	36	276	1900	2.012	136.5	0.7
% 4	41	281	1900	2.011	137.2	0.14
% 4	46	286	1900	2.011	137.4	0.04
%4	51	291	1900	2.01	136.8	-0.12
4	56	296	1900	2.011	137.2	0.08
% 5	1	301	3400	2.011	136.8	-0.08
% 5	3	303	3400	2.02	142.5	2.85
% 5	8	308	3400	2.022	143.2	0.14
% 5	13	313	3400	2.021	143.4	0.04
% 5	18	318	3400	2.022	143.1	-0.06
% 5	23	323	3400	2.021	142	-0.22
% 5	28	328	3400	2.021	142.4	0.08
% 5	33	333	3400	2.021	142	-0.08
%5	38	338	3400	2.019	141.1	-0.18
5	43	343	3400	2.019	142.2	0.22
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative vol added	pH	mvA	delta	mVB	deltaB	comments
% 0	0	0	0	9.625	60.9	
% 0	5	5	0	9.657	47.3	-2.72
% 0	15	15	0	9.574	-34.7	-8.2
% 0	20	20	0	9.643	-33	0.34
% 0	25	25	0	9.256	-19	2.8
% 0	30	30	0	9.54	-29.6	-2.12
% 0	35	35	0	9.537	-28.8	0.16
% 0	40	40	0	9.54	-28.4	0.08
% 0	45	45	0	9.532	-27	0.28
% 0	50	50	0	9.527	-27.6	-0.12
% 0	55	55	0	9.517	-27.7	-0.02
% 1	0	60	0	9.512	-27.7	0
% 1	5	65	0	9.502	-26.2	0.3
%1	10	70	0	9.501	-26.3	-0.02
%1	15	75	0	9.486	-26.5	-0.04
1	20	80	0	9.482	-26.4	0.02
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-6; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(5:end)),Emeas(5:end),1)
paramlinear=polyfit(log10(CuTplus(5:end)),Emeas(5:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=79.3; Eorig=-26.4; m=21.5; m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'r--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'m--'); hold on
plot([log10(CuwithCuOs) log10(CuwithCuOs)],[-100 150],'g--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -11.0185 50 0.253456 35.7873

list
string: Total Cu
 -5.91521 40 0.230415 26.2927

[I 21:39:45.041 NotebookApp] Saving file at /KNO3_pH9pt5_1uMCuT.ipynb
[W 22:49:49.735 NotebookApp] 404 GET /api/contents/KNO3_pH6_0pt1uMCuT.ipynb?1691016589738 (172.24.0.1): file or directory does not exist: 'KNO3_pH6_0pt1uMCuT.ipynb'
[W 22:49:49.735 NotebookApp] file or directory does not exist: 'KNO3_pH6_0pt1uMCuT.ipynb'
[W 22:49:49.735 NotebookApp] 404 GET /api/contents/KNO3_pH6_0pt1uMCuT.ipynb?1691016589738 (172.24.0.1) 1.790000ms referer=https://jupyter6.clearnasdss.synology.me/lab/tree/KNO3_pH10_0pt1uMCuT.ipynb
[W 22:49:49.758 NotebookApp] 404 GET /api/contents/KNO3_pH6_0pt1uMCuT.ipynb?content=0&1691016589763 (172.24.0.1): file or directory does not exist: 'KNO3_pH6_0pt1uMCuT.ipynb'
[W 22:49:49.759 NotebookApp] file or directory does not exist: 'KNO3_pH6_0pt1uMCuT.ipynb'
[W 22:49:49.760 NotebookApp] 404 GET /api/contents/KNO3_pH6_0pt1uMCuT.ipynb?content=0&1691016589763 (172.24.0.1) 2.140000ms referer=https://jupyter6.clearnasdss.synology.me/lab/tree/KNO3_pH10_0pt1uMCuT.ipynb
[I 22:49:49.769 NotebookApp] Uploading file to /KNO3_pH6_0pt1uMCuT.ipynb
Executing: % put in data
data=[...
time hr	time min	time total	cumulative  vol added	pH	mvA	delta
0	0	0	0	5.992	49.4	
0	5	5	0	6.002	55.7	1.26
0	10	10	0	6.018	59.4	0.739999999999999
0	15	15	0	6.033	62.5	0.62
0	20	20	0	6.046	62.6	0.0200000000000003
0	25	25	0	6.064	65.4	0.560000000000001
0	30	30	0	6.054	73	1.52
1	0	60	0	6.077	70.1	-0.0966666666666669
1	5	65	0	6.042	67.4	-0.539999999999998
1	10	70	0	6.064	69.9	0.5
1	15	75	0	6.077	69.9	0
1	20	80	0	6.091	68.8	-0.220000000000002
1	25	85	0	6.019	67.3	-0.3
1	30	90	0	6.033	67.7	0.0800000000000011
1	35	95	0	6.05	68	0.0599999999999994
1	40	100	0	6.073	67.4	-0.119999999999999
1	45	105	0	2.086	75.5	1.62
1	50	110	0	2.045	76.3	0.159999999999999
1	55	115	0	2.04	79	0.540000000000001
2	0	120	0	2.041	79.2	0.0400000000000006
2	5	125	0	2.039	80.4	0.240000000000001
2	10	130	0	2.04	82.2	0.359999999999999
2	15	135	0	2.04	81.7	-0.1
2	20	140	0	2.038	84	0.459999999999999
2	25	145	0	2.037	82.9	-0.219999999999999
2	30	150	0	2.037	83.5	0.119999999999999
2	35	155	0	2.038	84.8	0.259999999999999
2	40	160	0	2.035	86.1	0.259999999999999
3	0	180	0	2.037	84.6	-0.075
3	5	185	50	2.037	87.3	0.540000000000001
3	8	188	50	2.036	91.2	1.3
3	13	193	50	2.037	92.3	0.219999999999999
3	18	198	50	2.032	92.8	0.1
3	23	203	50	2.036	93.7	0.180000000000001
3	28	208	50	2.035	93.3	-0.0800000000000011
3	33	213	50	2.036	93.9	0.120000000000002
3	38	218	50	2.037	95.4	0.3
3	43	223	50	2.035	95.3	-0.0200000000000017
3	48	228	50	2.035	96.3	0.2
3	53	233	50	2.033	98.2	0.380000000000001
3	58	238	50	2.036	98.2	0
4	3	243	50	2.032	98.2	0
4	8	248	50	2.034	98.6	0.0799999999999983
4	10	250	150	2.036	100.5	0.950000000000003
4	15	255	150	2.034	105.2	0.940000000000001
4	20	260	150	2.036	105.6	0.0799999999999983
4	25	265	150	2.034	107	0.280000000000001
4	30	270	150	2.034	108	0.2
4	35	275	150	2.032	108	0
4	40	280	150	2.032	107.8	-0.0400000000000006
4	45	285	150	2.031	107.7	-0.0199999999999989
4	50	290	400	2.031	115	1.46
4	55	295	400	2.031	115.9	0.180000000000001
5	0	300	400	2.029	116.1	0.0399999999999977
5	5	305	400	2.032	116.5	0.0800000000000011
5	10	310	400	2.029	116	-0.1
5	15	315	900	2.034	124.8	1.76
5	20	320	900	2.037	125.3	0.1
5	25	325	900	2.034	125.4	0.0200000000000017
5	30	330	900	2.037	125.5	0.0199999999999989
5	35	335	900	2.041	132.2	1.34
5	40	340	1900	2.042	134	0.360000000000002
5	45	345	1900	2.042	133.5	-0.1
5	55	355	1900	2.041	134.2	0.0699999999999989
6	0	360	3400	2.05	140.8	1.32
6	5	365	3400	2.051	142.2	0.279999999999996
6	10	370	3400	2.05	140.8	-0.279999999999996
6	15	375	3400	2.054	142.2	0.279999999999996
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
time hr	time min	time total	cumulative  vol added	pH	mvA	delta
0	0	0	0	5.992	49.4	
0	5	5	0	6.002	55.7	1.26
0	10	10	0	6.018	59.4	0.739999999999999
0	15	15	0	6.033	62.5	0.62
0	20	20	0	6.046	62.6	0.0200000000000003
0	25	25	0	6.064	65.4	0.560000000000001
0	30	30	0	6.054	73	1.52
1	0	60	0	6.077	70.1	-0.0966666666666669
1	5	65	0	6.042	67.4	-0.539999999999998
1	10	70	0	6.064	69.9	0.5
1	15	75	0	6.077	69.9	0
1	20	80	0	6.091	68.8	-0.220000000000002
%1	25	85	0	6.019	67.3	-0.3
%1	30	90	0	6.033	67.7	0.0800000000000011
1	35	95	0	6.05	68	0.0599999999999994
1	40	100	0	6.073	67.4	-0.119999999999999
];
[I 22:51:49.826 NotebookApp] Saving file at /KNO3_pH6_0pt1uMCuT.ipynb
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
1	45	105	0	2.086	75.5	1.62
1	50	110	0	2.045	76.3	0.159999999999999
1	55	115	0	2.04	79	0.540000000000001
2	0	120	0	2.041	79.2	0.0400000000000006
2	5	125	0	2.039	80.4	0.240000000000001
2	10	130	0	2.04	82.2	0.359999999999999
2	15	135	0	2.04	81.7	-0.1
2	20	140	0	2.038	84	0.459999999999999
2	25	145	0	2.037	82.9	-0.219999999999999
%2	30	150	0	2.037	83.5	0.119999999999999
%2	35	155	0	2.038	84.8	0.259999999999999
2	40	160	0	2.035	86.1	0.259999999999999
3	0	180	0	2.037	84.6	-0.075
3	5	185	50	2.037	87.3	0.540000000000001
3	8	188	50	2.036	91.2	1.3
3	13	193	50	2.037	92.3	0.219999999999999
3	18	198	50	2.032	92.8	0.1
3	23	203	50	2.036	93.7	0.180000000000001
3	28	208	50	2.035	93.3	-0.0800000000000011
3	33	213	50	2.036	93.9	0.120000000000002
3	38	218	50	2.037	95.4	0.3
3	43	223	50	2.035	95.3	-0.0200000000000017
3	48	228	50	2.035	96.3	0.2
3	53	233	50	2.033	98.2	0.380000000000001
3	58	238	50	2.036	98.2	0
4	3	243	50	2.032	98.2	0
4	8	248	50	2.034	98.6	0.0799999999999983
4	10	250	150	2.036	100.5	0.950000000000003
4	15	255	150	2.034	105.2	0.940000000000001
4	20	260	150	2.036	105.6	0.0799999999999983
4	25	265	150	2.034	107	0.280000000000001
4	30	270	150	2.034	108	0.2
4	35	275	150	2.032	108	0
4	40	280	150	2.032	107.8	-0.0400000000000006
4	45	285	150	2.031	107.7	-0.0199999999999989
4	50	290	400	2.031	115	1.46
4	55	295	400	2.031	115.9	0.180000000000001
5	0	300	400	2.029	116.1	0.0399999999999977
5	5	305	400	2.032	116.5	0.0800000000000011
5	10	310	400	2.029	116	-0.1
5	15	315	900	2.034	124.8	1.76
5	20	320	900	2.037	125.3	0.1
5	25	325	900	2.034	125.4	0.0200000000000017
5	30	330	900	2.037	125.5	0.0199999999999989
5	35	335	900	2.041	132.2	1.34
5	40	340	1900	2.042	134	0.360000000000002
5	45	345	1900	2.042	133.5	-0.1
5	55	355	1900	2.041	134.2	0.0699999999999989
6	0	360	3400	2.05	140.8	1.32
6	5	365	3400	2.051	142.2	0.279999999999996
6	10	370	3400	2.05	140.8	-0.279999999999996
6	15	375	3400	2.054	142.2	0.279999999999996
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	5.992	49.4	
%0	5	5	0	6.002	55.7	1.26
%0	10	10	0	6.018	59.4	0.739999999999999
%0	15	15	0	6.033	62.5	0.62
%0	20	20	0	6.046	62.6	0.0200000000000003
%0	25	25	0	6.064	65.4	0.560000000000001
%0	30	30	0	6.054	73	1.52
%1	0	60	0	6.077	70.1	-0.0966666666666669
%1	5	65	0	6.042	67.4	-0.539999999999998
%1	10	70	0	6.064	69.9	0.5
%1	15	75	0	6.077	69.9	0
%1	20	80	0	6.091	68.8	-0.220000000000002
%1	25	85	0	6.019	67.3	-0.3
%1	30	90	0	6.033	67.7	0.0800000000000011
1	35	95	0	6.05	68	0.0599999999999994
1	40	100	0	6.073	67.4	-0.119999999999999
];
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%1	45	105	0	2.086	75.5	1.62
%1	50	110	0	2.045	76.3	0.159999999999999
%1	55	115	0	2.04	79	0.540000000000001
%2	0	120	0	2.041	79.2	0.0400000000000006
%2	5	125	0	2.039	80.4	0.240000000000001
%2	10	130	0	2.04	82.2	0.359999999999999
%2	15	135	0	2.04	81.7	-0.1
%2	20	140	0	2.038	84	0.459999999999999
%2	25	145	0	2.037	82.9	-0.219999999999999
%2	30	150	0	2.037	83.5	0.119999999999999
%2	35	155	0	2.038	84.8	0.259999999999999
2	40	160	0	2.035	86.1	0.259999999999999
3	0	180	0	2.037	84.6	-0.075
%3	5	185	50	2.037	87.3	0.540000000000001
%3	8	188	50	2.036	91.2	1.3
%3	13	193	50	2.037	92.3	0.219999999999999
%3	18	198	50	2.032	92.8	0.1
%3	23	203	50	2.036	93.7	0.180000000000001
%3	28	208	50	2.035	93.3	-0.0800000000000011
%3	33	213	50	2.036	93.9	0.120000000000002
%3	38	218	50	2.037	95.4	0.3
%3	43	223	50	2.035	95.3	-0.0200000000000017
%3	48	228	50	2.035	96.3	0.2
%3	53	233	50	2.033	98.2	0.380000000000001
%3	58	238	50	2.036	98.2	0
4	3	243	50	2.032	98.2	0
4	8	248	50	2.034	98.6	0.0799999999999983
%4	10	250	150	2.036	100.5	0.950000000000003
%4	15	255	150	2.034	105.2	0.940000000000001
%4	20	260	150	2.036	105.6	0.0799999999999983
%4	25	265	150	2.034	107	0.280000000000001
%4	30	270	150	2.034	108	0.2
%4	35	275	150	2.032	108	0
4	40	280	150	2.032	107.8	-0.0400000000000006
4	45	285	150	2.031	107.7	-0.0199999999999989
%4	50	290	400	2.031	115	1.46
%4	55	295	400	2.031	115.9	0.180000000000001
%5	0	300	400	2.029	116.1	0.0399999999999977
5	5	305	400	2.032	116.5	0.0800000000000011
5	10	310	400	2.029	116	-0.1
%5	15	315	900	2.034	124.8	1.76
%5	20	320	900	2.037	125.3	0.1
%5	25	325	900	2.034	125.4	0.0200000000000017
5	30	330	900	2.037	125.5	0.0199999999999989
5	35	335	900	2.041	132.2	1.34
%5	40	340	1900	2.042	134	0.360000000000002
5	45	345	1900	2.042	133.5	-0.1
5	55	355	1900	2.041	134.2	0.0699999999999989
%6	0	360	3400	2.05	140.8	1.32
%6	5	365	3400	2.051	142.2	0.279999999999996
6	10	370	3400	2.05	140.8	-0.279999999999996
6	15	375	3400	2.054	142.2	0.279999999999996
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	5.992	49.4	
%0	5	5	0	6.002	55.7	1.26
%0	10	10	0	6.018	59.4	0.739999999999999
%0	15	15	0	6.033	62.5	0.62
%0	20	20	0	6.046	62.6	0.0200000000000003
%0	25	25	0	6.064	65.4	0.560000000000001
%0	30	30	0	6.054	73	1.52
%1	0	60	0	6.077	70.1	-0.0966666666666669
%1	5	65	0	6.042	67.4	-0.539999999999998
%1	10	70	0	6.064	69.9	0.5
%1	15	75	0	6.077	69.9	0
%1	20	80	0	6.091	68.8	-0.220000000000002
%1	25	85	0	6.019	67.3	-0.3
%1	30	90	0	6.033	67.7	0.0800000000000011
1	35	95	0	6.05	68	0.0599999999999994
1	40	100	0	6.073	67.4	-0.119999999999999
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
paramlinear=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=95.6; Eorig=-17.3; m=21.5; m=24.254; m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 -40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -7.08003 50 0.329493 27.1984

list
string: Total Cu
 -6.94977 60 0.299539 19.9825

[I 22:53:49.870 NotebookApp] Saving file at /KNO3_pH6_0pt1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%1	45	105	0	2.086	75.5	1.62
%1	50	110	0	2.045	76.3	0.159999999999999
%1	55	115	0	2.04	79	0.540000000000001
%2	0	120	0	2.041	79.2	0.0400000000000006
%2	5	125	0	2.039	80.4	0.240000000000001
%2	10	130	0	2.04	82.2	0.359999999999999
%2	15	135	0	2.04	81.7	-0.1
%2	20	140	0	2.038	84	0.459999999999999
%2	25	145	0	2.037	82.9	-0.219999999999999
%2	30	150	0	2.037	83.5	0.119999999999999
%2	35	155	0	2.038	84.8	0.259999999999999
2	40	160	0	2.035	86.1	0.259999999999999
3	0	180	0	2.037	84.6	-0.075
%3	5	185	50	2.037	87.3	0.540000000000001
%3	8	188	50	2.036	91.2	1.3
%3	13	193	50	2.037	92.3	0.219999999999999
%3	18	198	50	2.032	92.8	0.1
%3	23	203	50	2.036	93.7	0.180000000000001
%3	28	208	50	2.035	93.3	-0.0800000000000011
%3	33	213	50	2.036	93.9	0.120000000000002
%3	38	218	50	2.037	95.4	0.3
%3	43	223	50	2.035	95.3	-0.0200000000000017
%3	48	228	50	2.035	96.3	0.2
%3	53	233	50	2.033	98.2	0.380000000000001
%3	58	238	50	2.036	98.2	0
4	3	243	50	2.032	98.2	0
4	8	248	50	2.034	98.6	0.0799999999999983
%4	10	250	150	2.036	100.5	0.950000000000003
%4	15	255	150	2.034	105.2	0.940000000000001
%4	20	260	150	2.036	105.6	0.0799999999999983
%4	25	265	150	2.034	107	0.280000000000001
%4	30	270	150	2.034	108	0.2
%4	35	275	150	2.032	108	0
4	40	280	150	2.032	107.8	-0.0400000000000006
4	45	285	150	2.031	107.7	-0.0199999999999989
%4	50	290	400	2.031	115	1.46
%4	55	295	400	2.031	115.9	0.180000000000001
%5	0	300	400	2.029	116.1	0.0399999999999977
5	5	305	400	2.032	116.5	0.0800000000000011
5	10	310	400	2.029	116	-0.1
%5	15	315	900	2.034	124.8	1.76
%5	20	320	900	2.037	125.3	0.1
%5	25	325	900	2.034	125.4	0.0200000000000017
5	30	330	900	2.037	125.5	0.0199999999999989
5	35	335	900	2.041	132.2	1.34
%5	40	340	1900	2.042	134	0.360000000000002
5	45	345	1900	2.042	133.5	-0.1
5	55	355	1900	2.041	134.2	0.0699999999999989
%6	0	360	3400	2.05	140.8	1.32
%6	5	365	3400	2.051	142.2	0.279999999999996
6	10	370	3400	2.05	140.8	-0.279999999999996
6	15	375	3400	2.054	142.2	0.279999999999996
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	5.992	49.4	
%0	5	5	0	6.002	55.7	1.26
%0	10	10	0	6.018	59.4	0.739999999999999
%0	15	15	0	6.033	62.5	0.62
%0	20	20	0	6.046	62.6	0.0200000000000003
%0	25	25	0	6.064	65.4	0.560000000000001
%0	30	30	0	6.054	73	1.52
%1	0	60	0	6.077	70.1	-0.0966666666666669
%1	5	65	0	6.042	67.4	-0.539999999999998
%1	10	70	0	6.064	69.9	0.5
%1	15	75	0	6.077	69.9	0
%1	20	80	0	6.091	68.8	-0.220000000000002
%1	25	85	0	6.019	67.3	-0.3
%1	30	90	0	6.033	67.7	0.0800000000000011
1	35	95	0	6.05	68	0.0599999999999994
1	40	100	0	6.073	67.4	-0.119999999999999
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
paramlinear=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=Emeas(1:2); Eorig=mVAoriginal; m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 -40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -7.08003 50 0.329493 27.1984

list
string: Total Cu
 -6.94977 60 0.299539 19.9825

[I 22:55:49.917 NotebookApp] Saving file at /KNO3_pH6_0pt1uMCuT.ipynb
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 -40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -7.08003 50 0.329493 27.1984

list
string: Total Cu
 -6.94977 60 0.299539 19.9825

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%1	45	105	0	2.086	75.5	1.62
%1	50	110	0	2.045	76.3	0.159999999999999
%1	55	115	0	2.04	79	0.540000000000001
%2	0	120	0	2.041	79.2	0.0400000000000006
%2	5	125	0	2.039	80.4	0.240000000000001
%2	10	130	0	2.04	82.2	0.359999999999999
%2	15	135	0	2.04	81.7	-0.1
%2	20	140	0	2.038	84	0.459999999999999
%2	25	145	0	2.037	82.9	-0.219999999999999
%2	30	150	0	2.037	83.5	0.119999999999999
%2	35	155	0	2.038	84.8	0.259999999999999
2	40	160	0	2.035	86.1	0.259999999999999
3	0	180	0	2.037	84.6	-0.075
%3	5	185	50	2.037	87.3	0.540000000000001
%3	8	188	50	2.036	91.2	1.3
%3	13	193	50	2.037	92.3	0.219999999999999
%3	18	198	50	2.032	92.8	0.1
%3	23	203	50	2.036	93.7	0.180000000000001
%3	28	208	50	2.035	93.3	-0.0800000000000011
%3	33	213	50	2.036	93.9	0.120000000000002
%3	38	218	50	2.037	95.4	0.3
%3	43	223	50	2.035	95.3	-0.0200000000000017
%3	48	228	50	2.035	96.3	0.2
%3	53	233	50	2.033	98.2	0.380000000000001
%3	58	238	50	2.036	98.2	0
4	3	243	50	2.032	98.2	0
4	8	248	50	2.034	98.6	0.0799999999999983
%4	10	250	150	2.036	100.5	0.950000000000003
%4	15	255	150	2.034	105.2	0.940000000000001
%4	20	260	150	2.036	105.6	0.0799999999999983
%4	25	265	150	2.034	107	0.280000000000001
%4	30	270	150	2.034	108	0.2
%4	35	275	150	2.032	108	0
4	40	280	150	2.032	107.8	-0.0400000000000006
4	45	285	150	2.031	107.7	-0.0199999999999989
%4	50	290	400	2.031	115	1.46
%4	55	295	400	2.031	115.9	0.180000000000001
%5	0	300	400	2.029	116.1	0.0399999999999977
5	5	305	400	2.032	116.5	0.0800000000000011
5	10	310	400	2.029	116	-0.1
%5	15	315	900	2.034	124.8	1.76
%5	20	320	900	2.037	125.3	0.1
%5	25	325	900	2.034	125.4	0.0200000000000017
5	30	330	900	2.037	125.5	0.0199999999999989
5	35	335	900	2.041	132.2	1.34
%5	40	340	1900	2.042	134	0.360000000000002
5	45	345	1900	2.042	133.5	-0.1
5	55	355	1900	2.041	134.2	0.0699999999999989
%6	0	360	3400	2.05	140.8	1.32
%6	5	365	3400	2.051	142.2	0.279999999999996
6	10	370	3400	2.05	140.8	-0.279999999999996
6	15	375	3400	2.054	142.2	0.279999999999996
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	5.992	49.4	
%0	5	5	0	6.002	55.7	1.26
%0	10	10	0	6.018	59.4	0.739999999999999
%0	15	15	0	6.033	62.5	0.62
%0	20	20	0	6.046	62.6	0.0200000000000003
%0	25	25	0	6.064	65.4	0.560000000000001
%0	30	30	0	6.054	73	1.52
%1	0	60	0	6.077	70.1	-0.0966666666666669
%1	5	65	0	6.042	67.4	-0.539999999999998
%1	10	70	0	6.064	69.9	0.5
%1	15	75	0	6.077	69.9	0
%1	20	80	0	6.091	68.8	-0.220000000000002
%1	25	85	0	6.019	67.3	-0.3
%1	30	90	0	6.033	67.7	0.0800000000000011
1	35	95	0	6.05	68	0.0599999999999994
1	40	100	0	6.073	67.4	-0.119999999999999
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
paramlinear=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=mean(Emeas(1:2)); Eorig=mVAoriginal; m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 -40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -7.08003 50 0.329493 27.1984

list
string: Total Cu
 -6.94977 60 0.299539 19.9825

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%1	45	105	0	2.086	75.5	1.62
%1	50	110	0	2.045	76.3	0.159999999999999
%1	55	115	0	2.04	79	0.540000000000001
%2	0	120	0	2.041	79.2	0.0400000000000006
%2	5	125	0	2.039	80.4	0.240000000000001
%2	10	130	0	2.04	82.2	0.359999999999999
%2	15	135	0	2.04	81.7	-0.1
%2	20	140	0	2.038	84	0.459999999999999
%2	25	145	0	2.037	82.9	-0.219999999999999
%2	30	150	0	2.037	83.5	0.119999999999999
%2	35	155	0	2.038	84.8	0.259999999999999
2	40	160	0	2.035	86.1	0.259999999999999
3	0	180	0	2.037	84.6	-0.075
%3	5	185	50	2.037	87.3	0.540000000000001
%3	8	188	50	2.036	91.2	1.3
%3	13	193	50	2.037	92.3	0.219999999999999
%3	18	198	50	2.032	92.8	0.1
%3	23	203	50	2.036	93.7	0.180000000000001
%3	28	208	50	2.035	93.3	-0.0800000000000011
%3	33	213	50	2.036	93.9	0.120000000000002
%3	38	218	50	2.037	95.4	0.3
%3	43	223	50	2.035	95.3	-0.0200000000000017
%3	48	228	50	2.035	96.3	0.2
%3	53	233	50	2.033	98.2	0.380000000000001
%3	58	238	50	2.036	98.2	0
4	3	243	50	2.032	98.2	0
4	8	248	50	2.034	98.6	0.0799999999999983
%4	10	250	150	2.036	100.5	0.950000000000003
%4	15	255	150	2.034	105.2	0.940000000000001
%4	20	260	150	2.036	105.6	0.0799999999999983
%4	25	265	150	2.034	107	0.280000000000001
%4	30	270	150	2.034	108	0.2
%4	35	275	150	2.032	108	0
4	40	280	150	2.032	107.8	-0.0400000000000006
4	45	285	150	2.031	107.7	-0.0199999999999989
%4	50	290	400	2.031	115	1.46
%4	55	295	400	2.031	115.9	0.180000000000001
%5	0	300	400	2.029	116.1	0.0399999999999977
5	5	305	400	2.032	116.5	0.0800000000000011
5	10	310	400	2.029	116	-0.1
%5	15	315	900	2.034	124.8	1.76
%5	20	320	900	2.037	125.3	0.1
%5	25	325	900	2.034	125.4	0.0200000000000017
5	30	330	900	2.037	125.5	0.0199999999999989
5	35	335	900	2.041	132.2	1.34
%5	40	340	1900	2.042	134	0.360000000000002
5	45	345	1900	2.042	133.5	-0.1
5	55	355	1900	2.041	134.2	0.0699999999999989
%6	0	360	3400	2.05	140.8	1.32
%6	5	365	3400	2.051	142.2	0.279999999999996
6	10	370	3400	2.05	140.8	-0.279999999999996
6	15	375	3400	2.054	142.2	0.279999999999996
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	5.992	49.4	
%0	5	5	0	6.002	55.7	1.26
%0	10	10	0	6.018	59.4	0.739999999999999
%0	15	15	0	6.033	62.5	0.62
%0	20	20	0	6.046	62.6	0.0200000000000003
%0	25	25	0	6.064	65.4	0.560000000000001
%0	30	30	0	6.054	73	1.52
%1	0	60	0	6.077	70.1	-0.0966666666666669
%1	5	65	0	6.042	67.4	-0.539999999999998
%1	10	70	0	6.064	69.9	0.5
%1	15	75	0	6.077	69.9	0
%1	20	80	0	6.091	68.8	-0.220000000000002
%1	25	85	0	6.019	67.3	-0.3
%1	30	90	0	6.033	67.7	0.0800000000000011
1	35	95	0	6.05	68	0.0599999999999994
1	40	100	0	6.073	67.4	-0.119999999999999
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
paramlinear=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=mean(Emeas(1:2)); Eorig=mean(mVAoriginal); m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 -40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -7.08003 50 0.329493 27.1984

list
string: Total Cu
 -6.94977 60 0.299539 19.9825

[I 22:57:49.966 NotebookApp] Saving file at /KNO3_pH6_0pt1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%1	45	105	0	2.086	75.5	1.62
%1	50	110	0	2.045	76.3	0.159999999999999
%1	55	115	0	2.04	79	0.540000000000001
%2	0	120	0	2.041	79.2	0.0400000000000006
%2	5	125	0	2.039	80.4	0.240000000000001
%2	10	130	0	2.04	82.2	0.359999999999999
%2	15	135	0	2.04	81.7	-0.1
%2	20	140	0	2.038	84	0.459999999999999
%2	25	145	0	2.037	82.9	-0.219999999999999
%2	30	150	0	2.037	83.5	0.119999999999999
%2	35	155	0	2.038	84.8	0.259999999999999
2	40	160	0	2.035	86.1	0.259999999999999
3	0	180	0	2.037	84.6	-0.075
%3	5	185	50	2.037	87.3	0.540000000000001
%3	8	188	50	2.036	91.2	1.3
%3	13	193	50	2.037	92.3	0.219999999999999
%3	18	198	50	2.032	92.8	0.1
%3	23	203	50	2.036	93.7	0.180000000000001
%3	28	208	50	2.035	93.3	-0.0800000000000011
%3	33	213	50	2.036	93.9	0.120000000000002
%3	38	218	50	2.037	95.4	0.3
%3	43	223	50	2.035	95.3	-0.0200000000000017
%3	48	228	50	2.035	96.3	0.2
%3	53	233	50	2.033	98.2	0.380000000000001
%3	58	238	50	2.036	98.2	0
4	3	243	50	2.032	98.2	0
4	8	248	50	2.034	98.6	0.0799999999999983
%4	10	250	150	2.036	100.5	0.950000000000003
%4	15	255	150	2.034	105.2	0.940000000000001
%4	20	260	150	2.036	105.6	0.0799999999999983
%4	25	265	150	2.034	107	0.280000000000001
%4	30	270	150	2.034	108	0.2
%4	35	275	150	2.032	108	0
4	40	280	150	2.032	107.8	-0.0400000000000006
4	45	285	150	2.031	107.7	-0.0199999999999989
%4	50	290	400	2.031	115	1.46
%4	55	295	400	2.031	115.9	0.180000000000001
%5	0	300	400	2.029	116.1	0.0399999999999977
5	5	305	400	2.032	116.5	0.0800000000000011
5	10	310	400	2.029	116	-0.1
%5	15	315	900	2.034	124.8	1.76
%5	20	320	900	2.037	125.3	0.1
%5	25	325	900	2.034	125.4	0.0200000000000017
5	30	330	900	2.037	125.5	0.0199999999999989
5	35	335	900	2.041	132.2	1.34
%5	40	340	1900	2.042	134	0.360000000000002
5	45	345	1900	2.042	133.5	-0.1
5	55	355	1900	2.041	134.2	0.0699999999999989
%6	0	360	3400	2.05	140.8	1.32
%6	5	365	3400	2.051	142.2	0.279999999999996
6	10	370	3400	2.05	140.8	-0.279999999999996
6	15	375	3400	2.054	142.2	0.279999999999996
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	5.992	49.4	
%0	5	5	0	6.002	55.7	1.26
%0	10	10	0	6.018	59.4	0.739999999999999
%0	15	15	0	6.033	62.5	0.62
%0	20	20	0	6.046	62.6	0.0200000000000003
%0	25	25	0	6.064	65.4	0.560000000000001
%0	30	30	0	6.054	73	1.52
%1	0	60	0	6.077	70.1	-0.0966666666666669
%1	5	65	0	6.042	67.4	-0.539999999999998
%1	10	70	0	6.064	69.9	0.5
%1	15	75	0	6.077	69.9	0
%1	20	80	0	6.091	68.8	-0.220000000000002
%1	25	85	0	6.019	67.3	-0.3
%1	30	90	0	6.033	67.7	0.0800000000000011
1	35	95	0	6.05	68	0.0599999999999994
1	40	100	0	6.073	67.4	-0.119999999999999
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
paramlinear=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=mean(Emeas(1:2)); Eorig=mean(mVAoriginal); m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 -40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -7.08003 50 0.329493 27.1984

list
string: Total Cu
 -6.94977 60 0.299539 19.9825

[I 22:59:50.020 NotebookApp] Saving file at /KNO3_pH6_0pt1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%1	45	105	0	2.086	75.5	1.62
%1	50	110	0	2.045	76.3	0.159999999999999
%1	55	115	0	2.04	79	0.540000000000001
%2	0	120	0	2.041	79.2	0.0400000000000006
%2	5	125	0	2.039	80.4	0.240000000000001
%2	10	130	0	2.04	82.2	0.359999999999999
%2	15	135	0	2.04	81.7	-0.1
%2	20	140	0	2.038	84	0.459999999999999
%2	25	145	0	2.037	82.9	-0.219999999999999
%2	30	150	0	2.037	83.5	0.119999999999999
%2	35	155	0	2.038	84.8	0.259999999999999
2	40	160	0	2.035	86.1	0.259999999999999
3	0	180	0	2.037	84.6	-0.075
%3	5	185	50	2.037	87.3	0.540000000000001
%3	8	188	50	2.036	91.2	1.3
%3	13	193	50	2.037	92.3	0.219999999999999
%3	18	198	50	2.032	92.8	0.1
%3	23	203	50	2.036	93.7	0.180000000000001
%3	28	208	50	2.035	93.3	-0.0800000000000011
%3	33	213	50	2.036	93.9	0.120000000000002
%3	38	218	50	2.037	95.4	0.3
%3	43	223	50	2.035	95.3	-0.0200000000000017
%3	48	228	50	2.035	96.3	0.2
%3	53	233	50	2.033	98.2	0.380000000000001
%3	58	238	50	2.036	98.2	0
4	3	243	50	2.032	98.2	0
4	8	248	50	2.034	98.6	0.0799999999999983
%4	10	250	150	2.036	100.5	0.950000000000003
%4	15	255	150	2.034	105.2	0.940000000000001
%4	20	260	150	2.036	105.6	0.0799999999999983
%4	25	265	150	2.034	107	0.280000000000001
%4	30	270	150	2.034	108	0.2
%4	35	275	150	2.032	108	0
4	40	280	150	2.032	107.8	-0.0400000000000006
4	45	285	150	2.031	107.7	-0.0199999999999989
%4	50	290	400	2.031	115	1.46
%4	55	295	400	2.031	115.9	0.180000000000001
%5	0	300	400	2.029	116.1	0.0399999999999977
5	5	305	400	2.032	116.5	0.0800000000000011
5	10	310	400	2.029	116	-0.1
%5	15	315	900	2.034	124.8	1.76
%5	20	320	900	2.037	125.3	0.1
%5	25	325	900	2.034	125.4	0.0200000000000017
5	30	330	900	2.037	125.5	0.0199999999999989
5	35	335	900	2.041	132.2	1.34
%5	40	340	1900	2.042	134	0.360000000000002
5	45	345	1900	2.042	133.5	-0.1
5	55	355	1900	2.041	134.2	0.0699999999999989
%6	0	360	3400	2.05	140.8	1.32
%6	5	365	3400	2.051	142.2	0.279999999999996
6	10	370	3400	2.05	140.8	-0.279999999999996
6	15	375	3400	2.054	142.2	0.279999999999996
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	5.992	49.4	
%0	5	5	0	6.002	55.7	1.26
%0	10	10	0	6.018	59.4	0.739999999999999
%0	15	15	0	6.033	62.5	0.62
%0	20	20	0	6.046	62.6	0.0200000000000003
%0	25	25	0	6.064	65.4	0.560000000000001
%0	30	30	0	6.054	73	1.52
%1	0	60	0	6.077	70.1	-0.0966666666666669
%1	5	65	0	6.042	67.4	-0.539999999999998
%1	10	70	0	6.064	69.9	0.5
%1	15	75	0	6.077	69.9	0
%1	20	80	0	6.091	68.8	-0.220000000000002
%1	25	85	0	6.019	67.3	-0.3
%1	30	90	0	6.033	67.7	0.0800000000000011
1	35	95	0	6.05	68	0.0599999999999994
1	40	100	0	6.073	67.4	-0.119999999999999
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
paramlinear=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=mean(Emeas(1:2)); Eorig=mean(mVAoriginal); m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 -40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -7.08003 50 0.329493 27.1984

list
string: Total Cu
 -6.94977 60 0.299539 19.9825

[I 23:01:50.067 NotebookApp] Saving file at /KNO3_pH6_0pt1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	"cumulative vol added"	pH	mvA	delta
% 1	30	90	0	2.029	73.3	9.97
% 1	35	95	0	2.023	73.4	0.02
% 1	40	100	0	2.022	76.8	0.68
% 1	45	105	0	2.002	77.8	0.2
% 1	55	115	0	2.004	74.9	-0.29
% 2	5	125	0	2.002	74.5	-0.04
%2	10	130	0	2.002	74.6	0.02
2	15	135	0	2.002	74.8	0.04
2	17	137	0	2.002	79.3	2.25
% 2	22	142	50	2.002	90	2.14
% 2	27	147	50	2.001	93.5	0.7
% 2	32	152	50	2.002	96.3	0.56
% 2	37	157	50	2.001	95.8	-0.1
%2	42	162	50	2.002	91.4	-0.88
2	47	167	50	2	91	-0.08
2	52	172	50	2.001	90.6	-0.08
% 2	57	177	150	2.000	90.6	0
% 2	58	178	150	2.001	94.4	3.8
% 3	3	183	150	2.002	100	1.12
% 3	8	188	150	2	101.3	0.26
% 3	13	193	150	2.001	107.5	1.24
% 3	18	198	150	2	108.7	0.24
% 3	23	203	150	2.002	108.6	-0.02
%3	28	208	150	2.001	109	0.08
%3	33	213	150	2	108.8	-0.04
3	38	218	150	2.001	108.4	-0.08
% 3	43	223	400	1.999	108.4	0
% 3	44	224	400	2.001	114.1	5.7
% 3	49	229	400	2.003	118.4	0.86
% 3	54	234	400	2.001	118.2	-0.04
%3	59	239	400	2.002	118	-0.04
4	4	244	400	2.002	118.4	0.08
% 4	5	245	900	2.005	122.1	3.7
% 4	10	250	900	2.005	126.6	0.9
% 4	15	255	900	2.005	128	0.28
%4	20	260	900	2.005	128.5	0.1
%4	25	265	900	2.006	128.2	-0.06
4	30	270	900	2.004	127.8	-0.08
% 4	31	271	1900	2.011	133	5.2
% 4	36	276	1900	2.012	136.5	0.7
% 4	41	281	1900	2.011	137.2	0.14
% 4	46	286	1900	2.011	137.4	0.04
%4	51	291	1900	2.01	136.8	-0.12
4	56	296	1900	2.011	137.2	0.08
% 5	1	301	3400	2.011	136.8	-0.08
% 5	3	303	3400	2.02	142.5	2.85
% 5	8	308	3400	2.022	143.2	0.14
% 5	13	313	3400	2.021	143.4	0.04
% 5	18	318	3400	2.022	143.1	-0.06
% 5	23	323	3400	2.021	142	-0.22
% 5	28	328	3400	2.021	142.4	0.08
% 5	33	333	3400	2.021	142	-0.08
%5	38	338	3400	2.019	141.1	-0.18
5	43	343	3400	2.019	142.2	0.22
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative vol added	pH	mvA	delta	mVB	deltaB	comments
% 0	0	0	0	9.625	60.9	
% 0	5	5	0	9.657	47.3	-2.72
% 0	15	15	0	9.574	-34.7	-8.2
% 0	20	20	0	9.643	-33	0.34
% 0	25	25	0	9.256	-19	2.8
% 0	30	30	0	9.54	-29.6	-2.12
% 0	35	35	0	9.537	-28.8	0.16
% 0	40	40	0	9.54	-28.4	0.08
% 0	45	45	0	9.532	-27	0.28
% 0	50	50	0	9.527	-27.6	-0.12
% 0	55	55	0	9.517	-27.7	-0.02
% 1	0	60	0	9.512	-27.7	0
% 1	5	65	0	9.502	-26.2	0.3
%1	10	70	0	9.501	-26.3	-0.02
%1	15	75	0	9.486	-26.5	-0.04
1	20	80	0	9.482	-26.4	0.02
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-6; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(5:end)),Emeas(5:end),1)
paramlinear=polyfit(log10(CuTplus(5:end)),Emeas(5:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=79.3; Eorig=-26.4; m=21.5; m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'r--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'m--'); hold on
plot([log10(CuwithCuOs) log10(CuwithCuOs)],[-100 150],'g--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -11.0185 50 0.253456 35.7873

list
string: Total Cu
 -5.91521 40 0.230415 26.2927

[I 23:03:45.400 NotebookApp] Saving file at /KNO3_pH9pt5_1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	"cumulative vol added"	pH	mvA	delta
% 1	30	90	0	2.029	73.3	9.97
% 1	35	95	0	2.023	73.4	0.02
% 1	40	100	0	2.022	76.8	0.68
% 1	45	105	0	2.002	77.8	0.2
% 1	55	115	0	2.004	74.9	-0.29
% 2	5	125	0	2.002	74.5	-0.04
%2	10	130	0	2.002	74.6	0.02
2	15	135	0	2.002	74.8	0.04
2	17	137	0	2.002	79.3	2.25
% 2	22	142	50	2.002	90	2.14
% 2	27	147	50	2.001	93.5	0.7
% 2	32	152	50	2.002	96.3	0.56
% 2	37	157	50	2.001	95.8	-0.1
%2	42	162	50	2.002	91.4	-0.88
2	47	167	50	2	91	-0.08
2	52	172	50	2.001	90.6	-0.08
% 2	57	177	150	2.000	90.6	0
% 2	58	178	150	2.001	94.4	3.8
% 3	3	183	150	2.002	100	1.12
% 3	8	188	150	2	101.3	0.26
% 3	13	193	150	2.001	107.5	1.24
% 3	18	198	150	2	108.7	0.24
% 3	23	203	150	2.002	108.6	-0.02
%3	28	208	150	2.001	109	0.08
%3	33	213	150	2	108.8	-0.04
3	38	218	150	2.001	108.4	-0.08
% 3	43	223	400	1.999	108.4	0
% 3	44	224	400	2.001	114.1	5.7
% 3	49	229	400	2.003	118.4	0.86
% 3	54	234	400	2.001	118.2	-0.04
%3	59	239	400	2.002	118	-0.04
4	4	244	400	2.002	118.4	0.08
% 4	5	245	900	2.005	122.1	3.7
% 4	10	250	900	2.005	126.6	0.9
% 4	15	255	900	2.005	128	0.28
%4	20	260	900	2.005	128.5	0.1
%4	25	265	900	2.006	128.2	-0.06
4	30	270	900	2.004	127.8	-0.08
% 4	31	271	1900	2.011	133	5.2
% 4	36	276	1900	2.012	136.5	0.7
% 4	41	281	1900	2.011	137.2	0.14
% 4	46	286	1900	2.011	137.4	0.04
%4	51	291	1900	2.01	136.8	-0.12
4	56	296	1900	2.011	137.2	0.08
% 5	1	301	3400	2.011	136.8	-0.08
% 5	3	303	3400	2.02	142.5	2.85
% 5	8	308	3400	2.022	143.2	0.14
% 5	13	313	3400	2.021	143.4	0.04
% 5	18	318	3400	2.022	143.1	-0.06
% 5	23	323	3400	2.021	142	-0.22
% 5	28	328	3400	2.021	142.4	0.08
% 5	33	333	3400	2.021	142	-0.08
%5	38	338	3400	2.019	141.1	-0.18
5	43	343	3400	2.019	142.2	0.22
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative vol added	pH	mvA	delta	mVB	deltaB	comments
% 0	0	0	0	9.625	60.9	
% 0	5	5	0	9.657	47.3	-2.72
% 0	15	15	0	9.574	-34.7	-8.2
% 0	20	20	0	9.643	-33	0.34
% 0	25	25	0	9.256	-19	2.8
% 0	30	30	0	9.54	-29.6	-2.12
% 0	35	35	0	9.537	-28.8	0.16
% 0	40	40	0	9.54	-28.4	0.08
% 0	45	45	0	9.532	-27	0.28
% 0	50	50	0	9.527	-27.6	-0.12
% 0	55	55	0	9.517	-27.7	-0.02
% 1	0	60	0	9.512	-27.7	0
% 1	5	65	0	9.502	-26.2	0.3
%1	10	70	0	9.501	-26.3	-0.02
%1	15	75	0	9.486	-26.5	-0.04
1	20	80	0	9.482	-26.4	0.02
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-6; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
paramlinear=polyfit(log10(CuTplus(5:end)),Emeas(5:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=79.3; Eorig=-26.4; m=21.5; m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'r--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'m--'); hold on
plot([log10(CuwithCuOs) log10(CuwithCuOs)],[-100 150],'g--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -11.0185 50 0.253456 35.7873

list
string: Total Cu
 -5.91521 40 0.230415 26.2927

[W 23:05:01.706 NotebookApp] 404 GET /api/contents/KNO3_pH6_1uMCuT.ipynb?1691017501700 (172.24.0.1): file or directory does not exist: 'KNO3_pH6_1uMCuT.ipynb'
[W 23:05:01.706 NotebookApp] file or directory does not exist: 'KNO3_pH6_1uMCuT.ipynb'
[W 23:05:01.707 NotebookApp] 404 GET /api/contents/KNO3_pH6_1uMCuT.ipynb?1691017501700 (172.24.0.1) 2.070000ms referer=https://jupyter6.clearnasdss.synology.me/lab/tree/KNO3_pH9pt5_1uMCuT.ipynb
[W 23:05:01.731 NotebookApp] 404 GET /api/contents/KNO3_pH6_1uMCuT.ipynb?content=0&1691017501726 (172.24.0.1): file or directory does not exist: 'KNO3_pH6_1uMCuT.ipynb'
[W 23:05:01.731 NotebookApp] file or directory does not exist: 'KNO3_pH6_1uMCuT.ipynb'
[W 23:05:01.732 NotebookApp] 404 GET /api/contents/KNO3_pH6_1uMCuT.ipynb?content=0&1691017501726 (172.24.0.1) 2.350000ms referer=https://jupyter6.clearnasdss.synology.me/lab/tree/KNO3_pH9pt5_1uMCuT.ipynb
[I 23:05:01.744 NotebookApp] Uploading file to /KNO3_pH6_1uMCuT.ipynb
[W 23:05:01.774 NotebookApp] 409 PATCH /api/contents/KNO3_pH6_1uMCuT.ipynb?1691017501768 (172.24.0.1): File already exists: KNO3_pH9pt5_1uMCuT.ipynb
[W 23:05:01.775 NotebookApp] File already exists: KNO3_pH9pt5_1uMCuT.ipynb
[W 23:05:01.775 NotebookApp] 409 PATCH /api/contents/KNO3_pH6_1uMCuT.ipynb?1691017501768 (172.24.0.1) 2.560000ms referer=https://jupyter6.clearnasdss.synology.me/lab/tree/KNO3_pH9pt5_1uMCuT.ipynb
[I 23:07:01.790 NotebookApp] Saving file at /KNO3_pH6_1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	35	35	0	2.06	88.3	0.159999999999999
%0	40	40	0	2.053	88.3	0
%0	45	45	0	2.056	89.2	0.180000000000001
%0	50	50	0	2.055	88.9	-0.0599999999999994
%0	55	55	0	2.056	89.2	0.0599999999999994
1	0	60	0	2.056	91	0.359999999999999
1	18	78	0	2.056	87.5	-0.194444444444444
%1	19	79	50	2.058	87.4	-0.0999999999999943
%1	25	85	50	2.054	93.1	0.949999999999998
%1	30	90	50	2.057	96.3	0.640000000000001
%1	35	95	50	2.054	94.7	-0.319999999999999
%1	40	100	50	2.056	97	0.459999999999999
%1	45	105	50	2.052	97.6	0.119999999999999
%1	55	115	50	2.049	97.4	-0.0199999999999989
%2	0	120	50	2.053	98	0.119999999999999
%2	5	125	50	2.053	99.4	0.280000000000001
%2	10	130	50	2.044	98.4	-0.2
%2	15	135	50	2.045	97.6	-0.160000000000002
2	20	140	50	2.042	97.4	-0.0399999999999977
2	25	145	50	2.018	97.7	0.0599999999999994
%2	30	147	150	2.019	98.2	0.25
%2	32	152	150	2.016	103	0.959999999999999
%2	37	157	150	2.018	104	0.2
%2	42	162	150	2.015	105.1	0.219999999999999
%2	47	167	150	2.014	104.5	-0.119999999999999
%2	52	172	150	2.014	103.5	-0.2
%2	57	177	150	2.011	104	0.1
%3	2	182	150	2.011	106.3	0.459999999999999
%3	7	187	150	2.009	105.5	-0.159999999999999
%3	12	192	150	2.01	107	0.3
%3	17	197	150	2.009	106.5	-0.1
3	22	202	150	2.009	106.4	-0.0199999999999989
3	27	207	150	2.011	106.6	0.0399999999999977
%3	30	210	400	2.011	111	1.46666666666667
%3	35	215	400	2.011	114.9	0.780000000000001
%3	40	220	400	2.012	115.2	0.0599999999999994
%3	50	230	400	2.01	117.8	0.259999999999999
%3	55	235	400	2.01	118.3	0.1
%4	0	240	400	2.009	118.5	0.0400000000000006
%4	5	245	400	2.009	118.7	0.0400000000000006
%4	10	250	400	2.008	117.1	-0.320000000000002
%4	15	255	400	2.008	118	0.180000000000001
4	20	260	400	2.008	116.7	-0.259999999999999
4	25	265	400	2.007	116.6	-0.0200000000000017
%4	27	267	900	2.011	119	1.2
%4	32	272	900	2.011	123.7	0.940000000000001
%4	37	277	900	2.01	124.7	0.2
%4	42	282	900	2.011	126.2	0.3
%4	47	287	900	2.011	126.1	-0.0200000000000017
4	52	292	900	2.01	126.3	0.0400000000000006
4	57	297	900	2.011	126.2	-0.0199999999999989
%5	0	300	1900	2.018	131.8	1.86666666666667
%5	5	305	1900	2.017	134.3	0.5
%5	10	310	1900	2.018	135.6	0.259999999999997
%5	15	315	1900	2.018	134.7	-0.180000000000001
%5	20	320	1900	2.018	135.4	0.140000000000003
%5	25	325	1900	2.019	135	-0.0800000000000011
%5	30	330	1900	2.018	136.4	0.280000000000001
5	35	335	1900	2.018	136.5	0.0199999999999989
5	40	340	1900	2.018	135.5	-0.2
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	6.097	57.3	
%0	5	5	0	6.051	80.8	4.7
%0	10	10	0	6.071	83.8	0.6
%0	15	15	0	6.093	87.7	0.780000000000001
%0	20	20	0	6.101	87.7	0
0	25	25	0	6.079	87.8	0.0199999999999989
0	30	30	0	6.095	87.5	-0.0599999999999994
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-6; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
paramlinear=polyfit(log10(CuTplus(5:end)),Emeas(5:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=79.3; Eorig=-26.4; m=21.5; m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'r--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'m--'); hold on
plot([log10(CuwithCuOs) log10(CuwithCuOs)],[-100 150],'g--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -11.0185 50 0.253456 35.7873

list
string: Total Cu
 -5.91521 40 0.230415 26.2927

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	35	35	0	2.06	88.3	0.159999999999999
%0	40	40	0	2.053	88.3	0
%0	45	45	0	2.056	89.2	0.180000000000001
%0	50	50	0	2.055	88.9	-0.0599999999999994
%0	55	55	0	2.056	89.2	0.0599999999999994
1	0	60	0	2.056	91	0.359999999999999
1	18	78	0	2.056	87.5	-0.194444444444444
%1	19	79	50	2.058	87.4	-0.0999999999999943
%1	25	85	50	2.054	93.1	0.949999999999998
%1	30	90	50	2.057	96.3	0.640000000000001
%1	35	95	50	2.054	94.7	-0.319999999999999
%1	40	100	50	2.056	97	0.459999999999999
%1	45	105	50	2.052	97.6	0.119999999999999
%1	55	115	50	2.049	97.4	-0.0199999999999989
%2	0	120	50	2.053	98	0.119999999999999
%2	5	125	50	2.053	99.4	0.280000000000001
%2	10	130	50	2.044	98.4	-0.2
%2	15	135	50	2.045	97.6	-0.160000000000002
2	20	140	50	2.042	97.4	-0.0399999999999977
2	25	145	50	2.018	97.7	0.0599999999999994
%2	30	147	150	2.019	98.2	0.25
%2	32	152	150	2.016	103	0.959999999999999
%2	37	157	150	2.018	104	0.2
%2	42	162	150	2.015	105.1	0.219999999999999
%2	47	167	150	2.014	104.5	-0.119999999999999
%2	52	172	150	2.014	103.5	-0.2
%2	57	177	150	2.011	104	0.1
%3	2	182	150	2.011	106.3	0.459999999999999
%3	7	187	150	2.009	105.5	-0.159999999999999
%3	12	192	150	2.01	107	0.3
%3	17	197	150	2.009	106.5	-0.1
3	22	202	150	2.009	106.4	-0.0199999999999989
3	27	207	150	2.011	106.6	0.0399999999999977
%3	30	210	400	2.011	111	1.46666666666667
%3	35	215	400	2.011	114.9	0.780000000000001
%3	40	220	400	2.012	115.2	0.0599999999999994
%3	50	230	400	2.01	117.8	0.259999999999999
%3	55	235	400	2.01	118.3	0.1
%4	0	240	400	2.009	118.5	0.0400000000000006
%4	5	245	400	2.009	118.7	0.0400000000000006
%4	10	250	400	2.008	117.1	-0.320000000000002
%4	15	255	400	2.008	118	0.180000000000001
4	20	260	400	2.008	116.7	-0.259999999999999
4	25	265	400	2.007	116.6	-0.0200000000000017
%4	27	267	900	2.011	119	1.2
%4	32	272	900	2.011	123.7	0.940000000000001
%4	37	277	900	2.01	124.7	0.2
%4	42	282	900	2.011	126.2	0.3
%4	47	287	900	2.011	126.1	-0.0200000000000017
4	52	292	900	2.01	126.3	0.0400000000000006
4	57	297	900	2.011	126.2	-0.0199999999999989
%5	0	300	1900	2.018	131.8	1.86666666666667
%5	5	305	1900	2.017	134.3	0.5
%5	10	310	1900	2.018	135.6	0.259999999999997
%5	15	315	1900	2.018	134.7	-0.180000000000001
%5	20	320	1900	2.018	135.4	0.140000000000003
%5	25	325	1900	2.019	135	-0.0800000000000011
%5	30	330	1900	2.018	136.4	0.280000000000001
5	35	335	1900	2.018	136.5	0.0199999999999989
5	40	340	1900	2.018	135.5	-0.2
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	6.097	57.3	
%0	5	5	0	6.051	80.8	4.7
%0	10	10	0	6.071	83.8	0.6
%0	15	15	0	6.093	87.7	0.780000000000001
%0	20	20	0	6.101	87.7	0
0	25	25	0	6.079	87.8	0.0199999999999989
0	30	30	0	6.095	87.5	-0.0599999999999994
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-6; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
paramlinear=polyfit(log10(CuTplus(5:end)),Emeas(5:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=mean(Emeas(1:2)); Eorig=mean(mVAoriginal); m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'r--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'m--'); hold on
plot([log10(CuwithCuOs) log10(CuwithCuOs)],[-100 150],'g--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -11.0185 50 0.253456 35.7873

list
string: Total Cu
 -5.91521 40 0.230415 26.2927

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	35	35	0	2.06	88.3	0.159999999999999
%0	40	40	0	2.053	88.3	0
%0	45	45	0	2.056	89.2	0.180000000000001
%0	50	50	0	2.055	88.9	-0.0599999999999994
%0	55	55	0	2.056	89.2	0.0599999999999994
1	0	60	0	2.056	91	0.359999999999999
1	18	78	0	2.056	87.5	-0.194444444444444
%1	19	79	50	2.058	87.4	-0.0999999999999943
%1	25	85	50	2.054	93.1	0.949999999999998
%1	30	90	50	2.057	96.3	0.640000000000001
%1	35	95	50	2.054	94.7	-0.319999999999999
%1	40	100	50	2.056	97	0.459999999999999
%1	45	105	50	2.052	97.6	0.119999999999999
%1	55	115	50	2.049	97.4	-0.0199999999999989
%2	0	120	50	2.053	98	0.119999999999999
%2	5	125	50	2.053	99.4	0.280000000000001
%2	10	130	50	2.044	98.4	-0.2
%2	15	135	50	2.045	97.6	-0.160000000000002
2	20	140	50	2.042	97.4	-0.0399999999999977
2	25	145	50	2.018	97.7	0.0599999999999994
%2	30	147	150	2.019	98.2	0.25
%2	32	152	150	2.016	103	0.959999999999999
%2	37	157	150	2.018	104	0.2
%2	42	162	150	2.015	105.1	0.219999999999999
%2	47	167	150	2.014	104.5	-0.119999999999999
%2	52	172	150	2.014	103.5	-0.2
%2	57	177	150	2.011	104	0.1
%3	2	182	150	2.011	106.3	0.459999999999999
%3	7	187	150	2.009	105.5	-0.159999999999999
%3	12	192	150	2.01	107	0.3
%3	17	197	150	2.009	106.5	-0.1
3	22	202	150	2.009	106.4	-0.0199999999999989
3	27	207	150	2.011	106.6	0.0399999999999977
%3	30	210	400	2.011	111	1.46666666666667
%3	35	215	400	2.011	114.9	0.780000000000001
%3	40	220	400	2.012	115.2	0.0599999999999994
%3	50	230	400	2.01	117.8	0.259999999999999
%3	55	235	400	2.01	118.3	0.1
%4	0	240	400	2.009	118.5	0.0400000000000006
%4	5	245	400	2.009	118.7	0.0400000000000006
%4	10	250	400	2.008	117.1	-0.320000000000002
%4	15	255	400	2.008	118	0.180000000000001
4	20	260	400	2.008	116.7	-0.259999999999999
4	25	265	400	2.007	116.6	-0.0200000000000017
%4	27	267	900	2.011	119	1.2
%4	32	272	900	2.011	123.7	0.940000000000001
%4	37	277	900	2.01	124.7	0.2
%4	42	282	900	2.011	126.2	0.3
%4	47	287	900	2.011	126.1	-0.0200000000000017
4	52	292	900	2.01	126.3	0.0400000000000006
4	57	297	900	2.011	126.2	-0.0199999999999989
%5	0	300	1900	2.018	131.8	1.86666666666667
%5	5	305	1900	2.017	134.3	0.5
%5	10	310	1900	2.018	135.6	0.259999999999997
%5	15	315	1900	2.018	134.7	-0.180000000000001
%5	20	320	1900	2.018	135.4	0.140000000000003
%5	25	325	1900	2.019	135	-0.0800000000000011
%5	30	330	1900	2.018	136.4	0.280000000000001
5	35	335	1900	2.018	136.5	0.0199999999999989
5	40	340	1900	2.018	135.5	-0.2
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	6.097	57.3	
%0	5	5	0	6.051	80.8	4.7
%0	10	10	0	6.071	83.8	0.6
%0	15	15	0	6.093	87.7	0.780000000000001
%0	20	20	0	6.101	87.7	0
0	25	25	0	6.079	87.8	0.0199999999999989
0	30	30	0	6.095	87.5	-0.0599999999999994
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-6; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
paramlinear=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=mean(Emeas(1:2)); Eorig=mean(mVAoriginal); m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=9.4897; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'r--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'m--'); hold on
plot([log10(CuwithCuOs) log10(CuwithCuOs)],[-100 150],'g--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -11.0185 50 0.253456 35.7873

list
string: Total Cu
 -5.91521 40 0.230415 26.2927

[I 23:09:01.849 NotebookApp] Saving file at /KNO3_pH6_1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	35	35	0	2.06	88.3	0.159999999999999
%0	40	40	0	2.053	88.3	0
%0	45	45	0	2.056	89.2	0.180000000000001
%0	50	50	0	2.055	88.9	-0.0599999999999994
%0	55	55	0	2.056	89.2	0.0599999999999994
1	0	60	0	2.056	91	0.359999999999999
1	18	78	0	2.056	87.5	-0.194444444444444
%1	19	79	50	2.058	87.4	-0.0999999999999943
%1	25	85	50	2.054	93.1	0.949999999999998
%1	30	90	50	2.057	96.3	0.640000000000001
%1	35	95	50	2.054	94.7	-0.319999999999999
%1	40	100	50	2.056	97	0.459999999999999
%1	45	105	50	2.052	97.6	0.119999999999999
%1	55	115	50	2.049	97.4	-0.0199999999999989
%2	0	120	50	2.053	98	0.119999999999999
%2	5	125	50	2.053	99.4	0.280000000000001
%2	10	130	50	2.044	98.4	-0.2
%2	15	135	50	2.045	97.6	-0.160000000000002
2	20	140	50	2.042	97.4	-0.0399999999999977
2	25	145	50	2.018	97.7	0.0599999999999994
%2	30	147	150	2.019	98.2	0.25
%2	32	152	150	2.016	103	0.959999999999999
%2	37	157	150	2.018	104	0.2
%2	42	162	150	2.015	105.1	0.219999999999999
%2	47	167	150	2.014	104.5	-0.119999999999999
%2	52	172	150	2.014	103.5	-0.2
%2	57	177	150	2.011	104	0.1
%3	2	182	150	2.011	106.3	0.459999999999999
%3	7	187	150	2.009	105.5	-0.159999999999999
%3	12	192	150	2.01	107	0.3
%3	17	197	150	2.009	106.5	-0.1
3	22	202	150	2.009	106.4	-0.0199999999999989
3	27	207	150	2.011	106.6	0.0399999999999977
%3	30	210	400	2.011	111	1.46666666666667
%3	35	215	400	2.011	114.9	0.780000000000001
%3	40	220	400	2.012	115.2	0.0599999999999994
%3	50	230	400	2.01	117.8	0.259999999999999
%3	55	235	400	2.01	118.3	0.1
%4	0	240	400	2.009	118.5	0.0400000000000006
%4	5	245	400	2.009	118.7	0.0400000000000006
%4	10	250	400	2.008	117.1	-0.320000000000002
%4	15	255	400	2.008	118	0.180000000000001
4	20	260	400	2.008	116.7	-0.259999999999999
4	25	265	400	2.007	116.6	-0.0200000000000017
%4	27	267	900	2.011	119	1.2
%4	32	272	900	2.011	123.7	0.940000000000001
%4	37	277	900	2.01	124.7	0.2
%4	42	282	900	2.011	126.2	0.3
%4	47	287	900	2.011	126.1	-0.0200000000000017
4	52	292	900	2.01	126.3	0.0400000000000006
4	57	297	900	2.011	126.2	-0.0199999999999989
%5	0	300	1900	2.018	131.8	1.86666666666667
%5	5	305	1900	2.017	134.3	0.5
%5	10	310	1900	2.018	135.6	0.259999999999997
%5	15	315	1900	2.018	134.7	-0.180000000000001
%5	20	320	1900	2.018	135.4	0.140000000000003
%5	25	325	1900	2.019	135	-0.0800000000000011
%5	30	330	1900	2.018	136.4	0.280000000000001
5	35	335	1900	2.018	136.5	0.0199999999999989
5	40	340	1900	2.018	135.5	-0.2
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	6.097	57.3	
%0	5	5	0	6.051	80.8	4.7
%0	10	10	0	6.071	83.8	0.6
%0	15	15	0	6.093	87.7	0.780000000000001
%0	20	20	0	6.101	87.7	0
0	25	25	0	6.079	87.8	0.0199999999999989
0	30	30	0	6.095	87.5	-0.0599999999999994
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-6; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
paramlinear=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=mean(Emeas(1:2)); Eorig=mean(mVAoriginal); m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'r--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'m--'); hold on
plot([log10(CuwithCuOs) log10(CuwithCuOs)],[-100 150],'g--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -6.04294 50 0.253456 35.7873

list
string: Total Cu
 -5.91521 40 0.230415 26.2927

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	35	35	0	2.06	88.3	0.159999999999999
%0	40	40	0	2.053	88.3	0
%0	45	45	0	2.056	89.2	0.180000000000001
%0	50	50	0	2.055	88.9	-0.0599999999999994
%0	55	55	0	2.056	89.2	0.0599999999999994
%1	0	60	0	2.056	91	0.359999999999999
1	18	78	0	2.056	87.5	-0.194444444444444
%1	19	79	50	2.058	87.4	-0.0999999999999943
%1	25	85	50	2.054	93.1	0.949999999999998
%1	30	90	50	2.057	96.3	0.640000000000001
%1	35	95	50	2.054	94.7	-0.319999999999999
%1	40	100	50	2.056	97	0.459999999999999
%1	45	105	50	2.052	97.6	0.119999999999999
%1	55	115	50	2.049	97.4	-0.0199999999999989
%2	0	120	50	2.053	98	0.119999999999999
%2	5	125	50	2.053	99.4	0.280000000000001
%2	10	130	50	2.044	98.4	-0.2
%2	15	135	50	2.045	97.6	-0.160000000000002
2	20	140	50	2.042	97.4	-0.0399999999999977
2	25	145	50	2.018	97.7	0.0599999999999994
%2	30	147	150	2.019	98.2	0.25
%2	32	152	150	2.016	103	0.959999999999999
%2	37	157	150	2.018	104	0.2
%2	42	162	150	2.015	105.1	0.219999999999999
%2	47	167	150	2.014	104.5	-0.119999999999999
%2	52	172	150	2.014	103.5	-0.2
%2	57	177	150	2.011	104	0.1
%3	2	182	150	2.011	106.3	0.459999999999999
%3	7	187	150	2.009	105.5	-0.159999999999999
%3	12	192	150	2.01	107	0.3
%3	17	197	150	2.009	106.5	-0.1
3	22	202	150	2.009	106.4	-0.0199999999999989
3	27	207	150	2.011	106.6	0.0399999999999977
%3	30	210	400	2.011	111	1.46666666666667
%3	35	215	400	2.011	114.9	0.780000000000001
%3	40	220	400	2.012	115.2	0.0599999999999994
%3	50	230	400	2.01	117.8	0.259999999999999
%3	55	235	400	2.01	118.3	0.1
%4	0	240	400	2.009	118.5	0.0400000000000006
%4	5	245	400	2.009	118.7	0.0400000000000006
%4	10	250	400	2.008	117.1	-0.320000000000002
%4	15	255	400	2.008	118	0.180000000000001
4	20	260	400	2.008	116.7	-0.259999999999999
4	25	265	400	2.007	116.6	-0.0200000000000017
%4	27	267	900	2.011	119	1.2
%4	32	272	900	2.011	123.7	0.940000000000001
%4	37	277	900	2.01	124.7	0.2
%4	42	282	900	2.011	126.2	0.3
%4	47	287	900	2.011	126.1	-0.0200000000000017
4	52	292	900	2.01	126.3	0.0400000000000006
4	57	297	900	2.011	126.2	-0.0199999999999989
%5	0	300	1900	2.018	131.8	1.86666666666667
%5	5	305	1900	2.017	134.3	0.5
%5	10	310	1900	2.018	135.6	0.259999999999997
%5	15	315	1900	2.018	134.7	-0.180000000000001
%5	20	320	1900	2.018	135.4	0.140000000000003
%5	25	325	1900	2.019	135	-0.0800000000000011
%5	30	330	1900	2.018	136.4	0.280000000000001
5	35	335	1900	2.018	136.5	0.0199999999999989
5	40	340	1900	2.018	135.5	-0.2
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	6.097	57.3	
%0	5	5	0	6.051	80.8	4.7
%0	10	10	0	6.071	83.8	0.6
%0	15	15	0	6.093	87.7	0.780000000000001
%0	20	20	0	6.101	87.7	0
0	25	25	0	6.079	87.8	0.0199999999999989
0	30	30	0	6.095	87.5	-0.0599999999999994
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-6; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
paramlinear=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=mean(Emeas(1:2)); Eorig=mean(mVAoriginal); m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'r--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'m--'); hold on
plot([log10(CuwithCuOs) log10(CuwithCuOs)],[-100 150],'g--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -6.04294 50 0.253456 35.7873

list
string: Total Cu
 -5.91521 40 0.230415 26.2927

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	35	35	0	2.06	88.3	0.159999999999999
%0	40	40	0	2.053	88.3	0
%0	45	45	0	2.056	89.2	0.180000000000001
%0	50	50	0	2.055	88.9	-0.0599999999999994
%0	55	55	0	2.056	89.2	0.0599999999999994
%1	0	60	0	2.056	91	0.359999999999999
1	18	78	0	2.056	87.5	-0.194444444444444
%1	19	79	50	2.058	87.4	-0.0999999999999943
%1	25	85	50	2.054	93.1	0.949999999999998
%1	30	90	50	2.057	96.3	0.640000000000001
%1	35	95	50	2.054	94.7	-0.319999999999999
%1	40	100	50	2.056	97	0.459999999999999
%1	45	105	50	2.052	97.6	0.119999999999999
%1	55	115	50	2.049	97.4	-0.0199999999999989
%2	0	120	50	2.053	98	0.119999999999999
%2	5	125	50	2.053	99.4	0.280000000000001
%2	10	130	50	2.044	98.4	-0.2
%2	15	135	50	2.045	97.6	-0.160000000000002
2	20	140	50	2.042	97.4	-0.0399999999999977
2	25	145	50	2.018	97.7	0.0599999999999994
%2	30	147	150	2.019	98.2	0.25
%2	32	152	150	2.016	103	0.959999999999999
%2	37	157	150	2.018	104	0.2
%2	42	162	150	2.015	105.1	0.219999999999999
%2	47	167	150	2.014	104.5	-0.119999999999999
%2	52	172	150	2.014	103.5	-0.2
%2	57	177	150	2.011	104	0.1
%3	2	182	150	2.011	106.3	0.459999999999999
%3	7	187	150	2.009	105.5	-0.159999999999999
%3	12	192	150	2.01	107	0.3
%3	17	197	150	2.009	106.5	-0.1
3	22	202	150	2.009	106.4	-0.0199999999999989
3	27	207	150	2.011	106.6	0.0399999999999977
%3	30	210	400	2.011	111	1.46666666666667
%3	35	215	400	2.011	114.9	0.780000000000001
%3	40	220	400	2.012	115.2	0.0599999999999994
%3	50	230	400	2.01	117.8	0.259999999999999
%3	55	235	400	2.01	118.3	0.1
%4	0	240	400	2.009	118.5	0.0400000000000006
%4	5	245	400	2.009	118.7	0.0400000000000006
%4	10	250	400	2.008	117.1	-0.320000000000002
%4	15	255	400	2.008	118	0.180000000000001
4	20	260	400	2.008	116.7	-0.259999999999999
4	25	265	400	2.007	116.6	-0.0200000000000017
%4	27	267	900	2.011	119	1.2
%4	32	272	900	2.011	123.7	0.940000000000001
%4	37	277	900	2.01	124.7	0.2
%4	42	282	900	2.011	126.2	0.3
%4	47	287	900	2.011	126.1	-0.0200000000000017
4	52	292	900	2.01	126.3	0.0400000000000006
4	57	297	900	2.011	126.2	-0.0199999999999989
%5	0	300	1900	2.018	131.8	1.86666666666667
%5	5	305	1900	2.017	134.3	0.5
%5	10	310	1900	2.018	135.6	0.259999999999997
%5	15	315	1900	2.018	134.7	-0.180000000000001
%5	20	320	1900	2.018	135.4	0.140000000000003
%5	25	325	1900	2.019	135	-0.0800000000000011
%5	30	330	1900	2.018	136.4	0.280000000000001
5	35	335	1900	2.018	136.5	0.0199999999999989
5	40	340	1900	2.018	135.5	-0.2
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	6.097	57.3	
%0	5	5	0	6.051	80.8	4.7
%0	10	10	0	6.071	83.8	0.6
%0	15	15	0	6.093	87.7	0.780000000000001
%0	20	20	0	6.101	87.7	0
0	25	25	0	6.079	87.8	0.0199999999999989
0	30	30	0	6.095	87.5	-0.0599999999999994
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-6; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(2:end)),Emeas(2:end),1)
paramlinear=polyfit(log10(CuTplus(2:end)),Emeas(2:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=mean(Emeas(1:2)); Eorig=mean(mVAoriginal); m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'r--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'m--'); hold on
plot([log10(CuwithCuOs) log10(CuwithCuOs)],[-100 150],'g--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -6.04294 50 0.253456 35.7873

list
string: Total Cu
 -5.91521 40 0.230415 26.2927

[I 23:11:01.923 NotebookApp] Saving file at /KNO3_pH6_1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	35	35	0	2.06	88.3	0.159999999999999
%0	40	40	0	2.053	88.3	0
%0	45	45	0	2.056	89.2	0.180000000000001
%0	50	50	0	2.055	88.9	-0.0599999999999994
%0	55	55	0	2.056	89.2	0.0599999999999994
%1	0	60	0	2.056	91	0.359999999999999
1	18	78	0	2.056	87.5	-0.194444444444444
%1	19	79	50	2.058	87.4	-0.0999999999999943
%1	25	85	50	2.054	93.1	0.949999999999998
%1	30	90	50	2.057	96.3	0.640000000000001
%1	35	95	50	2.054	94.7	-0.319999999999999
%1	40	100	50	2.056	97	0.459999999999999
%1	45	105	50	2.052	97.6	0.119999999999999
%1	55	115	50	2.049	97.4	-0.0199999999999989
%2	0	120	50	2.053	98	0.119999999999999
%2	5	125	50	2.053	99.4	0.280000000000001
%2	10	130	50	2.044	98.4	-0.2
%2	15	135	50	2.045	97.6	-0.160000000000002
2	20	140	50	2.042	97.4	-0.0399999999999977
2	25	145	50	2.018	97.7	0.0599999999999994
%2	30	147	150	2.019	98.2	0.25
%2	32	152	150	2.016	103	0.959999999999999
%2	37	157	150	2.018	104	0.2
%2	42	162	150	2.015	105.1	0.219999999999999
%2	47	167	150	2.014	104.5	-0.119999999999999
%2	52	172	150	2.014	103.5	-0.2
%2	57	177	150	2.011	104	0.1
%3	2	182	150	2.011	106.3	0.459999999999999
%3	7	187	150	2.009	105.5	-0.159999999999999
%3	12	192	150	2.01	107	0.3
%3	17	197	150	2.009	106.5	-0.1
3	22	202	150	2.009	106.4	-0.0199999999999989
3	27	207	150	2.011	106.6	0.0399999999999977
%3	30	210	400	2.011	111	1.46666666666667
%3	35	215	400	2.011	114.9	0.780000000000001
%3	40	220	400	2.012	115.2	0.0599999999999994
%3	50	230	400	2.01	117.8	0.259999999999999
%3	55	235	400	2.01	118.3	0.1
%4	0	240	400	2.009	118.5	0.0400000000000006
%4	5	245	400	2.009	118.7	0.0400000000000006
%4	10	250	400	2.008	117.1	-0.320000000000002
%4	15	255	400	2.008	118	0.180000000000001
4	20	260	400	2.008	116.7	-0.259999999999999
4	25	265	400	2.007	116.6	-0.0200000000000017
%4	27	267	900	2.011	119	1.2
%4	32	272	900	2.011	123.7	0.940000000000001
%4	37	277	900	2.01	124.7	0.2
%4	42	282	900	2.011	126.2	0.3
%4	47	287	900	2.011	126.1	-0.0200000000000017
4	52	292	900	2.01	126.3	0.0400000000000006
4	57	297	900	2.011	126.2	-0.0199999999999989
%5	0	300	1900	2.018	131.8	1.86666666666667
%5	5	305	1900	2.017	134.3	0.5
%5	10	310	1900	2.018	135.6	0.259999999999997
%5	15	315	1900	2.018	134.7	-0.180000000000001
%5	20	320	1900	2.018	135.4	0.140000000000003
%5	25	325	1900	2.019	135	-0.0800000000000011
%5	30	330	1900	2.018	136.4	0.280000000000001
5	35	335	1900	2.018	136.5	0.0199999999999989
5	40	340	1900	2.018	135.5	-0.2
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	6.097	57.3	
%0	5	5	0	6.051	80.8	4.7
%0	10	10	0	6.071	83.8	0.6
%0	15	15	0	6.093	87.7	0.780000000000001
%0	20	20	0	6.101	87.7	0
0	25	25	0	6.079	87.8	0.0199999999999989
0	30	30	0	6.095	87.5	-0.0599999999999994
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(2:end)),Emeas(2:end),1)
paramlinear=polyfit(log10(CuTplus(2:end)),Emeas(2:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=mean(Emeas(1:2)); Eorig=mean(mVAoriginal); m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'r--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'m--'); hold on
plot([log10(CuwithCuOs) log10(CuwithCuOs)],[-100 150],'g--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -7.04294 50 0.253456 35.7873

list
string: Total Cu
 -6.91521 40 0.230415 26.2927

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	35	35	0	2.06	88.3	0.159999999999999
%0	40	40	0	2.053	88.3	0
%0	45	45	0	2.056	89.2	0.180000000000001
%0	50	50	0	2.055	88.9	-0.0599999999999994
%0	55	55	0	2.056	89.2	0.0599999999999994
%1	0	60	0	2.056	91	0.359999999999999
1	18	78	0	2.056	87.5	-0.194444444444444
%1	19	79	50	2.058	87.4	-0.0999999999999943
%1	25	85	50	2.054	93.1	0.949999999999998
%1	30	90	50	2.057	96.3	0.640000000000001
%1	35	95	50	2.054	94.7	-0.319999999999999
%1	40	100	50	2.056	97	0.459999999999999
%1	45	105	50	2.052	97.6	0.119999999999999
%1	55	115	50	2.049	97.4	-0.0199999999999989
%2	0	120	50	2.053	98	0.119999999999999
%2	5	125	50	2.053	99.4	0.280000000000001
%2	10	130	50	2.044	98.4	-0.2
%2	15	135	50	2.045	97.6	-0.160000000000002
2	20	140	50	2.042	97.4	-0.0399999999999977
2	25	145	50	2.018	97.7	0.0599999999999994
%2	30	147	150	2.019	98.2	0.25
%2	32	152	150	2.016	103	0.959999999999999
%2	37	157	150	2.018	104	0.2
%2	42	162	150	2.015	105.1	0.219999999999999
%2	47	167	150	2.014	104.5	-0.119999999999999
%2	52	172	150	2.014	103.5	-0.2
%2	57	177	150	2.011	104	0.1
%3	2	182	150	2.011	106.3	0.459999999999999
%3	7	187	150	2.009	105.5	-0.159999999999999
%3	12	192	150	2.01	107	0.3
%3	17	197	150	2.009	106.5	-0.1
3	22	202	150	2.009	106.4	-0.0199999999999989
3	27	207	150	2.011	106.6	0.0399999999999977
%3	30	210	400	2.011	111	1.46666666666667
%3	35	215	400	2.011	114.9	0.780000000000001
%3	40	220	400	2.012	115.2	0.0599999999999994
%3	50	230	400	2.01	117.8	0.259999999999999
%3	55	235	400	2.01	118.3	0.1
%4	0	240	400	2.009	118.5	0.0400000000000006
%4	5	245	400	2.009	118.7	0.0400000000000006
%4	10	250	400	2.008	117.1	-0.320000000000002
%4	15	255	400	2.008	118	0.180000000000001
4	20	260	400	2.008	116.7	-0.259999999999999
4	25	265	400	2.007	116.6	-0.0200000000000017
%4	27	267	900	2.011	119	1.2
%4	32	272	900	2.011	123.7	0.940000000000001
%4	37	277	900	2.01	124.7	0.2
%4	42	282	900	2.011	126.2	0.3
%4	47	287	900	2.011	126.1	-0.0200000000000017
4	52	292	900	2.01	126.3	0.0400000000000006
4	57	297	900	2.011	126.2	-0.0199999999999989
%5	0	300	1900	2.018	131.8	1.86666666666667
%5	5	305	1900	2.017	134.3	0.5
%5	10	310	1900	2.018	135.6	0.259999999999997
%5	15	315	1900	2.018	134.7	-0.180000000000001
%5	20	320	1900	2.018	135.4	0.140000000000003
%5	25	325	1900	2.019	135	-0.0800000000000011
%5	30	330	1900	2.018	136.4	0.280000000000001
5	35	335	1900	2.018	136.5	0.0199999999999989
5	40	340	1900	2.018	135.5	-0.2
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	6.097	57.3	
%0	5	5	0	6.051	80.8	4.7
%0	10	10	0	6.071	83.8	0.6
%0	15	15	0	6.093	87.7	0.780000000000001
%0	20	20	0	6.101	87.7	0
0	25	25	0	6.079	87.8	0.0199999999999989
0	30	30	0	6.095	87.5	-0.0599999999999994
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-5; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(2:end)),Emeas(2:end),1)
paramlinear=polyfit(log10(CuTplus(2:end)),Emeas(2:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=mean(Emeas(1:2)); Eorig=mean(mVAoriginal); m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'r--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'m--'); hold on
plot([log10(CuwithCuOs) log10(CuwithCuOs)],[-100 150],'g--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -150
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -5.04294 50 0.253456 42.9448

list
string: Total Cu
 -4.91521 40 0.230415 31.5513

[I 23:18:10.991 NotebookApp] Saving file at /KNO3_pH8_0pt1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
4	35	275	0	2.001	115.1	0.2
4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-5; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
paramlinear=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=115; Eorig=52; m=21.5; m=paramlinear(1); %m=24.25;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -6.16346 50 0.329493 15.7464

list
string: Total Cu
 -4.94977 60 0.299539 11.5688

[I 23:18:25.468 NotebookApp] Saving file at /KNO3_pH8_0pt1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%2	15	135	0	2.013	86.4	6.88
%2	20	140	0	2.014	92.2	1.16
%2	25	145	0	2.011	96.6	0.879999999999998
%2	30	150	0	2.011	101.2	0.920000000000002
%2	40	160	0	2.01	104.2	0.3
%2	50	170	0	2.009	104.4	0.0200000000000003
%2	55	175	0	2.009	106.6	0.439999999999998
%3	0	180	0	2.009	108	0.280000000000001
%3	5	185	0	2.009	108.7	0.140000000000001
%3	10	190	0	2.009	108.6	-0.0200000000000017
%3	15	195	0	2.008	108.8	0.0400000000000006
%3	20	200	0	2.007	109.7	0.180000000000001
%3	25	205	0	2.007	109.9	0.0400000000000006
%3	30	210	0	2.005	107.8	-0.420000000000002
%3	40	220	0	2.004	110.5	0.27
%3	45	225	0	2.004	111.4	0.180000000000001
%3	50	230	0	2.003	111.9	0.1
%3	55	235	0	2.003	112.7	0.159999999999999
%4	0	240	0	2.004	113.9	0.240000000000001
%4	5	245	0	2.004	115.8	0.379999999999998
%4	10	250	0	2.004	114.8	-0.2
%4	15	255	0	2.002	115.6	0.159999999999999
%4	20	260	0	2.002	116.4	0.160000000000002
%4	30	270	0	2.001	114.1	-0.230000000000001
4	35	275	0	2.001	115.1	0.2
4	50	290	0	1.999	115	-0.00666666666666629
%4	55	295	50	1.998	116.1	0.219999999999999
%5	5	305	50	1.998	117.4	0.130000000000001
%5	10	310	50	1.998	117.1	-0.0600000000000023
%5	15	315	50	1.997	116.8	-0.0599999999999994
%5	20	320	50	1.997	117.7	0.180000000000001
%5	25	325	50	1.996	117.2	-0.1
%5	30	330	50	1.996	119	0.359999999999999
%5	35	335	50	1.995	118.8	-0.0400000000000006
%5	40	340	50	1.995	119.1	0.0599999999999994
5	45	345	50	1.995	119.6	0.1
5	50	350	50	1.994	118.6	-0.2
%5	55	355	150	1.995	120.6	0.4
%6	0	360	150	1.995	120.1	-0.1
%6	5	365	150	1.995	121.8	0.340000000000001
%6	10	370	150	1.995	121.4	-0.0799999999999983
%6	15	375	150	1.996	121.9	0.1
%6	20	380	150	1.995	122	0.0199999999999989
%6	25	385	150	1.995	123.1	0.219999999999999
%6	30	390	150	1.994	122.4	-0.139999999999998
6	35	395	150	1.994	122.9	0.1
6	40	400	150	1.994	122.2	-0.140000000000001
%6	45	405	400	1.995	124.7	0.5
%6	50	410	400	1.995	125	0.0599999999999994
%6	55	415	400	1.996	125.1	0.0199999999999989
%7	0	420	400	1.996	125.8	0.140000000000001
%7	5	425	400	1.996	126.5	0.140000000000001
%7	10	430	400	1.996	126.2	-0.0599999999999994
7	15	435	400	1.996	126.2	0
7	20	440	400	1.995	126.4	0.0400000000000006
%7	25	445	900	1.998	130.5	0.819999999999999
7	30	450	900	1.998	129.6	-0.180000000000001
7	35	455	900	1.997	130.8	0.240000000000003
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	8.041	53.6	
%0	5	5	0	8.085	50	-0.72
%0	10	10	0	7.969	53	0.6
%0	15	15	0	8.031	49.8	-0.640000000000001
%0	20	20	0	7.999	51	0.240000000000001
%0	25	25	0	8.004	50.1	-0.18
%0	30	30	0	8.014	50.5	0.0799999999999997
%0	35	35	0	7.992	50.5	0
%0	40	40	0	8	51.4	0.18
%0	45	45	0	8.001	52	0.12
%0	50	50	0	8.008	51.1	-0.18
%0	55	55	0	8.006	51.3	0.0399999999999992
%1	0	60	0	8.001	51.3	0
%1	5	65	0	7.986	52.6	0.260000000000001
%1	10	70	0	7.978	52.3	-0.0600000000000009
%1	15	75	0	7.991	52	-0.0599999999999994
%1	20	80	0	7.984	50.3	-0.340000000000001
%1	25	85	0	7.979	50.7	0.0800000000000011
%1	30	90	0	7.972	53.7	0.6
%1	35	95	0	7.971	52.7	-0.2
%1	40	100	0	7.966	52.3	-0.0800000000000011
%1	45	105	0	7.964	53.2	0.180000000000001
%1	50	110	0	8.058	53.6	0.0799999999999997
1	55	115	0	8.029	53.7	0.0200000000000003
2	10	130	0	8.017	52	-0.113333333333334
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
paramlinear=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=115; Eorig=52; m=21.5; m=paramlinear(1); %m=24.25;
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pH=8.023; pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 40
list
string: 60
list
string: 80
list
string: 100
list
string: 120
list
string: 140
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -8.16346 50 0.329493 15.7464

list
string: Total Cu
 -6.94977 60 0.299539 11.5688

[I 23:19:01.990 NotebookApp] Saving file at /KNO3_pH6_1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%1	45	105	0	2.086	75.5	1.62
%1	50	110	0	2.045	76.3	0.159999999999999
%1	55	115	0	2.04	79	0.540000000000001
%2	0	120	0	2.041	79.2	0.0400000000000006
%2	5	125	0	2.039	80.4	0.240000000000001
%2	10	130	0	2.04	82.2	0.359999999999999
%2	15	135	0	2.04	81.7	-0.1
%2	20	140	0	2.038	84	0.459999999999999
%2	25	145	0	2.037	82.9	-0.219999999999999
%2	30	150	0	2.037	83.5	0.119999999999999
%2	35	155	0	2.038	84.8	0.259999999999999
2	40	160	0	2.035	86.1	0.259999999999999
3	0	180	0	2.037	84.6	-0.075
%3	5	185	50	2.037	87.3	0.540000000000001
%3	8	188	50	2.036	91.2	1.3
%3	13	193	50	2.037	92.3	0.219999999999999
%3	18	198	50	2.032	92.8	0.1
%3	23	203	50	2.036	93.7	0.180000000000001
%3	28	208	50	2.035	93.3	-0.0800000000000011
%3	33	213	50	2.036	93.9	0.120000000000002
%3	38	218	50	2.037	95.4	0.3
%3	43	223	50	2.035	95.3	-0.0200000000000017
%3	48	228	50	2.035	96.3	0.2
%3	53	233	50	2.033	98.2	0.380000000000001
%3	58	238	50	2.036	98.2	0
4	3	243	50	2.032	98.2	0
4	8	248	50	2.034	98.6	0.0799999999999983
%4	10	250	150	2.036	100.5	0.950000000000003
%4	15	255	150	2.034	105.2	0.940000000000001
%4	20	260	150	2.036	105.6	0.0799999999999983
%4	25	265	150	2.034	107	0.280000000000001
%4	30	270	150	2.034	108	0.2
%4	35	275	150	2.032	108	0
4	40	280	150	2.032	107.8	-0.0400000000000006
4	45	285	150	2.031	107.7	-0.0199999999999989
%4	50	290	400	2.031	115	1.46
%4	55	295	400	2.031	115.9	0.180000000000001
%5	0	300	400	2.029	116.1	0.0399999999999977
5	5	305	400	2.032	116.5	0.0800000000000011
5	10	310	400	2.029	116	-0.1
%5	15	315	900	2.034	124.8	1.76
%5	20	320	900	2.037	125.3	0.1
%5	25	325	900	2.034	125.4	0.0200000000000017
5	30	330	900	2.037	125.5	0.0199999999999989
5	35	335	900	2.041	132.2	1.34
%5	40	340	1900	2.042	134	0.360000000000002
5	45	345	1900	2.042	133.5	-0.1
5	55	355	1900	2.041	134.2	0.0699999999999989
%6	0	360	3400	2.05	140.8	1.32
%6	5	365	3400	2.051	142.2	0.279999999999996
6	10	370	3400	2.05	140.8	-0.279999999999996
6	15	375	3400	2.054	142.2	0.279999999999996
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	5.992	49.4	
%0	5	5	0	6.002	55.7	1.26
%0	10	10	0	6.018	59.4	0.739999999999999
%0	15	15	0	6.033	62.5	0.62
%0	20	20	0	6.046	62.6	0.0200000000000003
%0	25	25	0	6.064	65.4	0.560000000000001
%0	30	30	0	6.054	73	1.52
%1	0	60	0	6.077	70.1	-0.0966666666666669
%1	5	65	0	6.042	67.4	-0.539999999999998
%1	10	70	0	6.064	69.9	0.5
%1	15	75	0	6.077	69.9	0
%1	20	80	0	6.091	68.8	-0.220000000000002
%1	25	85	0	6.019	67.3	-0.3
%1	30	90	0	6.033	67.7	0.0800000000000011
1	35	95	0	6.05	68	0.0599999999999994
1	40	100	0	6.073	67.4	-0.119999999999999
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-7; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
paramlinear=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=mean(Emeas(1:2)); Eorig=mean(mVAoriginal); m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 -40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -7.08003 50 0.329493 27.1984

list
string: Total Cu
 -6.94977 60 0.299539 19.9825

Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%1	45	105	0	2.086	75.5	1.62
%1	50	110	0	2.045	76.3	0.159999999999999
%1	55	115	0	2.04	79	0.540000000000001
%2	0	120	0	2.041	79.2	0.0400000000000006
%2	5	125	0	2.039	80.4	0.240000000000001
%2	10	130	0	2.04	82.2	0.359999999999999
%2	15	135	0	2.04	81.7	-0.1
%2	20	140	0	2.038	84	0.459999999999999
%2	25	145	0	2.037	82.9	-0.219999999999999
%2	30	150	0	2.037	83.5	0.119999999999999
%2	35	155	0	2.038	84.8	0.259999999999999
2	40	160	0	2.035	86.1	0.259999999999999
3	0	180	0	2.037	84.6	-0.075
%3	5	185	50	2.037	87.3	0.540000000000001
%3	8	188	50	2.036	91.2	1.3
%3	13	193	50	2.037	92.3	0.219999999999999
%3	18	198	50	2.032	92.8	0.1
%3	23	203	50	2.036	93.7	0.180000000000001
%3	28	208	50	2.035	93.3	-0.0800000000000011
%3	33	213	50	2.036	93.9	0.120000000000002
%3	38	218	50	2.037	95.4	0.3
%3	43	223	50	2.035	95.3	-0.0200000000000017
%3	48	228	50	2.035	96.3	0.2
%3	53	233	50	2.033	98.2	0.380000000000001
%3	58	238	50	2.036	98.2	0
4	3	243	50	2.032	98.2	0
4	8	248	50	2.034	98.6	0.0799999999999983
%4	10	250	150	2.036	100.5	0.950000000000003
%4	15	255	150	2.034	105.2	0.940000000000001
%4	20	260	150	2.036	105.6	0.0799999999999983
%4	25	265	150	2.034	107	0.280000000000001
%4	30	270	150	2.034	108	0.2
%4	35	275	150	2.032	108	0
4	40	280	150	2.032	107.8	-0.0400000000000006
4	45	285	150	2.031	107.7	-0.0199999999999989
%4	50	290	400	2.031	115	1.46
%4	55	295	400	2.031	115.9	0.180000000000001
%5	0	300	400	2.029	116.1	0.0399999999999977
5	5	305	400	2.032	116.5	0.0800000000000011
5	10	310	400	2.029	116	-0.1
%5	15	315	900	2.034	124.8	1.76
%5	20	320	900	2.037	125.3	0.1
%5	25	325	900	2.034	125.4	0.0200000000000017
5	30	330	900	2.037	125.5	0.0199999999999989
5	35	335	900	2.041	132.2	1.34
%5	40	340	1900	2.042	134	0.360000000000002
5	45	345	1900	2.042	133.5	-0.1
5	55	355	1900	2.041	134.2	0.0699999999999989
%6	0	360	3400	2.05	140.8	1.32
%6	5	365	3400	2.051	142.2	0.279999999999996
6	10	370	3400	2.05	140.8	-0.279999999999996
6	15	375	3400	2.054	142.2	0.279999999999996
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	5.992	49.4	
%0	5	5	0	6.002	55.7	1.26
%0	10	10	0	6.018	59.4	0.739999999999999
%0	15	15	0	6.033	62.5	0.62
%0	20	20	0	6.046	62.6	0.0200000000000003
%0	25	25	0	6.064	65.4	0.560000000000001
%0	30	30	0	6.054	73	1.52
%1	0	60	0	6.077	70.1	-0.0966666666666669
%1	5	65	0	6.042	67.4	-0.539999999999998
%1	10	70	0	6.064	69.9	0.5
%1	15	75	0	6.077	69.9	0
%1	20	80	0	6.091	68.8	-0.220000000000002
%1	25	85	0	6.019	67.3	-0.3
%1	30	90	0	6.033	67.7	0.0800000000000011
1	35	95	0	6.05	68	0.0599999999999994
1	40	100	0	6.073	67.4	-0.119999999999999
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-6; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(1:end)),Emeas(1:end),1)
paramlinear=polyfit(log10(CuTplus(3:end)),Emeas(3:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=mean(Emeas(1:2)); Eorig=mean(mVAoriginal); m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-13:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'b--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'b--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,60,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

axis([-16 -3 -40 150])

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -16
list
string: -14
list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -6.08003 50 0.329493 27.1984

list
string: Total Cu
 -5.94977 60 0.299539 19.9825

[I 23:19:42.907 NotebookApp] Saving file at /KNO3_pH6_0pt1uMCuT.ipynb
[I 23:19:45.134 NotebookApp] Saving file at /KNO3_pH8_0pt1uMCuT.ipynb
[I 23:20:31.366 NotebookApp] Saving file at /KNO3_pH6_1uMCuT.ipynb
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	35	35	0	2.06	88.3	0.159999999999999
%0	40	40	0	2.053	88.3	0
%0	45	45	0	2.056	89.2	0.180000000000001
%0	50	50	0	2.055	88.9	-0.0599999999999994
%0	55	55	0	2.056	89.2	0.0599999999999994
%1	0	60	0	2.056	91	0.359999999999999
1	18	78	0	2.056	87.5	-0.194444444444444
%1	19	79	50	2.058	87.4	-0.0999999999999943
%1	25	85	50	2.054	93.1	0.949999999999998
%1	30	90	50	2.057	96.3	0.640000000000001
%1	35	95	50	2.054	94.7	-0.319999999999999
%1	40	100	50	2.056	97	0.459999999999999
%1	45	105	50	2.052	97.6	0.119999999999999
%1	55	115	50	2.049	97.4	-0.0199999999999989
%2	0	120	50	2.053	98	0.119999999999999
%2	5	125	50	2.053	99.4	0.280000000000001
%2	10	130	50	2.044	98.4	-0.2
%2	15	135	50	2.045	97.6	-0.160000000000002
2	20	140	50	2.042	97.4	-0.0399999999999977
2	25	145	50	2.018	97.7	0.0599999999999994
%2	30	147	150	2.019	98.2	0.25
%2	32	152	150	2.016	103	0.959999999999999
%2	37	157	150	2.018	104	0.2
%2	42	162	150	2.015	105.1	0.219999999999999
%2	47	167	150	2.014	104.5	-0.119999999999999
%2	52	172	150	2.014	103.5	-0.2
%2	57	177	150	2.011	104	0.1
%3	2	182	150	2.011	106.3	0.459999999999999
%3	7	187	150	2.009	105.5	-0.159999999999999
%3	12	192	150	2.01	107	0.3
%3	17	197	150	2.009	106.5	-0.1
3	22	202	150	2.009	106.4	-0.0199999999999989
3	27	207	150	2.011	106.6	0.0399999999999977
%3	30	210	400	2.011	111	1.46666666666667
%3	35	215	400	2.011	114.9	0.780000000000001
%3	40	220	400	2.012	115.2	0.0599999999999994
%3	50	230	400	2.01	117.8	0.259999999999999
%3	55	235	400	2.01	118.3	0.1
%4	0	240	400	2.009	118.5	0.0400000000000006
%4	5	245	400	2.009	118.7	0.0400000000000006
%4	10	250	400	2.008	117.1	-0.320000000000002
%4	15	255	400	2.008	118	0.180000000000001
4	20	260	400	2.008	116.7	-0.259999999999999
4	25	265	400	2.007	116.6	-0.0200000000000017
%4	27	267	900	2.011	119	1.2
%4	32	272	900	2.011	123.7	0.940000000000001
%4	37	277	900	2.01	124.7	0.2
%4	42	282	900	2.011	126.2	0.3
%4	47	287	900	2.011	126.1	-0.0200000000000017
4	52	292	900	2.01	126.3	0.0400000000000006
4	57	297	900	2.011	126.2	-0.0199999999999989
%5	0	300	1900	2.018	131.8	1.86666666666667
%5	5	305	1900	2.017	134.3	0.5
%5	10	310	1900	2.018	135.6	0.259999999999997
%5	15	315	1900	2.018	134.7	-0.180000000000001
%5	20	320	1900	2.018	135.4	0.140000000000003
%5	25	325	1900	2.019	135	-0.0800000000000011
%5	30	330	1900	2.018	136.4	0.280000000000001
5	35	335	1900	2.018	136.5	0.0199999999999989
5	40	340	1900	2.018	135.5	-0.2
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	6.097	57.3	
%0	5	5	0	6.051	80.8	4.7
%0	10	10	0	6.071	83.8	0.6
%0	15	15	0	6.093	87.7	0.780000000000001
%0	20	20	0	6.101	87.7	0
0	25	25	0	6.079	87.8	0.0199999999999989
0	30	30	0	6.095	87.5	-0.0599999999999994
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-6; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(2:end)),Emeas(2:end),1)
paramlinear=polyfit(log10(CuTplus(2:end)),Emeas(2:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=mean(Emeas(1:2)); Eorig=mean(mVAoriginal); m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'r--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'m--'); hold on
plot([log10(CuwithCuOs) log10(CuwithCuOs)],[-100 150],'g--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -6.04294 50 0.253456 35.7873

list
string: Total Cu
 -5.91521 40 0.230415 26.2927

[I 23:22:31.407 NotebookApp] Saving file at /KNO3_pH6_1uMCuT.ipynb
[I 23:29:36.910 NotebookApp] 302 GET /lab/ (172.24.0.1) 0.990000ms
[I 02:47:59.298 NotebookApp] Starting buffering for 501c1611-0792-428b-aec5-598ef5cf05cd:a56719f6-e501-43ee-8e5b-496834fddb95
[I 02:47:59.299 NotebookApp] Starting buffering for 7c3981ad-5a7c-4d29-a312-81b6a13e5d7a:16e61b19-d320-40b2-84a9-9fcbd1d4c8af
[I 02:47:59.300 NotebookApp] Starting buffering for 796ba640-abe1-49e7-a4ab-c2536ef9ec41:cdc81e5f-8806-4dc5-8abd-6cff60c2d441
[I 15:20:45.286 NotebookApp] 301 GET /static/favicons/favicon.ico (172.24.0.1) 7.200000ms
[I 2023-08-24 15:20:48.502 LabApp] Build is up to date
[I 15:20:49.228 NotebookApp] 301 GET /static/favicons/favicon-busy-1.ico (172.24.0.1) 5.380000ms
Executing: % setup environment
% set path to equilibrium solver
txt=pwd;
n=length(txt);
rootpath=txt; %txt(1:n-8);
PHREEQCpath=[rootpath,'/runPHREEQC'];
addpath(PHREEQCpath);
JEQUILIBpath=[rootpath,'/JEQUILIB']; addpath(JEQUILIBpath);
Cumodelspath=[rootpath,'/Cutableaus']; addpath(Cumodelspath);
% clear data and number format
clear; format short e
% turn off warnings
warning off
graphics_toolkit ("notebook"); 
graphics_toolkit ("plotly"); 
Executing: % put in constants
VT=0.05; %total volume
stockCuconc=0.0152067;
Executing: % put in data
data=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	35	35	0	2.06	88.3	0.159999999999999
%0	40	40	0	2.053	88.3	0
%0	45	45	0	2.056	89.2	0.180000000000001
%0	50	50	0	2.055	88.9	-0.0599999999999994
%0	55	55	0	2.056	89.2	0.0599999999999994
%1	0	60	0	2.056	91	0.359999999999999
1	18	78	0	2.056	87.5	-0.194444444444444
%1	19	79	50	2.058	87.4	-0.0999999999999943
%1	25	85	50	2.054	93.1	0.949999999999998
%1	30	90	50	2.057	96.3	0.640000000000001
%1	35	95	50	2.054	94.7	-0.319999999999999
%1	40	100	50	2.056	97	0.459999999999999
%1	45	105	50	2.052	97.6	0.119999999999999
%1	55	115	50	2.049	97.4	-0.0199999999999989
%2	0	120	50	2.053	98	0.119999999999999
%2	5	125	50	2.053	99.4	0.280000000000001
%2	10	130	50	2.044	98.4	-0.2
%2	15	135	50	2.045	97.6	-0.160000000000002
2	20	140	50	2.042	97.4	-0.0399999999999977
2	25	145	50	2.018	97.7	0.0599999999999994
%2	30	147	150	2.019	98.2	0.25
%2	32	152	150	2.016	103	0.959999999999999
%2	37	157	150	2.018	104	0.2
%2	42	162	150	2.015	105.1	0.219999999999999
%2	47	167	150	2.014	104.5	-0.119999999999999
%2	52	172	150	2.014	103.5	-0.2
%2	57	177	150	2.011	104	0.1
%3	2	182	150	2.011	106.3	0.459999999999999
%3	7	187	150	2.009	105.5	-0.159999999999999
%3	12	192	150	2.01	107	0.3
%3	17	197	150	2.009	106.5	-0.1
3	22	202	150	2.009	106.4	-0.0199999999999989
3	27	207	150	2.011	106.6	0.0399999999999977
%3	30	210	400	2.011	111	1.46666666666667
%3	35	215	400	2.011	114.9	0.780000000000001
%3	40	220	400	2.012	115.2	0.0599999999999994
%3	50	230	400	2.01	117.8	0.259999999999999
%3	55	235	400	2.01	118.3	0.1
%4	0	240	400	2.009	118.5	0.0400000000000006
%4	5	245	400	2.009	118.7	0.0400000000000006
%4	10	250	400	2.008	117.1	-0.320000000000002
%4	15	255	400	2.008	118	0.180000000000001
4	20	260	400	2.008	116.7	-0.259999999999999
4	25	265	400	2.007	116.6	-0.0200000000000017
%4	27	267	900	2.011	119	1.2
%4	32	272	900	2.011	123.7	0.940000000000001
%4	37	277	900	2.01	124.7	0.2
%4	42	282	900	2.011	126.2	0.3
%4	47	287	900	2.011	126.1	-0.0200000000000017
4	52	292	900	2.01	126.3	0.0400000000000006
4	57	297	900	2.011	126.2	-0.0199999999999989
%5	0	300	1900	2.018	131.8	1.86666666666667
%5	5	305	1900	2.017	134.3	0.5
%5	10	310	1900	2.018	135.6	0.259999999999997
%5	15	315	1900	2.018	134.7	-0.180000000000001
%5	20	320	1900	2.018	135.4	0.140000000000003
%5	25	325	1900	2.019	135	-0.0800000000000011
%5	30	330	1900	2.018	136.4	0.280000000000001
5	35	335	1900	2.018	136.5	0.0199999999999989
5	40	340	1900	2.018	135.5	-0.2
];

addedCuvol=data(:,4)'*1e-6;

originalsamplemVnpH=[...
%time hr	time min	time total	cumulative  vol added	pH	mvA	delta
%0	0	0	0	6.097	57.3	
%0	5	5	0	6.051	80.8	4.7
%0	10	10	0	6.071	83.8	0.6
%0	15	15	0	6.093	87.7	0.780000000000001
%0	20	20	0	6.101	87.7	0
0	25	25	0	6.079	87.8	0.0199999999999989
0	30	30	0	6.095	87.5	-0.0599999999999994
];
Executing: % process the data
pH=mean(originalsamplemVnpH(:,5))
mVAoriginal=mean(originalsamplemVnpH(:,6));
mVAoriginal=(originalsamplemVnpH(:,6));

mVA=data(:,6)'; Emeas=mVA; CuTmeas=1e-6; CuT=CuTmeas;
%mest=mVA(3)-mVA(2)
CuTplus=(CuTmeas*(VT)+addedCuvol*stockCuconc)./(VT+addedCuvol);

%chlorocorrecxtion
%BF1=2.49; BF2=1.14; BF3=0.9; ClT=4.9904e-4; %from Inorg. Chem. 1983. 22. 3323-3326.
%CuTplus=CuTplus./(1+BF1*ClT+BF2*ClT^2+BF3*ClT^3);

param=polyfit(log10(CuTplus(2:end)),Emeas(2:end),1)
paramlinear=polyfit(log10(CuTplus(2:end)),Emeas(2:end),1)
logCuToriginal=(Emeas(1:2)-param(2))/param(1);
CuToriginal=(10.^logCuToriginal)*63.546*1e6;
logCuoriginal=mean((mVAoriginal-param(2))/param(1));

Executing: % try one point, assume Nernst slope
m=59.2/2; Eacid=mean(Emeas(1:2)); Eorig=mean(mVAoriginal); m=paramlinear(1);
Eo=Eacid-(m)*log10(CuT);
logCuonept=(Eorig-Eo)/m
Executing: % MODEL FOR COMPARISON

%model with just inorganic speciation
%geochemical model
% input the constants and solution chemistry

flag1=2; %flag1 for concentration based search vector (1) or for log based search vector (2).
flag2=1; %flag2 for numerical derivatives (2) or analtyical derivatives (1)
database=[]; 
flag3=0; % flag3 1 for show warnings. 0 no warnings
flag4=0; %if=1 solve tableau one line at a time to get a good initial guess (no solids). really challenging probs only
flag5=0; %if=1 use stored initial guess for including solids

CuT=CuTmeas; inorganicTOTALS=[CuT];
inorganicTOTALS(inorganicTOTALS==0)=1e-16; % get rid of zero values, b/c div by zero error
TOTALS=[inorganicTOTALS]; %TOTALS=inorganicTOTALS;
pe=20.75-pH; PCO2=10^-3.5;
[Cuall,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauallsolids(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[CuwithCuOs,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableauCuOs(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);
[Cunosolid,CuOH,CuOH2s,CuOs,CuCO3s,tenorite,malachite,MASSERR]=CuOHCO2opentableaunosolid(pH,pe,PCO2,TOTALS',flag1,flag2,flag3,flag4,flag5,database);

plot(log10(CuTplus),Emeas,'ko','markersize',8)

hold on
plot([logCuoriginal'],[mVAoriginal'],'ko')
logCuplot=-12:0.1:-3; Eplot=polyval(param,logCuplot);
plot(logCuplot,Eplot,'k-')
set(gca,'linewidth',2)
xlabel('log[Cu^{2+}]'); ylabel('E (mV)')
hold on

plot([log10(Cuall) log10(Cuall)],[-100 100],'r--')
plot([log10(Cunosolid) log10(Cunosolid)],[-100 150],'m--'); hold on
plot([log10(CuwithCuOs) log10(CuwithCuOs)],[-100 150],'g--'); hold on
plot([log10(CuT) log10(CuT)],[-100 150],'b--')
%plot([-9.576 -9.576],[-100 100],'b--')

text(log10(Cunosolid)+0.1,50,'model Cu^{2+}','rotation',90)
text(log10(CuT)+0.2,40,'Total Cu','rotation',90)


xlabel('log([Cu^{2+}])')
ylabel('Potential (mV)')
set(gca,'LineWidth',2,'fontsize',12)

logCunosolid=log10(Cunosolid)
logCuoriginalsample=mean((mVAoriginal-param(2))/param(1))
logCuonept

plot(logCuonept,Eorig,'ro','markerfacecolor','r')

list
string: -12
list
string: -10
list
string: -8
list
string: -6
list
string: -4
list
string: -2
list
string: -100
list
string: -50
list
string: 0
list
string: 50
list
string: 100
list
string: 150
list
string: log([Cu
superscript
list
string: 2+
string: ])
list
string: Potential (mV)
list
string: model Cu
superscript
list
string: 2+
 -6.04294 50 0.253456 35.7873

list
string: Total Cu
 -5.91521 40 0.230415 26.2927

[I 15:21:32.754 NotebookApp] Creating new notebook in 
[I 15:21:38.140 NotebookApp] Kernel started: 5ce91f72-d68a-4c5b-bd4d-7094adc4672c, name: xoctave
OpenGL vendor: VMware, Inc.
OpenGL renderer: llvmpipe (LLVM 10.0.0, 128 bits)
OpenGL version: 3.1 Mesa 20.0.8
Run with XEUS 3.0.5
[W 15:21:38.989 NotebookApp] Got events for closed stream <zmq.eventloop.zmqstream.ZMQStream object at 0x7f38a8f03dd0>
[I 15:21:51.919 NotebookApp] Saving file at /Untitled.ipynb
[I 15:21:55.073 NotebookApp] New terminal with automatic name: 1
